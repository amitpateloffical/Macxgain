import{_ as pt,f as n,D as O,E as ht,L as ft,c as d,o as c,b as t,h as $,i as u,n as f,j as m,W as j,a as mt,v as x,t as l,F as W,r as q}from"./app-BIx6yWNQ.js";const gt={class:"analytics-screen"},bt={class:"analytics-header"},wt={class:"header-content"},_t={class:"header-actions"},yt=["disabled"],$t={class:"filter-section"},Ct={class:"filter-controls"},Dt={class:"filter-group"},Ut={key:0,class:"filter-group"},St={key:1,class:"filter-group"},Rt={class:"metrics-section"},kt={class:"metrics-grid"},Lt={class:"metric-card total-users"},Tt={class:"metric-content"},At={class:"metric-value"},Pt={class:"metric-change positive"},xt={class:"metric-card active-users"},It={class:"metric-content"},Nt={class:"metric-value"},Mt={class:"metric-change positive"},Ft={class:"metric-card total-deposits"},Et={class:"metric-content"},Vt={class:"metric-value"},jt={class:"metric-change positive"},Ot={class:"metric-card total-withdrawals"},Wt={class:"metric-content"},qt={class:"metric-value"},Bt={class:"metric-card net-revenue"},Gt={class:"metric-content"},Jt={class:"metric-value"},zt={class:"metric-change positive"},Yt={class:"metric-card pending-requests"},Ht={class:"metric-content"},Kt={class:"metric-value"},Qt={class:"metric-change neutral"},Xt={class:"charts-section"},Zt={class:"charts-grid"},te={class:"chart-card"},ee={class:"chart-header"},se={class:"chart-actions"},ae={class:"chart-container"},le={class:"chart-card"},ne={class:"chart-header"},oe={class:"chart-actions"},ie={class:"chart-container"},re={class:"chart-card full-width"},ue={class:"chart-header"},de={class:"chart-actions"},ce={class:"chart-container"},ve={class:"data-section"},pe={class:"data-tabs"},he={key:0,class:"tab-content"},fe={class:"table-header"},me={class:"table-actions"},ge={class:"table-container"},be={class:"data-table"},we={key:1,class:"tab-content"},_e={class:"table-header"},ye={class:"table-actions"},$e={class:"table-container"},Ce={class:"data-table"},De={key:2,class:"tab-content"},Ue={class:"table-header"},Se={class:"table-actions"},Re={class:"table-container"},ke={class:"data-table"},Le={key:0,class:"loading-overlay"},Te="http://127.0.0.1:8000/api",Ae={__name:"Analytics",setup(Pe){const C=n(!1),r=n("current_month"),D=n(""),U=n(""),h=n("users"),I=n(""),N=n("all"),M=n(""),F=n("all"),E=n(""),V=n("all"),S=n(0),R=n(0),k=n(0),L=n(0),T=n(0),A=n(0),B=n(0),G=n(0),J=n(0),P=n(0),z=n(0),Y=n(0),H=n(null),K=n(null),Q=n(null),b=n([]),w=n([]),_=n([]),Z=O(()=>{let a=b.value;if(I.value){const e=I.value.toLowerCase();a=a.filter(s=>s.name.toLowerCase().includes(e)||s.email.toLowerCase().includes(e))}return N.value!=="all"&&(a=a.filter(e=>e.status===N.value)),a}),tt=O(()=>{let a=w.value;if(M.value){const e=M.value.toLowerCase();a=a.filter(s=>s.transaction_id.toLowerCase().includes(e)||s.user_name.toLowerCase().includes(e))}return F.value!=="all"&&(a=a.filter(e=>e.status===F.value)),a}),et=O(()=>{let a=_.value;if(E.value){const e=E.value.toLowerCase();a=a.filter(s=>s.transaction_id.toLowerCase().includes(e)||s.user_name.toLowerCase().includes(e))}return V.value!=="all"&&(a=a.filter(e=>e.status===V.value)),a}),st=async()=>{await g()},g=async()=>{try{C.value=!0;const a=localStorage.getItem("access_token");if(!a)throw new Error("No access token found");const e=await fetch(`${Te}/analytics?period=${r.value}&start_date=${D.value}&end_date=${U.value}`,{headers:{Authorization:`Bearer ${a}`,Accept:"application/json"}});if(!e.ok)throw new Error("Failed to fetch analytics data");const s=await e.json();s.success&&(S.value=s.metrics.total_users,R.value=s.metrics.active_users,k.value=s.metrics.total_deposits,L.value=s.metrics.total_withdrawals,T.value=s.metrics.net_revenue,A.value=s.metrics.pending_requests,B.value=s.growth_rates.user_growth,G.value=s.growth_rates.active_user_growth,J.value=s.growth_rates.deposit_growth,P.value=s.growth_rates.withdrawal_growth,z.value=s.growth_rates.revenue_growth,Y.value=s.growth_rates.pending_change,b.value=s.users,w.value=s.deposits,_.value=s.withdrawals,at(s.charts))}catch(a){console.error("Error updating analytics data:",a)}finally{C.value=!1}},at=a=>{a.user_growth&&H.value&&lt(a.user_growth),a.financial&&K.value&&nt(a.financial),a.monthly&&Q.value&&ot(a.monthly)},lt=a=>{console.log("Updating user chart with:",a)},nt=a=>{console.log("Updating financial chart with:",a)},ot=a=>{console.log("Updating monthly chart with:",a)},y=a=>{console.log(`Toggling ${a} chart view`)},it=()=>{const a={period:r.value,metrics:{totalUsers:S.value,activeUsers:R.value,totalDeposits:k.value,totalWithdrawals:L.value,netRevenue:T.value,pendingRequests:A.value},users:b.value,deposits:w.value,withdrawals:_.value},e=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),s=URL.createObjectURL(e),v=document.createElement("a");v.href=s,v.download=`analytics-report-${r.value}-${new Date().toISOString().split("T")[0]}.json`,v.click(),URL.revokeObjectURL(s)},rt=()=>{let a="";a+=`Analytics Report
`,a+=`Period: ${r.value}
`,a+=`Generated: ${new Date().toLocaleString()}

`,a+=`Metrics
`,a+=`Metric,Value
`,a+=`Total Users,${S.value}
`,a+=`Active Users,${R.value}
`,a+=`Total Deposits,â‚¹${i(k.value)}
`,a+=`Total Withdrawals,â‚¹${i(L.value)}
`,a+=`Net Revenue,â‚¹${i(T.value)}
`,a+=`Pending Requests,${A.value}

`,b.value.length>0&&(a+=`Users Data
`,a+=`ID,Name,Email,Status,Registration Date,Last Login,Total Balance
`,b.value.forEach(o=>{a+=`${o.id},"${o.name}","${o.email}","${X(o.status)}","${p(o.created_at)}","${p(o.last_login_at)||"Never"}",â‚¹${i(o.total_balance||0)}
`}),a+=`
`),w.value.length>0&&(a+=`Deposits Data
`,a+=`Transaction ID,User,Amount,Status,Date,Description
`,w.value.forEach(o=>{a+=`${o.transaction_id},"${o.user_name}",â‚¹${i(o.amount)},"${o.status}","${p(o.created_at)}","${o.description||"N/A"}"
`}),a+=`
`),_.value.length>0&&(a+=`Withdrawals Data
`,a+=`Transaction ID,User,Amount,Status,Request Date,Processed Date
`,_.value.forEach(o=>{a+=`${o.transaction_id},"${o.user_name}",â‚¹${i(o.amount)},"${o.status}","${p(o.created_at)}","${p(o.updated_at)||"Pending"}"
`}));const e=new Blob([a],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(e),v=document.createElement("a");v.href=s,v.download=`analytics-report-${r.value}-${new Date().toISOString().split("T")[0]}.csv`,v.click(),URL.revokeObjectURL(s)},ut=()=>{try{const a=`
Analytics Report
Period: ${r.value}
Generated: ${new Date().toLocaleString()}

METRICS:
- Total Users: ${S.value}
- Active Users: ${R.value}
- Total Deposits: â‚¹${i(k.value)}
- Total Withdrawals: â‚¹${i(L.value)}
- Net Revenue: â‚¹${i(T.value)}
- Pending Requests: ${A.value}

USERS: ${b.value.length}
DEPOSITS: ${w.value.length}
WITHDRAWALS: ${_.value.length}
    `,e=new Blob([a],{type:"text/plain"}),s=URL.createObjectURL(e),v=document.createElement("a");v.href=s,v.download=`analytics-report-${r.value}-${new Date().toISOString().split("T")[0]}.txt`,v.click(),URL.revokeObjectURL(s),alert("PDF export is being prepared. For now, a text file has been downloaded. Full PDF support will be added soon!")}catch(a){console.error("PDF export error:",a),alert("PDF export failed. Please try CSV or JSON export instead.")}},i=a=>new Intl.NumberFormat("en-IN").format(a),p=a=>a?new Date(a).toLocaleDateString("en-IN"):"N/A",dt=a=>({A:"active",I:"inactive",P:"pending"})[a]||"unknown",X=a=>({A:"Active",I:"Inactive",P:"Pending"})[a]||"Unknown",ct=a=>({completed:"success",pending:"warning",failed:"danger"})[a]||"neutral",vt=a=>({completed:"success",pending:"warning",rejected:"danger"})[a]||"neutral";return ht(async()=>{await g()}),ft([r,D,U],()=>{(r.value==="custom"&&D.value&&U.value||r.value!=="custom")&&g()}),(a,e)=>(c(),d("div",gt,[t("div",bt,[t("div",wt,[e[22]||(e[22]=t("div",{class:"header-left"},[t("h1",{class:"page-title"},[t("i",{class:"fa-solid fa-chart-line"}),u(" Analytics Dashboard ")]),t("p",{class:"page-subtitle"}," Comprehensive insights into your platform's performance ")],-1)),t("div",_t,[t("button",{class:"btn-refresh",onClick:st,disabled:C.value},[t("i",{class:f(["fa-solid fa-rotate",{"fa-spin":C.value}])},null,2),e[18]||(e[18]=u(" Refresh "))],8,yt),t("div",{class:"export-buttons"},[t("button",{class:"btn-export csv",onClick:rt},e[19]||(e[19]=[t("i",{class:"fa-solid fa-file-csv"},null,-1),u(" CSV ")])),t("button",{class:"btn-export pdf",onClick:ut},e[20]||(e[20]=[t("i",{class:"fa-solid fa-file-pdf"},null,-1),u(" PDF ")])),t("button",{class:"btn-export json",onClick:it},e[21]||(e[21]=[t("i",{class:"fa-solid fa-file-code"},null,-1),u(" JSON ")]))])])])]),t("div",$t,[t("div",Ct,[t("div",Dt,[e[24]||(e[24]=t("label",{class:"filter-label"},"Time Period",-1)),m(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>r.value=s),class:"filter-select",onChange:g},e[23]||(e[23]=[mt('<option value="current_month" data-v-be4d350e>Current Month</option><option value="last_month" data-v-be4d350e>Last Month</option><option value="last_3_months" data-v-be4d350e>Last 3 Months</option><option value="last_6_months" data-v-be4d350e>Last 6 Months</option><option value="current_year" data-v-be4d350e>Current Year</option><option value="last_year" data-v-be4d350e>Last Year</option><option value="custom" data-v-be4d350e>Custom Range</option>',7)]),544),[[j,r.value]])]),r.value==="custom"?(c(),d("div",Ut,[e[25]||(e[25]=t("label",{class:"filter-label"},"From Date",-1)),m(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=s=>D.value=s),class:"filter-input",onChange:g},null,544),[[x,D.value]])])):$("",!0),r.value==="custom"?(c(),d("div",St,[e[26]||(e[26]=t("label",{class:"filter-label"},"To Date",-1)),m(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>U.value=s),class:"filter-input",onChange:g},null,544),[[x,U.value]])])):$("",!0)])]),t("div",Rt,[t("div",kt,[t("div",Lt,[e[29]||(e[29]=t("div",{class:"metric-icon"},"ðŸ‘¥",-1)),t("div",Tt,[e[28]||(e[28]=t("h3",{class:"metric-title"},"Total Users",-1)),t("div",At,l(i(S.value)),1),t("div",Pt,[e[27]||(e[27]=t("i",{class:"fa-solid fa-arrow-up"},null,-1)),u(" +"+l(B.value)+"% this month ",1)])])]),t("div",xt,[e[32]||(e[32]=t("div",{class:"metric-icon"},"ðŸŸ¢",-1)),t("div",It,[e[31]||(e[31]=t("h3",{class:"metric-title"},"Active Users",-1)),t("div",Nt,l(i(R.value)),1),t("div",Mt,[e[30]||(e[30]=t("i",{class:"fa-solid fa-arrow-up"},null,-1)),u(" +"+l(G.value)+"% this month ",1)])])]),t("div",Ft,[e[35]||(e[35]=t("div",{class:"metric-icon"},"ðŸ’°",-1)),t("div",Et,[e[34]||(e[34]=t("h3",{class:"metric-title"},"Total Deposits",-1)),t("div",Vt,"â‚¹"+l(i(k.value)),1),t("div",jt,[e[33]||(e[33]=t("i",{class:"fa-solid fa-arrow-up"},null,-1)),u(" +"+l(J.value)+"% this month ",1)])])]),t("div",Ot,[e[37]||(e[37]=t("div",{class:"metric-icon"},"ðŸ’³",-1)),t("div",Wt,[e[36]||(e[36]=t("h3",{class:"metric-title"},"Total Withdrawals",-1)),t("div",qt,"â‚¹"+l(i(L.value)),1),t("div",{class:f(["metric-change",P.value>=0?"positive":"negative"])},[t("i",{class:f(P.value>=0?"fa-solid fa-arrow-up":"fa-solid fa-arrow-down")},null,2),u(" "+l(P.value>=0?"+":"")+l(P.value)+"% this month ",1)],2)])]),t("div",Bt,[e[40]||(e[40]=t("div",{class:"metric-icon"},"ðŸ“Š",-1)),t("div",Gt,[e[39]||(e[39]=t("h3",{class:"metric-title"},"Net Revenue",-1)),t("div",Jt,"â‚¹"+l(i(T.value)),1),t("div",zt,[e[38]||(e[38]=t("i",{class:"fa-solid fa-arrow-up"},null,-1)),u(" +"+l(z.value)+"% this month ",1)])])]),t("div",Yt,[e[43]||(e[43]=t("div",{class:"metric-icon"},"â³",-1)),t("div",Ht,[e[42]||(e[42]=t("h3",{class:"metric-title"},"Pending Requests",-1)),t("div",Kt,l(i(A.value)),1),t("div",Qt,[e[41]||(e[41]=t("i",{class:"fa-solid fa-minus"},null,-1)),u(" "+l(Y.value)+"% change ",1)])])])])]),t("div",Xt,[t("div",Zt,[t("div",te,[t("div",ee,[e[46]||(e[46]=t("h3",{class:"chart-title"},"User Growth Trend",-1)),t("div",se,[t("button",{class:"chart-btn",onClick:e[3]||(e[3]=s=>y("users"))},e[44]||(e[44]=[t("i",{class:"fa-solid fa-chart-line"},null,-1)])),t("button",{class:"chart-btn",onClick:e[4]||(e[4]=s=>y("users"))},e[45]||(e[45]=[t("i",{class:"fa-solid fa-chart-bar"},null,-1)]))])]),t("div",ae,[t("canvas",{ref_key:"userChart",ref:H,width:"400",height:"200"},null,512)])]),t("div",le,[t("div",ne,[e[49]||(e[49]=t("h3",{class:"chart-title"},"Financial Overview",-1)),t("div",oe,[t("button",{class:"chart-btn",onClick:e[5]||(e[5]=s=>y("financial"))},e[47]||(e[47]=[t("i",{class:"fa-solid fa-chart-pie"},null,-1)])),t("button",{class:"chart-btn",onClick:e[6]||(e[6]=s=>y("financial"))},e[48]||(e[48]=[t("i",{class:"fa-solid fa-chart-area"},null,-1)]))])]),t("div",ie,[t("canvas",{ref_key:"financialChart",ref:K,width:"400",height:"200"},null,512)])]),t("div",re,[t("div",ue,[e[52]||(e[52]=t("h3",{class:"chart-title"},"Monthly Comparison",-1)),t("div",de,[t("button",{class:"chart-btn",onClick:e[7]||(e[7]=s=>y("monthly"))},e[50]||(e[50]=[t("i",{class:"fa-solid fa-chart-bar"},null,-1)])),t("button",{class:"chart-btn",onClick:e[8]||(e[8]=s=>y("monthly"))},e[51]||(e[51]=[t("i",{class:"fa-solid fa-chart-line"},null,-1)]))])]),t("div",ce,[t("canvas",{ref_key:"monthlyChart",ref:Q,width:"800",height:"300"},null,512)])])])]),t("div",ve,[t("div",pe,[t("button",{class:f(["tab-btn",{active:h.value==="users"}]),onClick:e[9]||(e[9]=s=>h.value="users")},e[53]||(e[53]=[t("i",{class:"fa-solid fa-users"},null,-1),u(" Users Data ")]),2),t("button",{class:f(["tab-btn",{active:h.value==="deposits"}]),onClick:e[10]||(e[10]=s=>h.value="deposits")},e[54]||(e[54]=[t("i",{class:"fa-solid fa-money-bill-wave"},null,-1),u(" Deposits ")]),2),t("button",{class:f(["tab-btn",{active:h.value==="withdrawals"}]),onClick:e[11]||(e[11]=s=>h.value="withdrawals")},e[55]||(e[55]=[t("i",{class:"fa-solid fa-credit-card"},null,-1),u(" Withdrawals ")]),2)]),h.value==="users"?(c(),d("div",he,[t("div",fe,[e[57]||(e[57]=t("h3",null,"User Registration Details",-1)),t("div",me,[m(t("input",{type:"text","onUpdate:modelValue":e[12]||(e[12]=s=>I.value=s),placeholder:"Search users...",class:"search-input"},null,512),[[x,I.value]]),m(t("select",{"onUpdate:modelValue":e[13]||(e[13]=s=>N.value=s),class:"filter-select"},e[56]||(e[56]=[t("option",{value:"all"},"All Status",-1),t("option",{value:"active"},"Active",-1),t("option",{value:"inactive"},"Inactive",-1),t("option",{value:"pending"},"Pending",-1)]),512),[[j,N.value]])])]),t("div",ge,[t("table",be,[e[58]||(e[58]=t("thead",null,[t("tr",null,[t("th",null,"User ID"),t("th",null,"Name"),t("th",null,"Email"),t("th",null,"Status"),t("th",null,"Registration Date"),t("th",null,"Last Login"),t("th",null,"Total Balance")])],-1)),t("tbody",null,[(c(!0),d(W,null,q(Z.value,s=>(c(),d("tr",{key:s.id},[t("td",null,l(s.id),1),t("td",null,l(s.name),1),t("td",null,l(s.email),1),t("td",null,[t("span",{class:f(["status-badge",dt(s.status)])},l(X(s.status)),3)]),t("td",null,l(p(s.created_at)),1),t("td",null,l(p(s.last_login_at)||"Never"),1),t("td",null,"â‚¹"+l(i(s.total_balance||0)),1)]))),128))])])])])):$("",!0),h.value==="deposits"?(c(),d("div",we,[t("div",_e,[e[60]||(e[60]=t("h3",null,"Deposit Transactions",-1)),t("div",ye,[m(t("input",{type:"text","onUpdate:modelValue":e[14]||(e[14]=s=>M.value=s),placeholder:"Search deposits...",class:"search-input"},null,512),[[x,M.value]]),m(t("select",{"onUpdate:modelValue":e[15]||(e[15]=s=>F.value=s),class:"filter-select"},e[59]||(e[59]=[t("option",{value:"all"},"All Status",-1),t("option",{value:"completed"},"Completed",-1),t("option",{value:"pending"},"Pending",-1),t("option",{value:"failed"},"Failed",-1)]),512),[[j,F.value]])])]),t("div",$e,[t("table",Ce,[e[61]||(e[61]=t("thead",null,[t("tr",null,[t("th",null,"Transaction ID"),t("th",null,"User"),t("th",null,"Amount"),t("th",null,"Status"),t("th",null,"Date"),t("th",null,"Description")])],-1)),t("tbody",null,[(c(!0),d(W,null,q(tt.value,s=>(c(),d("tr",{key:s.id},[t("td",null,l(s.transaction_id),1),t("td",null,l(s.user_name),1),t("td",null,"â‚¹"+l(i(s.amount)),1),t("td",null,[t("span",{class:f(["status-badge",ct(s.status)])},l(s.status),3)]),t("td",null,l(p(s.created_at)),1),t("td",null,l(s.description||"N/A"),1)]))),128))])])])])):$("",!0),h.value==="withdrawals"?(c(),d("div",De,[t("div",Ue,[e[63]||(e[63]=t("h3",null,"Withdrawal Transactions",-1)),t("div",Se,[m(t("input",{type:"text","onUpdate:modelValue":e[16]||(e[16]=s=>E.value=s),placeholder:"Search withdrawals...",class:"search-input"},null,512),[[x,E.value]]),m(t("select",{"onUpdate:modelValue":e[17]||(e[17]=s=>V.value=s),class:"filter-select"},e[62]||(e[62]=[t("option",{value:"all"},"All Status",-1),t("option",{value:"completed"},"Completed",-1),t("option",{value:"pending"},"Pending",-1),t("option",{value:"rejected"},"Rejected",-1)]),512),[[j,V.value]])])]),t("div",Re,[t("table",ke,[e[64]||(e[64]=t("thead",null,[t("tr",null,[t("th",null,"Transaction ID"),t("th",null,"User"),t("th",null,"Amount"),t("th",null,"Status"),t("th",null,"Request Date"),t("th",null,"Processed Date")])],-1)),t("tbody",null,[(c(!0),d(W,null,q(et.value,s=>(c(),d("tr",{key:s.id},[t("td",null,l(s.transaction_id),1),t("td",null,l(s.user_name),1),t("td",null,"â‚¹"+l(i(s.amount)),1),t("td",null,[t("span",{class:f(["status-badge",vt(s.status)])},l(s.status),3)]),t("td",null,l(p(s.created_at)),1),t("td",null,l(p(s.updated_at)||"Pending"),1)]))),128))])])])])):$("",!0)]),C.value?(c(),d("div",Le,e[65]||(e[65]=[t("div",{class:"loading-content"},[t("i",{class:"fa-solid fa-spinner fa-spin"}),t("p",null,"Loading analytics data...")],-1)]))):$("",!0)]))}},Ie=pt(Ae,[["__scopeId","data-v-be4d350e"]]);export{Ie as default};
