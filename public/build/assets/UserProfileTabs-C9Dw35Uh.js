import{_ as k,s as P,S as I,g as d,Q as N,o as p,q as r,l as s,b as n,t as c,i as v,w as L,c as w,h as g,f as x,u as S,n as y}from"./app-BMw1-RXM.js";const U={props:{userId:{type:String,required:!0}},data(){return{options:{name:"",email:"",phone:"",role:"",profile_image:""},selectedFile:null,imagePreview:null,errors:{}}},created(){this.getUserProfile()},methods:{RemoveError(t){this.errors[t]&&delete this.errors[t]},hasErrors(t){return this.errors&&this.errors[t]},getErrors(t){return this.errors[t]?this.errors[t][0]:""},getUserProfile(){P.get("/userprofile").then(t=>{this.options=t.data.data})},onFileChange(t){this.selectedFile=t.target.files[0],this.selectedFile&&(this.imagePreview=URL.createObjectURL(this.selectedFile))},triggerFileUpload(){this.$refs.fileInput.click()},saveGeneralInfo(){const t=new FormData;t.append("id",this.options.id),t.append("name",this.options.name),t.append("email",this.options.email),t.append("phone",this.options.phone),t.append("role",this.options.role),t.append("bank_name",this.options.bank_name||""),t.append("account_no",this.options.account_no||""),t.append("ifsc_code",this.options.ifsc_code||""),this.selectedFile&&t.append("profile_image",this.selectedFile),P.post(`/update-profile/${btoa(this.options.id)}`,t,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{this.options=e.data.data,this.selectedFile=null,this.imagePreview=null,window.dispatchEvent(new Event("profileUpdated")),I.fire({icon:"success",title:"Profile updated successfully",timer:1500,showConfirmButton:!1}),e.data.data.is_admin==0?this.$router.push("/user/dashboard"):this.$router.push("/admin/dashboard")}).catch(e=>{var _;((_=e.response)==null?void 0:_.data.code)===422&&(this.errors=e.response.data.errors)})}}},F={class:"mt-4"},R={class:"fw-bold"},B={class:"text-muted"},T={class:"text-muted"},O={key:0,class:"text-danger small"},z={key:0,class:"text-danger small"},H={key:0,class:"text-danger small"},M={key:0,class:"text-danger small"},A={key:0,class:"text-danger small"},G={class:"mt-4 d-flex flex-wrap gap-2"};function q(t,e,_,f,l,o){const i=d("b-col"),u=d("b-form-input"),m=d("b-form-group"),b=d("b-row"),h=d("b-button"),E=d("b-form"),C=d("b-card"),V=d("b-container");return p(),N(V,{fluid:"",class:"main-content"},{default:r(()=>[s(C,{class:"profile-card shadow-lg border-0"},{default:r(()=>[s(b,null,{default:r(()=>[s(i,{md:"4",class:"text-center border-end border-gray-700 pe-4"},{default:r(()=>[n("div",F,[n("h5",R,c(l.options.name),1),n("p",B,[e[11]||(e[11]=n("strong",null,"Email:",-1)),v(" "+c(l.options.email),1)]),n("p",T,[e[12]||(e[12]=n("strong",null,"Contact:",-1)),v(" "+c(l.options.phone),1)])])]),_:1}),s(i,{md:"8",class:"ps-4"},{default:r(()=>[e[16]||(e[16]=n("h4",{class:"fw-bold mb-3 text-primary"},"Edit Profile",-1)),s(E,{onSubmit:L(o.saveGeneralInfo,["prevent"])},{default:r(()=>[s(b,null,{default:r(()=>[s(i,{md:"6",class:"mb-3"},{default:r(()=>[s(m,{label:"Full Name","label-class":"fw-semibold"},{default:r(()=>[s(u,{id:"name",modelValue:l.options.name,"onUpdate:modelValue":e[0]||(e[0]=a=>l.options.name=a),onInput:e[1]||(e[1]=a=>o.RemoveError("name")),state:o.hasErrors("name")?!1:null,placeholder:"Enter Name",autocomplete:"off"},null,8,["modelValue","state"]),o.hasErrors("name")?(p(),w("div",O,c(o.getErrors("name")),1)):g("",!0)]),_:1})]),_:1}),s(i,{md:"6",class:"mb-3"},{default:r(()=>[s(m,{label:"Email","label-class":"fw-semibold"},{default:r(()=>[s(u,{modelValue:l.options.email,"onUpdate:modelValue":e[2]||(e[2]=a=>l.options.email=a),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),s(i,{md:"6",class:"mb-3"},{default:r(()=>[s(m,{label:"Phone","label-class":"fw-semibold"},{default:r(()=>[s(u,{id:"phone",modelValue:l.options.phone,"onUpdate:modelValue":e[3]||(e[3]=a=>l.options.phone=a),onInput:e[4]||(e[4]=a=>o.RemoveError("phone")),state:o.hasErrors("phone")?!1:null,placeholder:"Enter Mobile Number",autocomplete:"off"},null,8,["modelValue","state"]),o.hasErrors("phone")?(p(),w("div",z,c(o.getErrors("phone")),1)):g("",!0)]),_:1})]),_:1}),s(i,{md:"6",class:"mb-3"},{default:r(()=>[s(m,{label:"Bank Name","label-class":"fw-semibold"},{default:r(()=>[s(u,{id:"bank_name",modelValue:l.options.bank_name,"onUpdate:modelValue":e[5]||(e[5]=a=>l.options.bank_name=a),onInput:e[6]||(e[6]=a=>o.RemoveError("bank_name")),state:o.hasErrors("bank_name")?!1:null,placeholder:"Enter Bank Name",autocomplete:"off"},null,8,["modelValue","state"]),o.hasErrors("bank_name")?(p(),w("div",H,c(o.getErrors("bank_name")),1)):g("",!0)]),_:1})]),_:1}),s(i,{md:"6",class:"mb-3"},{default:r(()=>[s(m,{label:"Account Number","label-class":"fw-semibold"},{default:r(()=>[s(u,{id:"account_no",modelValue:l.options.account_no,"onUpdate:modelValue":e[7]||(e[7]=a=>l.options.account_no=a),onInput:e[8]||(e[8]=a=>o.RemoveError("account_no")),state:o.hasErrors("account_no")?!1:null,placeholder:"Enter Account Number",autocomplete:"off"},null,8,["modelValue","state"]),o.hasErrors("account_no")?(p(),w("div",M,c(o.getErrors("account_no")),1)):g("",!0)]),_:1})]),_:1}),s(i,{md:"6",class:"mb-3"},{default:r(()=>[s(m,{label:"IFSC Code","label-class":"fw-semibold"},{default:r(()=>[s(u,{id:"ifsc_code",modelValue:l.options.ifsc_code,"onUpdate:modelValue":e[9]||(e[9]=a=>l.options.ifsc_code=a),onInput:e[10]||(e[10]=a=>o.RemoveError("ifsc_code")),state:o.hasErrors("ifsc_code")?!1:null,placeholder:"Enter IFSC Code",autocomplete:"off"},null,8,["modelValue","state"]),o.hasErrors("ifsc_code")?(p(),w("div",A,c(o.getErrors("ifsc_code")),1)):g("",!0)]),_:1})]),_:1})]),_:1}),n("div",G,[s(h,{type:"submit",variant:"primary",class:"me-2 rounded-pill px-4"},{default:r(()=>e[13]||(e[13]=[n("i",{class:"bi bi-check-circle me-1"},null,-1),v(" Save ")])),_:1}),s(h,{type:"reset",variant:"secondary",class:"rounded-pill px-4"},{default:r(()=>e[14]||(e[14]=[n("i",{class:"bi bi-x-circle me-1"},null,-1),v(" Cancel ")])),_:1}),s(h,{onClick:t.logout,variant:"danger",class:"logout-btn rounded-pill px-4"},{default:r(()=>e[15]||(e[15]=[n("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",class:"me-1"},[n("path",{d:"M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.59L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"})],-1),v(" Logout ")])),_:1},8,["onClick"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1})}const D=k(U,[["render",q],["__scopeId","data-v-954e5cb4"]]);P.defaults.withCredentials=!0;const j={data(){return{showOldPassword:!1,showNewPassword:!1,showConfirmPassword:!1,errors:{}}},methods:{RemoveError(t){this.errors[t]&&delete this.errors[t]},hasErrors(t){return this.errors&&this.errors[t]},getErrors(t){return this.errors[t]?this.errors[t][0]:""},toggleOldPasswordView(){this.showOldPassword=!this.showOldPassword},toggleNewPasswordView(){this.showNewPassword=!this.showNewPassword},toggleConfirmPasswordView(){this.showConfirmPassword=!this.showConfirmPassword}},setup(){const t=x({current_password:"",new_password:"",new_password_confirmation:""}),e=x([]),_=S();return{userpassword:t,changePassword:()=>{P.post("/change-password",t.value).then(l=>{l.data.status==="success"&&I.fire({title:"Success!",text:"Password changed successfully.",icon:"success",timer:2e3,showConfirmButton:!1}).then(()=>{_.replace({name:"dashboard"})})}).catch(l=>{l.response&&l.response.data.code===422&&(e.value=l.response.data.errors)})},errors:e}}},Q={key:0,class:"text-danger small"},Y={key:0,class:"text-danger small"},J={key:0,class:"text-danger small"};function K(t,e,_,f,l,o){const i=d("b-form-input"),u=d("b-input-group-append"),m=d("b-input-group"),b=d("b-form-group"),h=d("b-button"),E=d("b-form"),C=d("b-card"),V=d("b-container");return p(),N(V,{fluid:"",class:"main-content"},{default:r(()=>[s(C,{class:"profile-card"},{default:r(()=>[e[10]||(e[10]=n("h4",{class:"mb-4"},"Change Password",-1)),s(E,null,{default:r(()=>[s(b,{label:"Old Password"},{default:r(()=>[s(m,{class:"input-group-merge"},{default:r(()=>[s(i,{type:l.showOldPassword?"text":"password",modelValue:f.userpassword.current_password,"onUpdate:modelValue":e[0]||(e[0]=a=>f.userpassword.current_password=a),id:"current_password",onInput:e[1]||(e[1]=a=>o.RemoveError("current_password")),state:o.hasErrors("current_password")?!1:null,placeholder:"Enter Current Password",autocomplete:"off"},null,8,["type","modelValue","state"]),s(u,{"is-text":""},{default:r(()=>[n("button",{type:"button",onClick:e[2]||(e[2]=(...a)=>o.toggleOldPasswordView&&o.toggleOldPasswordView(...a)),class:"toggle-password-btn"},[n("i",{class:y(l.showOldPassword?"fa fa-eye-slash":"fa fa-eye")},null,2)])]),_:1})]),_:1}),o.hasErrors("current_password")?(p(),w("div",Q,c(o.getErrors("current_password")),1)):g("",!0)]),_:1}),s(b,{label:"New Password"},{default:r(()=>[s(m,{class:"input-group-merge"},{default:r(()=>[s(i,{type:l.showNewPassword?"text":"password",modelValue:f.userpassword.new_password,"onUpdate:modelValue":e[3]||(e[3]=a=>f.userpassword.new_password=a),id:"new_password",onInput:e[4]||(e[4]=a=>o.RemoveError("new_password")),state:o.hasErrors("new_password")?!1:null,placeholder:"Enter New Password",autocomplete:"off"},null,8,["type","modelValue","state"]),s(u,{"is-text":""},{default:r(()=>[n("button",{type:"button",onClick:e[5]||(e[5]=(...a)=>o.toggleNewPasswordView&&o.toggleNewPasswordView(...a)),class:"toggle-password-btn"},[n("i",{class:y(l.showNewPassword?"fa fa-eye-slash":"fa fa-eye")},null,2)])]),_:1})]),_:1}),o.hasErrors("new_password")?(p(),w("div",Y,c(o.getErrors("new_password")),1)):g("",!0)]),_:1}),s(b,{label:"Confirm Password"},{default:r(()=>[s(m,{class:"input-group-merge"},{default:r(()=>[s(i,{type:l.showConfirmPassword?"text":"password",modelValue:f.userpassword.new_password_confirmation,"onUpdate:modelValue":e[6]||(e[6]=a=>f.userpassword.new_password_confirmation=a),id:"new_password_confirmation",onInput:e[7]||(e[7]=a=>o.RemoveError("new_password_confirmation")),state:o.hasErrors("new_password_confirmation")?!1:null,placeholder:"Confirm New Password",autocomplete:"off"},null,8,["type","modelValue","state"]),s(u,{"is-text":""},{default:r(()=>[n("button",{type:"button",onClick:e[8]||(e[8]=(...a)=>o.toggleConfirmPasswordView&&o.toggleConfirmPasswordView(...a)),class:"toggle-password-btn"},[n("i",{class:y(l.showConfirmPassword?"fa fa-eye-slash":"fa fa-eye")},null,2)])]),_:1})]),_:1}),o.hasErrors("new_password_confirmation")?(p(),w("div",J,c(o.getErrors("new_password_confirmation")),1)):g("",!0)]),_:1}),s(h,{type:"submit",variant:"success",class:"mt-3",onClick:f.changePassword},{default:r(()=>e[9]||(e[9]=[v(" Change Password ")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})}const W=k(j,[["render",K],["__scopeId","data-v-537c2527"]]),X={props:{userId:{type:String,required:!0}},components:{GeneralTab:D,ChangePasswordTab:W},methods:{logout(){this.$bvModal.msgBoxConfirm("Are you sure you want to logout?",{title:"Confirm Logout",size:"sm",buttonSize:"sm",okVariant:"danger",okTitle:"Yes, Logout",cancelTitle:"Cancel",footerClass:"p-2",hideHeaderClose:!1,centered:!0}).then(t=>{t&&this.performLogout()}).catch(t=>{console.log("Logout cancelled")})},performLogout(){localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("auth_token"),sessionStorage.clear(),this.$router.push("/login"),this.$toast.success("Logged out successfully!"),this.callLogoutAPI()},callLogoutAPI(){window.axios&&window.axios.post("/api/logout").catch(t=>{console.log("Logout API call failed:",t)})}}},Z={class:"profile-tabs-container"},$={class:"tabs-wrapper"},ee={class:"tabs-header"},se={class:"logout-section"};function oe(t,e,_,f,l,o){const i=d("GeneralTab"),u=d("b-tab"),m=d("ChangePasswordTab"),b=d("b-tabs");return p(),w("div",Z,[n("div",$,[n("div",ee,[s(b,{pills:"","content-class":"mt-3","nav-class":"modern-nav-tabs"},{default:r(()=>[s(u,{title:"ðŸ‘¤ General",active:""},{default:r(()=>[s(i,{userId:_.userId},null,8,["userId"])]),_:1}),s(u,{title:"ðŸ”’ Change Password"},{default:r(()=>[s(m,{userId:_.userId},null,8,["userId"])]),_:1})]),_:1}),n("div",se,[n("button",{onClick:e[0]||(e[0]=(...h)=>o.logout&&o.logout(...h)),class:"logout-btn"},e[1]||(e[1]=[n("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor"},[n("path",{d:"M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.59L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"})],-1),n("span",null,"Logout",-1)]))])])])])}const re=k(X,[["render",oe],["__scopeId","data-v-8884a285"]]);export{re as default};
