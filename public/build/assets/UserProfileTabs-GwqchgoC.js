import{_ as I,s as P,S as U,g as d,Q as x,o as c,q as a,l as o,b as l,t as m,i as E,n as V,w as S,c as _,h as b,F as M,f as N,u as B}from"./app-DI2AcTd6.js";const F={props:{userId:{type:String,required:!0}},data(){return{options:{name:"",email:"",phone:"",role:"",profile_image:"",bank_name:"",account_no:"",ifsc_code:"",aadhar_number:"",pan_number:"",address:""},selectedFile:null,imagePreview:null,errors:{},userBalance:0,balanceLoading:!1,isEditMode:!1}},created(){this.getUserProfile(),this.fetchUserBalance()},methods:{RemoveError(t){this.errors[t]&&delete this.errors[t]},hasErrors(t){return this.errors&&this.errors[t]},getErrors(t){return this.errors[t]?this.errors[t][0]:""},getUserProfile(){P.get("/userprofile").then(t=>{this.options=t.data.data})},async fetchUserBalance(){this.balanceLoading=!0;try{const t=JSON.parse(localStorage.getItem("userData"));if(t&&t.id){const e=await P.post("/total_b",{id:t.id});e.data&&e.data.total_balance!==void 0&&(this.userBalance=e.data.total_balance,t.total_balance=e.data.total_balance,localStorage.setItem("userData",JSON.stringify(t)))}}catch(t){console.error("Error fetching balance:",t);const e=JSON.parse(localStorage.getItem("userData"));e&&e.total_balance!==void 0&&(this.userBalance=e.total_balance)}finally{this.balanceLoading=!1}},formatBalance(t){return t==null?"0.00":parseFloat(t).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})},toggleEditMode(){this.isEditMode=!this.isEditMode,this.isEditMode||(this.getUserProfile(),this.errors={})},onFileChange(t){this.selectedFile=t.target.files[0],this.selectedFile&&(this.imagePreview=URL.createObjectURL(this.selectedFile))},triggerFileUpload(){this.$refs.fileInput.click()},saveGeneralInfo(){const t=new FormData;t.append("id",this.options.id),t.append("name",this.options.name),t.append("email",this.options.email),t.append("phone",this.options.phone),t.append("role",this.options.role),t.append("bank_name",this.options.bank_name||""),t.append("account_no",this.options.account_no||""),t.append("ifsc_code",this.options.ifsc_code||""),t.append("aadhar_number",this.options.aadhar_number||""),t.append("pan_number",this.options.pan_number||""),t.append("address",this.options.address||""),this.selectedFile&&t.append("profile_image",this.selectedFile),P.post(`/update-profile/${btoa(this.options.id)}`,t,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{this.options=e.data.data,this.selectedFile=null,this.imagePreview=null,this.isEditMode=!1,window.dispatchEvent(new Event("profileUpdated")),U.fire({icon:"success",title:"Profile updated successfully",timer:1500,showConfirmButton:!1})}).catch(e=>{var g;((g=e.response)==null?void 0:g.data.code)===422&&(this.errors=e.response.data.errors)})}}},R={class:"mt-4"},O={class:"fw-bold"},L={class:"text-muted"},D={class:"text-muted"},T={class:"balance-card mt-3"},A={class:"balance-amount"},G={class:"balance-refresh"},q=["disabled"],z={key:0,class:"text-danger small"},H={key:0,class:"text-danger small"},J={key:0,class:"text-danger small"},j={key:0,class:"text-danger small"},Q={key:0,class:"text-danger small"},K={key:0,class:"text-danger small"},W={key:0,class:"text-danger small"},X={key:0,class:"text-danger small"},Y={class:"mt-4"};function Z(t,e,g,w,r,s){const i=d("b-col"),p=d("b-form-input"),f=d("b-form-group"),h=d("b-row"),v=d("b-form-textarea"),y=d("b-button"),C=d("b-form"),k=d("b-card"),u=d("b-container");return c(),x(u,{fluid:"",class:"main-content"},{default:a(()=>[o(k,{class:"profile-card shadow-lg border-0"},{default:a(()=>[o(h,null,{default:a(()=>[o(i,{md:"4",class:"text-center border-end border-gray-700 pe-4"},{default:a(()=>[l("div",R,[l("h5",O,m(r.options.name),1),l("p",L,[e[18]||(e[18]=l("strong",null,"Email:",-1)),E(" "+m(r.options.email),1)]),l("p",D,[e[19]||(e[19]=l("strong",null,"Contact:",-1)),E(" "+m(r.options.phone),1)]),l("div",T,[e[20]||(e[20]=l("div",{class:"balance-header"},[l("i",{class:"bi bi-wallet2 me-2"}),l("span",null,"Current Balance")],-1)),l("div",A," â‚¹"+m(s.formatBalance(r.userBalance)),1),l("div",G,[l("button",{onClick:e[0]||(e[0]=(...n)=>s.fetchUserBalance&&s.fetchUserBalance(...n)),class:"refresh-btn",disabled:r.balanceLoading},[l("i",{class:V(["bi bi-arrow-clockwise",{spinning:r.balanceLoading}])},null,2),E(" "+m(r.balanceLoading?"Updating...":"Refresh"),1)],8,q)])])])]),_:1}),o(i,{md:"8",class:"ps-4"},{default:a(()=>[e[24]||(e[24]=l("h4",{class:"fw-bold mb-3 text-primary"},"Edit Profile",-1)),o(C,{onSubmit:S(s.saveGeneralInfo,["prevent"])},{default:a(()=>[o(h,null,{default:a(()=>[o(i,{md:"6",class:"mb-3"},{default:a(()=>[o(f,{label:"Full Name","label-class":"fw-semibold"},{default:a(()=>[o(p,{id:"name",modelValue:r.options.name,"onUpdate:modelValue":e[1]||(e[1]=n=>r.options.name=n),onInput:e[2]||(e[2]=n=>s.RemoveError("name")),state:s.hasErrors("name")?!1:null,readonly:!r.isEditMode,placeholder:"Enter Name",autocomplete:"off"},null,8,["modelValue","state","readonly"]),s.hasErrors("name")?(c(),_("div",z,m(s.getErrors("name")),1)):b("",!0)]),_:1})]),_:1}),o(i,{md:"6",class:"mb-3"},{default:a(()=>[o(f,{label:"Email","label-class":"fw-semibold"},{default:a(()=>[o(p,{modelValue:r.options.email,"onUpdate:modelValue":e[3]||(e[3]=n=>r.options.email=n),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),o(i,{md:"6",class:"mb-3"},{default:a(()=>[o(f,{label:"Phone","label-class":"fw-semibold"},{default:a(()=>[o(p,{id:"phone",modelValue:r.options.phone,"onUpdate:modelValue":e[4]||(e[4]=n=>r.options.phone=n),onInput:e[5]||(e[5]=n=>s.RemoveError("phone")),state:s.hasErrors("phone")?!1:null,readonly:!r.isEditMode,placeholder:"Enter Mobile Number",autocomplete:"off"},null,8,["modelValue","state","readonly"]),s.hasErrors("phone")?(c(),_("div",H,m(s.getErrors("phone")),1)):b("",!0)]),_:1})]),_:1}),o(i,{md:"6",class:"mb-3"},{default:a(()=>[o(f,{label:"Bank Name","label-class":"fw-semibold"},{default:a(()=>[o(p,{id:"bank_name",modelValue:r.options.bank_name,"onUpdate:modelValue":e[6]||(e[6]=n=>r.options.bank_name=n),onInput:e[7]||(e[7]=n=>s.RemoveError("bank_name")),state:s.hasErrors("bank_name")?!1:null,readonly:!r.isEditMode,placeholder:"Enter Bank Name",autocomplete:"off"},null,8,["modelValue","state","readonly"]),s.hasErrors("bank_name")?(c(),_("div",J,m(s.getErrors("bank_name")),1)):b("",!0)]),_:1})]),_:1}),o(i,{md:"6",class:"mb-3"},{default:a(()=>[o(f,{label:"Account Number","label-class":"fw-semibold"},{default:a(()=>[o(p,{id:"account_no",modelValue:r.options.account_no,"onUpdate:modelValue":e[8]||(e[8]=n=>r.options.account_no=n),onInput:e[9]||(e[9]=n=>s.RemoveError("account_no")),state:s.hasErrors("account_no")?!1:null,readonly:!r.isEditMode,placeholder:"Enter Account Number",autocomplete:"off"},null,8,["modelValue","state","readonly"]),s.hasErrors("account_no")?(c(),_("div",j,m(s.getErrors("account_no")),1)):b("",!0)]),_:1})]),_:1}),o(i,{md:"6",class:"mb-3"},{default:a(()=>[o(f,{label:"IFSC Code","label-class":"fw-semibold"},{default:a(()=>[o(p,{id:"ifsc_code",modelValue:r.options.ifsc_code,"onUpdate:modelValue":e[10]||(e[10]=n=>r.options.ifsc_code=n),onInput:e[11]||(e[11]=n=>s.RemoveError("ifsc_code")),state:s.hasErrors("ifsc_code")?!1:null,readonly:!r.isEditMode,placeholder:"Enter IFSC Code",autocomplete:"off"},null,8,["modelValue","state","readonly"]),s.hasErrors("ifsc_code")?(c(),_("div",Q,m(s.getErrors("ifsc_code")),1)):b("",!0)]),_:1})]),_:1})]),_:1}),o(h,null,{default:a(()=>[o(i,{md:"6",class:"mb-3"},{default:a(()=>[o(f,{label:"Aadhar Number","label-class":"fw-semibold"},{default:a(()=>[o(p,{id:"aadhar_number",modelValue:r.options.aadhar_number,"onUpdate:modelValue":e[12]||(e[12]=n=>r.options.aadhar_number=n),onInput:e[13]||(e[13]=n=>s.RemoveError("aadhar_number")),state:s.hasErrors("aadhar_number")?!1:null,readonly:!r.isEditMode,placeholder:"Enter Aadhar Number",autocomplete:"off",maxlength:"12"},null,8,["modelValue","state","readonly"]),s.hasErrors("aadhar_number")?(c(),_("div",K,m(s.getErrors("aadhar_number")),1)):b("",!0)]),_:1})]),_:1}),o(i,{md:"6",class:"mb-3"},{default:a(()=>[o(f,{label:"PAN Card Number","label-class":"fw-semibold"},{default:a(()=>[o(p,{id:"pan_number",modelValue:r.options.pan_number,"onUpdate:modelValue":e[14]||(e[14]=n=>r.options.pan_number=n),onInput:e[15]||(e[15]=n=>s.RemoveError("pan_number")),state:s.hasErrors("pan_number")?!1:null,readonly:!r.isEditMode,placeholder:"Enter PAN Number",autocomplete:"off",maxlength:"10",style:{"text-transform":"uppercase"}},null,8,["modelValue","state","readonly"]),s.hasErrors("pan_number")?(c(),_("div",W,m(s.getErrors("pan_number")),1)):b("",!0)]),_:1})]),_:1})]),_:1}),o(h,null,{default:a(()=>[o(i,{md:"12",class:"mb-3"},{default:a(()=>[o(f,{label:"Address","label-class":"fw-semibold"},{default:a(()=>[o(v,{id:"address",modelValue:r.options.address,"onUpdate:modelValue":e[16]||(e[16]=n=>r.options.address=n),onInput:e[17]||(e[17]=n=>s.RemoveError("address")),state:s.hasErrors("address")?!1:null,readonly:!r.isEditMode,placeholder:"Enter Complete Address",rows:"3",autocomplete:"off"},null,8,["modelValue","state","readonly"]),s.hasErrors("address")?(c(),_("div",X,m(s.getErrors("address")),1)):b("",!0)]),_:1})]),_:1})]),_:1}),l("div",Y,[r.isEditMode?(c(),_(M,{key:0},[o(y,{type:"submit",variant:"success",class:"me-2 rounded-pill px-4"},{default:a(()=>e[21]||(e[21]=[l("i",{class:"bi bi-check-circle me-1"},null,-1),E(" Save Changes ")])),_:1}),o(y,{type:"button",variant:"secondary",class:"rounded-pill px-4",onClick:s.toggleEditMode},{default:a(()=>e[22]||(e[22]=[l("i",{class:"bi bi-x-circle me-1"},null,-1),E(" Cancel ")])),_:1},8,["onClick"])],64)):(c(),x(y,{key:1,type:"button",variant:"primary",class:"me-2 rounded-pill px-4",onClick:s.toggleEditMode},{default:a(()=>e[23]||(e[23]=[l("i",{class:"bi bi-pencil me-1"},null,-1),E(" Edit Profile ")])),_:1},8,["onClick"]))])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1})}const $=I(F,[["render",Z],["__scopeId","data-v-fc327024"]]);P.defaults.withCredentials=!0;const ee={data(){return{showOldPassword:!1,showNewPassword:!1,showConfirmPassword:!1,errors:{}}},methods:{RemoveError(t){this.errors[t]&&delete this.errors[t]},hasErrors(t){return this.errors&&this.errors[t]},getErrors(t){return this.errors[t]?this.errors[t][0]:""},toggleOldPasswordView(){this.showOldPassword=!this.showOldPassword},toggleNewPasswordView(){this.showNewPassword=!this.showNewPassword},toggleConfirmPasswordView(){this.showConfirmPassword=!this.showConfirmPassword}},setup(){const t=N({current_password:"",new_password:"",new_password_confirmation:""}),e=N([]),g=B();return{userpassword:t,changePassword:()=>{P.post("/change-password",t.value).then(r=>{r.data.status==="success"&&U.fire({title:"Success!",text:"Password changed successfully.",icon:"success",timer:2e3,showConfirmButton:!1}).then(()=>{g.replace({name:"dashboard"})})}).catch(r=>{r.response&&r.response.data.code===422&&(e.value=r.response.data.errors)})},errors:e}}},se={key:0,class:"text-danger small"},oe={key:0,class:"text-danger small"},te={key:0,class:"text-danger small"};function re(t,e,g,w,r,s){const i=d("b-form-input"),p=d("b-input-group-append"),f=d("b-input-group"),h=d("b-form-group"),v=d("b-button"),y=d("b-form"),C=d("b-card"),k=d("b-container");return c(),x(k,{fluid:"",class:"main-content"},{default:a(()=>[o(C,{class:"profile-card"},{default:a(()=>[e[10]||(e[10]=l("h4",{class:"mb-4"},"Change Password",-1)),o(y,null,{default:a(()=>[o(h,{label:"Old Password"},{default:a(()=>[o(f,{class:"input-group-merge"},{default:a(()=>[o(i,{type:r.showOldPassword?"text":"password",modelValue:w.userpassword.current_password,"onUpdate:modelValue":e[0]||(e[0]=u=>w.userpassword.current_password=u),id:"current_password",onInput:e[1]||(e[1]=u=>s.RemoveError("current_password")),state:s.hasErrors("current_password")?!1:null,placeholder:"Enter Current Password",autocomplete:"off"},null,8,["type","modelValue","state"]),o(p,{"is-text":""},{default:a(()=>[l("button",{type:"button",onClick:e[2]||(e[2]=(...u)=>s.toggleOldPasswordView&&s.toggleOldPasswordView(...u)),class:"toggle-password-btn"},[l("i",{class:V(r.showOldPassword?"fa fa-eye-slash":"fa fa-eye")},null,2)])]),_:1})]),_:1}),s.hasErrors("current_password")?(c(),_("div",se,m(s.getErrors("current_password")),1)):b("",!0)]),_:1}),o(h,{label:"New Password"},{default:a(()=>[o(f,{class:"input-group-merge"},{default:a(()=>[o(i,{type:r.showNewPassword?"text":"password",modelValue:w.userpassword.new_password,"onUpdate:modelValue":e[3]||(e[3]=u=>w.userpassword.new_password=u),id:"new_password",onInput:e[4]||(e[4]=u=>s.RemoveError("new_password")),state:s.hasErrors("new_password")?!1:null,placeholder:"Enter New Password",autocomplete:"off"},null,8,["type","modelValue","state"]),o(p,{"is-text":""},{default:a(()=>[l("button",{type:"button",onClick:e[5]||(e[5]=(...u)=>s.toggleNewPasswordView&&s.toggleNewPasswordView(...u)),class:"toggle-password-btn"},[l("i",{class:V(r.showNewPassword?"fa fa-eye-slash":"fa fa-eye")},null,2)])]),_:1})]),_:1}),s.hasErrors("new_password")?(c(),_("div",oe,m(s.getErrors("new_password")),1)):b("",!0)]),_:1}),o(h,{label:"Confirm Password"},{default:a(()=>[o(f,{class:"input-group-merge"},{default:a(()=>[o(i,{type:r.showConfirmPassword?"text":"password",modelValue:w.userpassword.new_password_confirmation,"onUpdate:modelValue":e[6]||(e[6]=u=>w.userpassword.new_password_confirmation=u),id:"new_password_confirmation",onInput:e[7]||(e[7]=u=>s.RemoveError("new_password_confirmation")),state:s.hasErrors("new_password_confirmation")?!1:null,placeholder:"Confirm New Password",autocomplete:"off"},null,8,["type","modelValue","state"]),o(p,{"is-text":""},{default:a(()=>[l("button",{type:"button",onClick:e[8]||(e[8]=(...u)=>s.toggleConfirmPasswordView&&s.toggleConfirmPasswordView(...u)),class:"toggle-password-btn"},[l("i",{class:V(r.showConfirmPassword?"fa fa-eye-slash":"fa fa-eye")},null,2)])]),_:1})]),_:1}),s.hasErrors("new_password_confirmation")?(c(),_("div",te,m(s.getErrors("new_password_confirmation")),1)):b("",!0)]),_:1}),o(v,{type:"submit",variant:"success",class:"mt-3",onClick:w.changePassword},{default:a(()=>e[9]||(e[9]=[E(" Change Password ")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})}const ae=I(ee,[["render",re],["__scopeId","data-v-537c2527"]]),le={props:{userId:{type:String,required:!0}},components:{GeneralTab:$,ChangePasswordTab:ae},methods:{logout(){localStorage.removeItem("userData"),localStorage.removeItem("access_token"),localStorage.removeItem("token"),localStorage.removeItem("auth_token"),localStorage.removeItem("user"),sessionStorage.clear(),this.$router.push({name:"login"})}}},ne={class:"profile-tabs-container"},de={class:"tabs-wrapper"},ie={class:"tabs-header"},ue={class:"logout-section"};function me(t,e,g,w,r,s){const i=d("GeneralTab"),p=d("b-tab"),f=d("ChangePasswordTab"),h=d("b-tabs");return c(),_("div",ne,[l("div",de,[l("div",ie,[o(h,{pills:"","content-class":"mt-3","nav-class":"modern-nav-tabs"},{default:a(()=>[o(p,{title:"ðŸ‘¤ General",active:""},{default:a(()=>[o(i,{userId:g.userId},null,8,["userId"])]),_:1}),o(p,{title:"ðŸ”’ Change Password"},{default:a(()=>[o(f,{userId:g.userId},null,8,["userId"])]),_:1})]),_:1}),l("div",ue,[l("button",{onClick:e[0]||(e[0]=(...v)=>s.logout&&s.logout(...v)),class:"logout-btn"},e[1]||(e[1]=[l("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.59L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"})],-1),l("span",null,"Logout",-1)]))])])])])}const pe=I(le,[["render",me],["__scopeId","data-v-90901bd3"]]);export{pe as default};
