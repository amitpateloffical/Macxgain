import{_ as I,l as E,S as U,a,A as k,o as f,k as r,i as s,b as l,f as h,t as u,w as O,c as y,e as C,r as N,u as R,n as x}from"./app-bFpPY_8Q.js";const T={props:{userId:{type:String,required:!0}},data(){return{options:{name:"",email:"",phone:"",role:"",profile_image:""},selectedFile:null,imagePreview:null,errors:{}}},created(){this.getUserProfile()},methods:{RemoveError(o){this.errors[o]&&delete this.errors[o]},hasErrors(o){return this.errors&&this.errors[o]},getErrors(o){return this.errors[o]?this.errors[o][0]:""},getUserProfile(){E.get("/userprofile").then(o=>{this.options=o.data.data}).catch(o=>{})},onFileChange(o){this.selectedFile=o.target.files[0],this.selectedFile&&(this.imagePreview=URL.createObjectURL(this.selectedFile))},triggerFileUpload(){this.$refs.fileInput.click()},saveGeneralInfo(){const o=new FormData;o.append("id",this.options.id),o.append("name",this.options.name),o.append("email",this.options.email),o.append("phone",this.options.phone),o.append("role",this.options.role),this.selectedFile&&o.append("profile_image",this.selectedFile),E.post(`/update-profile/${this.encodeBase64(this.options.id)}`,o,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{this.options=e.data.data,this.selectedFile=null,this.imagePreview=null,window.dispatchEvent(new Event("profileUpdated")),U.fire({icon:"success",title:"Profile updated successfully",timer:1500,showConfirmButton:!1}),this.$router.push("/dashboard")}).catch(e=>{e.response&&e.response.data.code===422&&(this.errors=e.response.data.errors)})},encodeBase64(o){return btoa(o)}}},B={class:"text-danger"},G={key:0,class:"text-danger"},S={class:"text-danger"},D={key:0,class:"text-danger"};function j(o,e,P,d,t,n){const _=a("b-img"),p=a("b-button"),w=a("b-card-text"),m=a("b-col"),g=a("b-form-input"),b=a("b-form-group"),v=a("b-row"),V=a("b-form"),i=a("b-card"),F=a("b-container");return f(),k(F,{fluid:"",class:"main-content"},{default:r(()=>[s(i,{class:"small-card"},{default:r(()=>[s(v,null,{default:r(()=>[s(m,{md:"4",class:"text-center"},{default:r(()=>[s(_,{src:t.imagePreview||`/storage/${t.options.profile_image}?t=${new Date().getTime()}`,rounded:"",class:"profile-avatar mb-3",alt:"User Avatar",onError:o.setDefaultImage},null,8,["src","onError"]),l("div",null,[l("input",{type:"file",ref:"fileInput",onChange:e[0]||(e[0]=(...c)=>n.onFileChange&&n.onFileChange(...c)),id:"profile_image",accept:".jpg, .png, .gif",style:{display:"none"}},null,544),s(p,{variant:"primary",onClick:n.triggerFileUpload},{default:r(()=>e[6]||(e[6]=[h("Upload Image")])),_:1},8,["onClick"])]),s(w,{class:"mt-2 small-text"},{default:r(()=>e[7]||(e[7]=[h(" (Allowed JPG, GIF, or PNG. Max size of 800kB) ")])),_:1}),l("h5",null,u(t.options.name),1),l("p",null,[e[8]||(e[8]=l("strong",null,"Email: ",-1)),h(u(t.options.email),1)]),l("p",null,[e[9]||(e[9]=l("strong",null,"Contact No: ",-1)),h(u(t.options.phone),1)])]),_:1}),s(m,{md:"8"},{default:r(()=>[s(V,{onSubmit:O(n.saveGeneralInfo,["prevent"]),class:"mt-3"},{default:r(()=>[s(v,null,{default:r(()=>[s(m,{md:"6"},{default:r(()=>[s(b,{label:"Name"},{default:r(()=>[s(g,{id:"name",modelValue:t.options.name,"onUpdate:modelValue":e[1]||(e[1]=c=>t.options.name=c),onInput:e[2]||(e[2]=c=>n.RemoveError("name")),state:t.errors.length>0?!1:null,placeholder:"Enter Name",autocomplete:"off"},null,8,["modelValue","state"]),l("small",B,u(t.errors[0]),1),n.hasErrors("name")?(f(),y("div",G,u(n.getErrors("name")),1)):C("",!0)]),_:1})]),_:1}),s(m,{md:"6"},{default:r(()=>[s(b,{label:"Email"},{default:r(()=>[s(g,{modelValue:t.options.email,"onUpdate:modelValue":e[3]||(e[3]=c=>t.options.email=c),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),s(b,{label:"Phone"},{default:r(()=>[s(g,{id:"phone",modelValue:t.options.phone,"onUpdate:modelValue":e[4]||(e[4]=c=>t.options.phone=c),onInput:e[5]||(e[5]=c=>n.RemoveError("phone")),state:t.errors.length>0?!1:null,placeholder:"Enter Mobile Number",autocomplete:"off"},null,8,["modelValue","state"]),l("small",S,u(t.errors[0]),1),n.hasErrors("phone")?(f(),y("div",D,u(n.getErrors("phone")),1)):C("",!0)]),_:1})]),_:1}),s(p,{type:"submit",variant:"primary",class:"me-2"},{default:r(()=>e[10]||(e[10]=[h("Save")])),_:1}),s(p,{type:"reset",variant:"secondary"},{default:r(()=>e[11]||(e[11]=[h("Cancel")])),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1})}const A=I(T,[["render",j],["__scopeId","data-v-07bbef33"]]);E.defaults.withCredentials=!0;const M={data(){return{showOldPassword:!1,showNewPassword:!1,showConfirmPassword:!1,errors:{}}},methods:{RemoveError(o){this.errors[o]&&delete this.errors[o]},hasErrors(o){return this.errors&&this.errors[o]},getErrors(o){return this.errors[o]?this.errors[o][0]:""},toggleOldPasswordView(){this.showOldPassword=!this.showOldPassword},toggleNewPasswordView(){this.showNewPassword=!this.showNewPassword},toggleConfirmPasswordView(){this.showConfirmPassword=!this.showConfirmPassword}},setup(){const o=N({current_password:"",new_password:"",new_password_confirmation:""}),e=N([]),P=R();return{userpassword:o,changePassword:()=>{E.post("/change-password",o.value).then(t=>{t.data.status==="success"&&U.fire({title:"Success!",text:"Password changed successfully.",icon:"success",timer:2e3,showConfirmButton:!1}).then(()=>{P.replace({name:"dashboard"})})}).catch(t=>{t.response&&t.response.data.code===422&&(e.value=t.response.data.errors)})},errors:e}}},q={class:"text-danger"},z={key:0,class:"text-danger"},L={class:"text-danger"},J={key:0,class:"text-danger"},H={class:"text-danger"},K={key:0,class:"text-danger"};function Q(o,e,P,d,t,n){const _=a("b-form-input"),p=a("b-input-group-append"),w=a("b-input-group"),m=a("b-form-group"),g=a("b-button"),b=a("b-form"),v=a("b-card"),V=a("b-container");return f(),k(V,{fluid:"",class:"main-content"},{default:r(()=>[s(v,{class:"small-card"},{default:r(()=>[s(b,null,{default:r(()=>[s(m,{label:"Old Password"},{default:r(()=>[s(w,{class:"input-group-merge"},{default:r(()=>[s(_,{type:t.showOldPassword?"text":"password",modelValue:d.userpassword.current_password,"onUpdate:modelValue":e[0]||(e[0]=i=>d.userpassword.current_password=i),id:"current_password",onInput:e[1]||(e[1]=i=>n.RemoveError("current_password")),state:d.errors.length>0?!1:null,placeholder:"Enter Current Password",autocomplete:"off"},null,8,["type","modelValue","state"]),s(p,{"is-text":""},{default:r(()=>[l("button",{type:"button",onClick:e[2]||(e[2]=(...i)=>n.toggleOldPasswordView&&n.toggleOldPasswordView(...i)),class:"toggle-password-btn"},[l("i",{class:x(t.showOldPassword?"fa fa-eye-slash":"fa fa-eye")},null,2)])]),_:1})]),_:1}),l("small",q,u(d.errors[0]),1),n.hasErrors("current_password")?(f(),y("div",z,u(n.getErrors("current_password")),1)):C("",!0)]),_:1}),s(m,{label:"New Password"},{default:r(()=>[s(w,{class:"input-group-merge"},{default:r(()=>[s(_,{type:t.showNewPassword?"text":"password",modelValue:d.userpassword.new_password,"onUpdate:modelValue":e[3]||(e[3]=i=>d.userpassword.new_password=i),id:"new_password",onInput:e[4]||(e[4]=i=>n.RemoveError("new_password")),state:d.errors.length>0?!1:null,placeholder:"Enter New Password",autocomplete:"off"},null,8,["type","modelValue","state"]),s(p,{"is-text":""},{default:r(()=>[l("button",{type:"button",onClick:e[5]||(e[5]=(...i)=>n.toggleNewPasswordView&&n.toggleNewPasswordView(...i)),class:"toggle-password-btn"},[l("i",{class:x(t.showNewPassword?"fa fa-eye-slash":"fa fa-eye")},null,2)])]),_:1})]),_:1}),l("small",L,u(d.errors[0]),1),n.hasErrors("new_password")?(f(),y("div",J,u(n.getErrors("new_password")),1)):C("",!0)]),_:1}),s(m,{label:"Confirm Password"},{default:r(()=>[s(w,{class:"input-group-merge"},{default:r(()=>[s(_,{type:t.showConfirmPassword?"text":"password",modelValue:d.userpassword.new_password_confirmation,"onUpdate:modelValue":e[6]||(e[6]=i=>d.userpassword.new_password_confirmation=i),id:"new_password_confirmation",onInput:e[7]||(e[7]=i=>n.RemoveError("new_password_confirmation")),state:d.errors.length>0?!1:null,placeholder:"Enter New Confirm Password",autocomplete:"off"},null,8,["type","modelValue","state"]),s(p,{"is-text":""},{default:r(()=>[l("button",{type:"button",onClick:e[8]||(e[8]=(...i)=>n.toggleConfirmPasswordView&&n.toggleConfirmPasswordView(...i)),class:"toggle-password-btn"},[l("i",{class:x(t.showConfirmPassword?"fa fa-eye-slash":"fa fa-eye")},null,2)])]),_:1})]),_:1}),l("small",H,u(d.errors[0]),1),n.hasErrors("new_password_confirmation")?(f(),y("div",K,u(n.getErrors("new_password_confirmation")),1)):C("",!0)]),_:1}),s(g,{type:"submit",variant:"primary",onClick:d.changePassword},{default:r(()=>e[9]||(e[9]=[h("Change Password")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})}const W=I(M,[["render",Q],["__scopeId","data-v-65a0c895"]]),X={props:{userId:{type:String,required:!0}},components:{GeneralTab:A,ChangePasswordTab:W}};function Y(o,e,P,d,t,n){const _=a("GeneralTab"),p=a("b-tab"),w=a("ChangePasswordTab"),m=a("b-tabs"),g=a("b-col"),b=a("b-row"),v=a("b-container");return f(),k(v,{fluid:"",class:"main-content"},{default:r(()=>[s(b,null,{default:r(()=>[s(g,null,{default:r(()=>[s(m,{pills:"","content-class":"mt-3","nav-class":"justify-content-center"},{default:r(()=>[s(p,{title:"General",active:""},{default:r(()=>[s(_,{userId:P.userId},null,8,["userId"])]),_:1}),s(p,{title:"Change Password"},{default:r(()=>[s(w,{userId:P.userId},null,8,["userId"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const $=I(X,[["render",Y]]);export{$ as default};
