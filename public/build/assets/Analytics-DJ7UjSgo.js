import{_ as lt,f as n,D as j,E as nt,Z as ot,L as it,c as u,o as d,b as t,h as D,i as c,n as p,j as h,X as V,a as rt,v as x,t as l,F as O,r as W}from"./app-FjP-1z21.js";const ut={class:"analytics-screen"},dt={class:"analytics-header"},ct={class:"header-content"},vt={class:"header-actions"},pt=["disabled"],mt={class:"filter-section"},ft={class:"filter-controls"},ht={class:"filter-group"},gt={key:0,class:"filter-group"},bt={key:1,class:"filter-group"},wt={class:"metrics-section"},_t={class:"metrics-grid"},Dt={class:"metric-card total-users"},yt={class:"metric-content"},$t={class:"metric-value"},St={class:"metric-change positive"},Ut={class:"metric-card active-users"},Ct={class:"metric-content"},Lt={class:"metric-value"},Rt={class:"metric-change positive"},kt={class:"metric-card total-deposits"},Tt={class:"metric-content"},At={class:"metric-value"},xt={class:"metric-change positive"},Pt={class:"metric-card total-withdrawals"},It={class:"metric-content"},Nt={class:"metric-value"},Mt={class:"metric-card net-revenue"},Et={class:"metric-content"},Ft={class:"metric-value"},Vt={class:"data-section"},jt={class:"data-tabs"},Ot={key:0,class:"tab-content"},Wt={class:"table-header"},Bt={class:"table-actions"},Gt={class:"table-container"},qt={class:"data-table"},Jt={key:1,class:"tab-content"},zt={class:"table-header"},Yt={class:"table-actions"},Ht={class:"table-container"},Xt={class:"data-table"},Zt={key:2,class:"tab-content"},Kt={class:"table-header"},Qt={class:"table-actions"},te={class:"table-container"},ee={class:"data-table"},se={key:0,class:"loading-overlay"},ae={__name:"Analytics",setup(le){const y=n(!1),r=n("current_month"),$=n(""),S=n(""),f=n("users"),P=n(""),I=n("all"),N=n(""),M=n("all"),E=n(""),F=n("all"),U=n(0),C=n(0),L=n(0),R=n(0),k=n(0),B=n(0),G=n(0),q=n(0),T=n(0),A=n(0),b=n([]),w=n([]),_=n([]),z=`${window.location.origin}/api`,Y=j(()=>{let a=b.value;if(P.value){const e=P.value.toLowerCase();a=a.filter(s=>s.name.toLowerCase().includes(e)||s.email.toLowerCase().includes(e))}return I.value!=="all"&&(a=a.filter(e=>e.status===I.value)),a}),H=j(()=>{let a=w.value;if(N.value){const e=N.value.toLowerCase();a=a.filter(s=>s.transaction_id.toLowerCase().includes(e)||s.user_name.toLowerCase().includes(e))}return M.value!=="all"&&(a=a.filter(e=>e.status===M.value)),a}),X=j(()=>{let a=_.value;if(E.value){const e=E.value.toLowerCase();a=a.filter(s=>s.transaction_id.toLowerCase().includes(e)||s.user_name.toLowerCase().includes(e))}return F.value!=="all"&&(a=a.filter(e=>e.status===F.value)),a}),Z=async()=>{await g()},g=async()=>{try{y.value=!0;const a=localStorage.getItem("access_token");if(!a)throw new Error("No access token found");const e=await fetch(`${z}/analytics?period=${r.value}&start_date=${$.value}&end_date=${S.value}`,{headers:{Authorization:`Bearer ${a}`,Accept:"application/json"}});if(!e.ok)throw new Error("Failed to fetch analytics data");const s=await e.json();s.success&&(U.value=s.metrics.total_users,C.value=s.metrics.active_users,L.value=s.metrics.total_deposits,R.value=s.metrics.total_withdrawals,k.value=s.metrics.net_revenue,B.value=s.growth_rates.user_growth,G.value=s.growth_rates.active_user_growth,q.value=s.growth_rates.deposit_growth,T.value=s.growth_rates.withdrawal_growth,A.value=s.growth_rates.revenue_growth,b.value=s.users,w.value=s.deposits,_.value=s.withdrawals)}catch(a){console.error("Error updating analytics data:",a)}finally{y.value=!1}},K=()=>{const a={period:r.value,metrics:{totalUsers:U.value,activeUsers:C.value,totalDeposits:L.value,totalWithdrawals:R.value,netRevenue:k.value},users:b.value,deposits:w.value,withdrawals:_.value},e=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),s=URL.createObjectURL(e),v=document.createElement("a");v.href=s,v.download=`analytics-report-${r.value}-${new Date().toISOString().split("T")[0]}.json`,v.click(),URL.revokeObjectURL(s)},Q=()=>{let a="";a+=`Analytics Report
`,a+=`Period: ${r.value}
`,a+=`Generated: ${new Date().toLocaleString()}

`,a+=`Metrics
`,a+=`Metric,Value
`,a+=`Total Users,${U.value}
`,a+=`Active Users,${C.value}
`,a+=`Total Deposits,â‚¹${i(L.value)}
`,a+=`Total Withdrawals,â‚¹${i(R.value)}
`,a+=`Net Revenue,â‚¹${i(k.value)}

`,b.value.length>0&&(a+=`Users Data
`,a+=`ID,Name,Email,Status,Registration Date,Last Login,Total Balance
`,b.value.forEach(o=>{a+=`${o.id},"${o.name}","${o.email}","${J(o.status)}","${m(o.created_at)}","${m(o.last_login_at)||"Never"}",â‚¹${i(o.total_balance||0)}
`}),a+=`
`),w.value.length>0&&(a+=`Deposits Data
`,a+=`Transaction ID,User,Amount,Status,Date,Description
`,w.value.forEach(o=>{a+=`${o.transaction_id},"${o.user_name}",â‚¹${i(o.amount)},"${o.status}","${m(o.created_at)}","${o.description||"N/A"}"
`}),a+=`
`),_.value.length>0&&(a+=`Withdrawals Data
`,a+=`Transaction ID,User,Amount,Status,Request Date,Processed Date
`,_.value.forEach(o=>{a+=`${o.transaction_id},"${o.user_name}",â‚¹${i(o.amount)},"${o.status}","${m(o.created_at)}","${m(o.updated_at)||"Pending"}"
`}));const e=new Blob([a],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(e),v=document.createElement("a");v.href=s,v.download=`analytics-report-${r.value}-${new Date().toISOString().split("T")[0]}.csv`,v.click(),URL.revokeObjectURL(s)},tt=()=>{try{const a=`
Analytics Report
Period: ${r.value}
Generated: ${new Date().toLocaleString()}

METRICS:
- Total Users: ${U.value}
- Active Users: ${C.value}
- Total Deposits: â‚¹${i(L.value)}
- Total Withdrawals: â‚¹${i(R.value)}
- Net Revenue: â‚¹${i(k.value)}

USERS: ${b.value.length}
DEPOSITS: ${w.value.length}
WITHDRAWALS: ${_.value.length}
    `,e=new Blob([a],{type:"text/plain"}),s=URL.createObjectURL(e),v=document.createElement("a");v.href=s,v.download=`analytics-report-${r.value}-${new Date().toISOString().split("T")[0]}.txt`,v.click(),URL.revokeObjectURL(s),alert("PDF export is being prepared. For now, a text file has been downloaded. Full PDF support will be added soon!")}catch(a){console.error("PDF export error:",a),alert("PDF export failed. Please try CSV or JSON export instead.")}},i=a=>new Intl.NumberFormat("en-IN").format(a),m=a=>a?new Date(a).toLocaleDateString("en-IN"):"N/A",et=a=>({A:"active",I:"inactive",P:"pending"})[a]||"unknown",J=a=>({A:"Active",I:"Inactive",P:"Pending"})[a]||"Unknown",st=a=>({completed:"success",pending:"warning",failed:"danger"})[a]||"neutral",at=a=>({completed:"success",pending:"warning",rejected:"danger"})[a]||"neutral";return nt(async()=>{await g()}),ot(()=>{}),it([r,$,S],()=>{(r.value==="custom"&&$.value&&S.value||r.value!=="custom")&&g()}),(a,e)=>(d(),u("div",ut,[t("div",dt,[t("div",ct,[e[16]||(e[16]=t("div",{class:"header-left"},[t("h1",{class:"page-title"},[t("i",{class:"fa-solid fa-chart-line"}),c(" Analytics Dashboard ")]),t("p",{class:"page-subtitle"}," Comprehensive insights into your platform's performance (Manual refresh only) ")],-1)),t("div",vt,[t("button",{class:"btn-refresh",onClick:Z,disabled:y.value},[t("i",{class:p(["fa-solid fa-rotate",{"fa-spin":y.value}])},null,2),e[12]||(e[12]=c(" Refresh "))],8,pt),t("div",{class:"export-buttons"},[t("button",{class:"btn-export csv",onClick:Q},e[13]||(e[13]=[t("i",{class:"fa-solid fa-file-csv"},null,-1),c(" CSV ")])),t("button",{class:"btn-export pdf",onClick:tt},e[14]||(e[14]=[t("i",{class:"fa-solid fa-file-pdf"},null,-1),c(" PDF ")])),t("button",{class:"btn-export json",onClick:K},e[15]||(e[15]=[t("i",{class:"fa-solid fa-file-code"},null,-1),c(" JSON ")]))])])])]),t("div",mt,[t("div",ft,[t("div",ht,[e[18]||(e[18]=t("label",{class:"filter-label"},"Time Period",-1)),h(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>r.value=s),class:"filter-select",onChange:g},e[17]||(e[17]=[rt('<option value="current_month" data-v-fa703557>Current Month</option><option value="last_month" data-v-fa703557>Last Month</option><option value="last_3_months" data-v-fa703557>Last 3 Months</option><option value="last_6_months" data-v-fa703557>Last 6 Months</option><option value="current_year" data-v-fa703557>Current Year</option><option value="last_year" data-v-fa703557>Last Year</option><option value="custom" data-v-fa703557>Custom Range</option>',7)]),544),[[V,r.value]])]),r.value==="custom"?(d(),u("div",gt,[e[19]||(e[19]=t("label",{class:"filter-label"},"From Date",-1)),h(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=s=>$.value=s),class:"filter-input",onChange:g},null,544),[[x,$.value]])])):D("",!0),r.value==="custom"?(d(),u("div",bt,[e[20]||(e[20]=t("label",{class:"filter-label"},"To Date",-1)),h(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>S.value=s),class:"filter-input",onChange:g},null,544),[[x,S.value]])])):D("",!0)])]),t("div",wt,[t("div",_t,[t("div",Dt,[e[23]||(e[23]=t("div",{class:"metric-icon"},"ðŸ‘¥",-1)),t("div",yt,[e[22]||(e[22]=t("h3",{class:"metric-title"},"Total Users",-1)),t("div",$t,l(i(U.value)),1),t("div",St,[e[21]||(e[21]=t("i",{class:"fa-solid fa-arrow-up"},null,-1)),c(" +"+l(B.value)+"% this month ",1)])])]),t("div",Ut,[e[26]||(e[26]=t("div",{class:"metric-icon"},"ðŸŸ¢",-1)),t("div",Ct,[e[25]||(e[25]=t("h3",{class:"metric-title"},"Active Users",-1)),t("div",Lt,l(i(C.value)),1),t("div",Rt,[e[24]||(e[24]=t("i",{class:"fa-solid fa-arrow-up"},null,-1)),c(" +"+l(G.value)+"% this month ",1)])])]),t("div",kt,[e[29]||(e[29]=t("div",{class:"metric-icon"},"ðŸ’°",-1)),t("div",Tt,[e[28]||(e[28]=t("h3",{class:"metric-title"},"Total Deposits",-1)),t("div",At,"â‚¹"+l(i(L.value)),1),t("div",xt,[e[27]||(e[27]=t("i",{class:"fa-solid fa-arrow-up"},null,-1)),c(" +"+l(q.value)+"% this month ",1)])])]),t("div",Pt,[e[31]||(e[31]=t("div",{class:"metric-icon"},"ðŸ’³",-1)),t("div",It,[e[30]||(e[30]=t("h3",{class:"metric-title"},"Total Withdrawals",-1)),t("div",Nt,"â‚¹"+l(i(R.value)),1),t("div",{class:p(["metric-change",T.value>=0?"positive":"negative"])},[t("i",{class:p(T.value>=0?"fa-solid fa-arrow-up":"fa-solid fa-arrow-down")},null,2),c(" "+l(T.value>=0?"+":"")+l(T.value)+"% this month ",1)],2)])]),t("div",Mt,[e[33]||(e[33]=t("div",{class:"metric-icon"},"ðŸ’°",-1)),t("div",Et,[e[32]||(e[32]=t("h3",{class:"metric-title"},"Net Revenue",-1)),t("div",Ft,"â‚¹"+l(i(k.value)),1),t("div",{class:p(["metric-change",A.value>=0?"positive":"negative"])},[t("i",{class:p(A.value>=0?"fa-solid fa-arrow-up":"fa-solid fa-arrow-down")},null,2),c(" "+l(A.value>=0?"+":"")+l(A.value)+"% this month ",1)],2)])])])]),t("div",Vt,[t("div",jt,[t("button",{class:p(["tab-btn",{active:f.value==="users"}]),onClick:e[3]||(e[3]=s=>f.value="users")},e[34]||(e[34]=[t("i",{class:"fa-solid fa-users"},null,-1),c(" Users Data ")]),2),t("button",{class:p(["tab-btn",{active:f.value==="deposits"}]),onClick:e[4]||(e[4]=s=>f.value="deposits")},e[35]||(e[35]=[t("i",{class:"fa-solid fa-money-bill-wave"},null,-1),c(" Deposits ")]),2),t("button",{class:p(["tab-btn",{active:f.value==="withdrawals"}]),onClick:e[5]||(e[5]=s=>f.value="withdrawals")},e[36]||(e[36]=[t("i",{class:"fa-solid fa-credit-card"},null,-1),c(" Withdrawals ")]),2)]),f.value==="users"?(d(),u("div",Ot,[t("div",Wt,[e[38]||(e[38]=t("h3",null,"User Registration Details",-1)),t("div",Bt,[h(t("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=s=>P.value=s),placeholder:"Search users...",class:"search-input"},null,512),[[x,P.value]]),h(t("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>I.value=s),class:"filter-select"},e[37]||(e[37]=[t("option",{value:"all"},"All Status",-1),t("option",{value:"active"},"Active",-1),t("option",{value:"inactive"},"Inactive",-1),t("option",{value:"pending"},"Pending",-1)]),512),[[V,I.value]])])]),t("div",Gt,[t("table",qt,[e[39]||(e[39]=t("thead",null,[t("tr",null,[t("th",null,"User ID"),t("th",null,"Name"),t("th",null,"Email"),t("th",null,"Status"),t("th",null,"Registration Date"),t("th",null,"Last Login"),t("th",null,"Total Balance")])],-1)),t("tbody",null,[(d(!0),u(O,null,W(Y.value,s=>(d(),u("tr",{key:s.id},[t("td",null,l(s.id),1),t("td",null,l(s.name),1),t("td",null,l(s.email),1),t("td",null,[t("span",{class:p(["status-badge",et(s.status)])},l(J(s.status)),3)]),t("td",null,l(m(s.created_at)),1),t("td",null,l(m(s.last_login_at)||"Never"),1),t("td",null,"â‚¹"+l(i(s.total_balance||0)),1)]))),128))])])])])):D("",!0),f.value==="deposits"?(d(),u("div",Jt,[t("div",zt,[e[41]||(e[41]=t("h3",null,"Deposit Transactions",-1)),t("div",Yt,[h(t("input",{type:"text","onUpdate:modelValue":e[8]||(e[8]=s=>N.value=s),placeholder:"Search deposits...",class:"search-input"},null,512),[[x,N.value]]),h(t("select",{"onUpdate:modelValue":e[9]||(e[9]=s=>M.value=s),class:"filter-select"},e[40]||(e[40]=[t("option",{value:"all"},"All Status",-1),t("option",{value:"completed"},"Completed",-1),t("option",{value:"pending"},"Pending",-1),t("option",{value:"failed"},"Failed",-1)]),512),[[V,M.value]])])]),t("div",Ht,[t("table",Xt,[e[42]||(e[42]=t("thead",null,[t("tr",null,[t("th",null,"Transaction ID"),t("th",null,"User"),t("th",null,"Amount"),t("th",null,"Status"),t("th",null,"Date"),t("th",null,"Description")])],-1)),t("tbody",null,[(d(!0),u(O,null,W(H.value,s=>(d(),u("tr",{key:s.id},[t("td",null,l(s.transaction_id),1),t("td",null,l(s.user_name),1),t("td",null,"â‚¹"+l(i(s.amount)),1),t("td",null,[t("span",{class:p(["status-badge",st(s.status)])},l(s.status),3)]),t("td",null,l(m(s.created_at)),1),t("td",null,l(s.description||"N/A"),1)]))),128))])])])])):D("",!0),f.value==="withdrawals"?(d(),u("div",Zt,[t("div",Kt,[e[44]||(e[44]=t("h3",null,"Withdrawal Transactions",-1)),t("div",Qt,[h(t("input",{type:"text","onUpdate:modelValue":e[10]||(e[10]=s=>E.value=s),placeholder:"Search withdrawals...",class:"search-input"},null,512),[[x,E.value]]),h(t("select",{"onUpdate:modelValue":e[11]||(e[11]=s=>F.value=s),class:"filter-select"},e[43]||(e[43]=[t("option",{value:"all"},"All Status",-1),t("option",{value:"completed"},"Completed",-1),t("option",{value:"pending"},"Pending",-1),t("option",{value:"rejected"},"Rejected",-1)]),512),[[V,F.value]])])]),t("div",te,[t("table",ee,[e[45]||(e[45]=t("thead",null,[t("tr",null,[t("th",null,"Transaction ID"),t("th",null,"User"),t("th",null,"Amount"),t("th",null,"Status"),t("th",null,"Request Date"),t("th",null,"Processed Date")])],-1)),t("tbody",null,[(d(!0),u(O,null,W(X.value,s=>(d(),u("tr",{key:s.id},[t("td",null,l(s.transaction_id),1),t("td",null,l(s.user_name),1),t("td",null,"â‚¹"+l(i(s.amount)),1),t("td",null,[t("span",{class:p(["status-badge",at(s.status)])},l(s.status),3)]),t("td",null,l(m(s.created_at)),1),t("td",null,l(m(s.updated_at)||"Pending"),1)]))),128))])])])])):D("",!0)]),y.value?(d(),u("div",se,e[46]||(e[46]=[t("div",{class:"loading-content"},[t("i",{class:"fa-solid fa-spinner fa-spin"}),t("p",null,"Loading analytics data...")],-1)]))):D("",!0)]))}},oe=lt(ae,[["__scopeId","data-v-fa703557"]]);export{oe as default};
