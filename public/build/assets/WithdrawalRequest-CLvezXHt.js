import{_ as O,f as c,D as q,E as U,L as z,g as x,c as n,o,a as T,b as e,l as N,h as i,F as A,r as D,t as l,q as G,i as m,s as L,n as b}from"./app-BIx6yWNQ.js";const H={class:"withdrawal-request-screen"},J={class:"status-tabs"},K=["onClick"],Q={class:"status-count"},X={class:"requests-container"},Y={key:0,class:"no-requests"},Z={key:1,class:"requests-grid"},ee={class:"request-header"},te={class:"user-info"},se={class:"user-avatar"},ae=["src","alt"],le={class:"user-details"},ne={class:"user-name"},oe={class:"user-email"},ie={class:"user-phone"},de={class:"status-badge"},re={class:"request-details"},ce={class:"detail-row"},ue={class:"detail-value amount"},ve={class:"detail-row"},pe={class:"detail-value"},_e={key:0,class:"detail-row"},me={class:"detail-value bank-details"},be={key:1,class:"detail-row"},fe={class:"detail-value"},ge={key:2,class:"detail-row"},he={class:"detail-value reject-reason"},ke={key:3,class:"detail-row"},je={class:"detail-value"},we={class:"request-actions"},ye=["onClick"],Re=["onClick"],Ce={key:2,class:"btn-action btn-lock",disabled:""},Pe={class:"status-timeline"},Ve={class:"timeline-content"},qe={class:"timeline-date"},xe={class:"timeline-icon"},Ne={class:"timeline-content"},Ae={class:"timeline-status"},De={key:0,class:"timeline-date"},Le={class:"request-actions mt-3 d-flex justify-content-end"},Se={key:0,class:"pagination"},$e=["disabled"],Ee=["disabled"],Fe={key:1,class:"loading-indicator"},Be={__name:"WithdrawalRequest",setup(Me){const d=c("all"),f=c([]),k=c(!1),r=c(1),y=c(10),j=c(0),v=c(!1),u=c(""),w=c(null),S=[{value:"all",label:"All Requests"},{value:"pending",label:"Pending"},{value:"approved",label:"Approved"},{value:"rejected",label:"Rejected"}],R=q(()=>d.value==="all"?f.value:f.value.filter(a=>a.status===d.value)),g=q(()=>Math.ceil(j.value/y.value)),p=async()=>{try{k.value=!0;const a=await L.get("/withdrawal-request",{params:{page:r.value,perPage:y.value,status:d.value==="all"?null:d.value}});f.value=a.data.data,j.value=a.data.total}catch(a){console.error("Error fetching requests:",a),alert("Failed to load withdrawal requests")}finally{k.value=!1}},C=async(a,t)=>{try{const _=t==="rejected"?{reject_reason:u.value}:{};await L.patch(`/withdrawal-request/${a}/status`,{status:t,..._}),await p(),t==="rejected"&&(v.value=!1,u.value="",w.value=null),alert(`Request has been ${t} successfully!`)}catch(_){console.error("Error updating request status:",_),alert("Failed to update request status")}},$=a=>{w.value=a,u.value="",v.value=!0},E=()=>{if(!u.value.trim()){alert("Please enter a rejection reason");return}C(w.value,"rejected")},F=a=>a==="all"?j.value:f.value.filter(t=>t.status===a).length,P=a=>({pending:"status-pending",approved:"status-approved",rejected:"status-rejected"})[a]||"status-pending",B=a=>({pending:"Pending",approved:"Approved",rejected:"Rejected"})[a]||"Pending",h=a=>a?new Date(a).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",M=()=>{r.value<g.value&&(r.value++,p())},I=()=>{r.value>1&&(r.value--,p())};return U(p),z(d,(a,t)=>{a!==t&&(r.value=1,p())}),(a,t)=>{const _=x("b-form-textarea"),W=x("b-modal");return o(),n("div",H,[t[19]||(t[19]=T('<div class="page-header" data-v-ce8ebea3><div class="header-content" data-v-ce8ebea3><h1 class="page-title" data-v-ce8ebea3>ðŸ’³ Withdrawal Request</h1><p class="page-subtitle" data-v-ce8ebea3>Manage and process withdrawal requests from users</p></div><div class="header-actions" data-v-ce8ebea3></div></div>',1)),e("div",J,[(o(),n(A,null,D(S,s=>e("button",{key:s.value,class:b(["status-tab",{active:d.value===s.value}]),onClick:V=>d.value=s.value},[m(l(s.label)+" ",1),e("span",Q,l(F(s.value)),1)],10,K)),64))]),e("div",X,[R.value.length===0?(o(),n("div",Y,[t[3]||(t[3]=e("div",{class:"no-requests-icon"},"ðŸ“­",-1)),e("h3",null,"No "+l(d.value==="all"?"":d.value)+" requests found",1),t[4]||(t[4]=e("p",null,"No withdrawal requests available at the moment",-1))])):(o(),n("div",Z,[(o(!0),n(A,null,D(R.value,s=>(o(),n("div",{key:s.id,class:b(["request-card",P(s.status)])},[e("div",ee,[e("div",te,[e("div",se,[e("img",{src:s.requester.profile_image||"../assest/img/tableprofileimg.png",alt:s.requester.name},null,8,ae)]),e("div",le,[e("h4",ne,l(s.requester.name),1),e("p",oe,l(s.requester.email),1),e("p",ie,l(s.requester.mobile_code)+" "+l(s.requester.phone),1)])]),e("div",{class:b(["request-status",P(s.status)])},[e("span",de,l(B(s.status)),1)],2)]),e("div",re,[e("div",ce,[t[5]||(t[5]=e("span",{class:"detail-label"},"Amount:",-1)),e("span",ue,"â‚¹"+l(parseFloat(s.amount).toLocaleString()),1)]),e("div",ve,[t[6]||(t[6]=e("span",{class:"detail-label"},"Requested:",-1)),e("span",pe,l(h(s.created_at)),1)]),s.requester.bank_name?(o(),n("div",_e,[t[7]||(t[7]=e("span",{class:"detail-label"},"Bank Details:",-1)),e("span",me,l(s.requester.bank_name)+" - "+l(s.requester.account_no)+" - "+l(s.requester.ifsc_code),1)])):i("",!0),s.description?(o(),n("div",be,[t[8]||(t[8]=e("span",{class:"detail-label"},"Reason:",-1)),e("span",fe,l(s.description),1)])):i("",!0),s.reject_reason?(o(),n("div",ge,[t[9]||(t[9]=e("span",{class:"detail-label"},"Rejection Reason:",-1)),e("span",he,l(s.reject_reason),1)])):i("",!0),s.approve_date?(o(),n("div",ke,[t[10]||(t[10]=e("span",{class:"detail-label"},"Processed On:",-1)),e("span",je,l(h(s.approve_date)),1)])):i("",!0)]),e("div",we,[s.status==="pending"?(o(),n("button",{key:0,class:"btn-action btn-approve",onClick:V=>C(s.id,"approved")},t[11]||(t[11]=[e("i",{class:"fa-solid fa-check"},null,-1),m(" Approve ")]),8,ye)):i("",!0),s.status==="pending"?(o(),n("button",{key:1,class:"btn-action btn-reject",onClick:V=>$(s.id)},t[12]||(t[12]=[e("i",{class:"fa-solid fa-times"},null,-1),m(" Reject ")]),8,Re)):i("",!0),s.status!=="pending"?(o(),n("button",Ce,[t[13]||(t[13]=e("i",{class:"fa-solid fa-lock"},null,-1)),m(" "+l(s.status==="approved"?"Approved":"Rejected"),1)])):i("",!0)]),e("div",Pe,[e("div",{class:b(["timeline-item",{active:["pending","approved","rejected"].includes(s.status)}])},[t[15]||(t[15]=e("div",{class:"timeline-icon"},"ðŸ“",-1)),e("div",Ve,[t[14]||(t[14]=e("span",{class:"timeline-status"},"Request Submitted",-1)),e("span",qe,l(h(s.created_at)),1)])],2),e("div",{class:b(["timeline-item",{active:["approved","rejected"].includes(s.status)}])},[e("div",xe,l(s.status==="approved"?"âœ…":"âŒ"),1),e("div",Ne,[e("span",Ae,l(s.status==="approved"?"Approved":"Rejected"),1),s.approve_date?(o(),n("span",De,l(h(s.approve_date)),1)):i("",!0)])],2)])],2))),128))]))]),N(W,{modelValue:v.value,"onUpdate:modelValue":t[2]||(t[2]=s=>v.value=s),title:"Reject Request","hide-footer":""},{default:G(()=>[e("div",null,[N(_,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=s=>u.value=s),placeholder:"Enter rejection reason",rows:"4",class:"w-100"},null,8,["modelValue"]),e("div",Le,[e("button",{onClick:E,class:"btn-action btn-approve me-2"}," Confirm "),e("button",{onClick:t[1]||(t[1]=s=>v.value=!1),class:"btn-action btn-reject"}," Cancel ")])])]),_:1},8,["modelValue"]),g.value>1?(o(),n("div",Se,[e("button",{onClick:I,disabled:r.value===1},t[16]||(t[16]=[e("i",{class:"fa-solid fa-chevron-left"},null,-1)]),8,$e),e("span",null,"Page "+l(r.value)+" of "+l(g.value),1),e("button",{onClick:M,disabled:r.value===g.value},t[17]||(t[17]=[e("i",{class:"fa-solid fa-chevron-right"},null,-1)]),8,Ee)])):i("",!0),k.value?(o(),n("div",Fe,t[18]||(t[18]=[e("i",{class:"fa-solid fa-spinner fa-spin"},null,-1),m(" Loading requests... ")]))):i("",!0)])}}},We=O(Be,[["__scopeId","data-v-ce8ebea3"]]);export{We as default};
