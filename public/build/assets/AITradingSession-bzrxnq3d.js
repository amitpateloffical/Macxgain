import{_ as z,c as p,o as h,b as e,h as b,i as u,t as l,n as k,j as _,v as U,M as q,W as V,F as T,r as w,a as N,w as R,S,X as f}from"./app-BFj7m03g.js";const K={name:"AITradingSession",data(){return{user:{},loading:!1,liveStocks:[],lastUpdate:null,searchQuery:"",sortBy:"symbol",showTradeModal:!1,userOrders:[],exitingTrade:null,currentMarketPrices:{},marketStatus:{is_open:!1,status:"CLOSED",current_time:"",next_open_time:null,market_hours:{open:"09:15",close:"15:30",timezone:"Asia/Kolkata",days:"Monday to Friday"}},tradeData:{stock:{},optionType:"",action:"",strikePrice:0,quantity:1,lots:1,option:null},selectedStock:null,callOptions:[],putOptions:[],loadingOptions:!1,autoRefreshInterval:null}},computed:{filteredStocks(){let s=[...this.liveStocks];return this.searchQuery&&(s=s.filter(t=>(t.symbol||"").toString().toLowerCase().includes(this.searchQuery.toLowerCase()))),s.sort((t,i)=>{switch(this.sortBy){case"price":return(i.ltp||0)-(t.ltp||0);case"change":return(i.change||0)-(t.change||0);case"volume":return(i.volume||0)-(t.volume||0);default:const n=(t.symbol||"").toString(),o=(i.symbol||"").toString();return n.localeCompare(o)}}),s}},mounted(){if(this.user={id:this.$route.query.userId,name:this.$route.query.userName,balance:parseFloat(this.$route.query.userBalance)||0,email:this.$route.query.userEmail},console.log("User data:",this.user),!this.user.id){this.showError("User data not found. Please go back and try again."),this.goBack();return}this.loadMarketData(),this.loadUserOrders(),this.loadUserBalance(),this.loadMarketStatus(),document.addEventListener("keydown",this.handleKeyDown),this.startAutoRefresh(),console.log("About to test balance loading..."),setTimeout(()=>{console.log("Testing balance load after 2 seconds..."),this.loadUserBalance()},2e3)},beforeUnmount(){document.removeEventListener("keydown",this.handleKeyDown),this.autoRefreshInterval&&clearInterval(this.autoRefreshInterval)},methods:{handleKeyDown(s){s.key==="Escape"&&(this.selectedStock&&this.closeStockOptions(),this.showTradeModal&&this.closeTradeModal())},startAutoRefresh(){this.autoRefreshInterval=setInterval(()=>{this.loadMarketStatus(),this.loadMarketData(),console.log("Auto-refresh: Market data and status updated")},3e3)},goBack(){this.$router.push({name:"ai_trading"})},async loadMarketData(){try{this.loading=!0;const s=localStorage.getItem("access_token"),t=await f.get("/api/truedata/dashboard",{headers:{Authorization:`Bearer ${s}`,Accept:"application/json"}});t.data.success&&t.data.data?(console.log("Market data received:",t.data.data),this.liveStocks=t.data.data.live_stocks||[],this.marketStatus=t.data.data.market_status||{is_open:!1,status:"CLOSED"},this.lastUpdate=t.data.data.last_update,console.log("Live stocks loaded:",this.liveStocks.length,"stocks"),console.log("First stock sample:",this.liveStocks[0])):console.log("No market data received:",t.data)}catch(s){console.error("Error loading market data:",s),this.showError("Failed to load market data")}finally{this.loading=!1}},async refreshMarketData(){await this.loadMarketData(),this.autoRefreshInterval||this.showSuccess("Market data refreshed")},searchStocks(){},async selectStock(s){this.selectedStock=s,this.loadingOptions=!0;try{await this.loadOptionsData(s.symbol)}catch(t){console.error("Error loading options:",t),this.showError("Failed to load options data")}finally{this.loadingOptions=!1}},closeStockOptions(){this.selectedStock=null,this.callOptions=[],this.putOptions=[]},async loadOptionsData(s){try{if(console.log(`ðŸ”„ Loading options data for ${s}`),console.log(`ðŸŒ API URL: /api/truedata/options/chain/${encodeURIComponent(s)}`),s==="SENSEX"){this.showError("SENSEX options are not actively traded. Please try NIFTY 50 or NIFTY BANK for options trading."),this.closeStockOptions();return}const t=await f.get(`/api/truedata/options/chain/${encodeURIComponent(s)}`);console.log("ðŸ“¡ Options API response:",t),console.log("ðŸ“Š Response data:",t.data),console.log("âœ… Response status:",t.status),t.data.success&&t.data.data?(console.log("ðŸŽ¯ Processing real API data..."),this.processOptionsData(t.data.data)):(console.log("âš ï¸ API response not successful, using mock data"),this.generateMockOptions(s))}catch(t){console.error("âŒ Error loading options data:",t),console.log("ðŸ”„ Falling back to mock data..."),this.generateMockOptions(s)}},processOptionsData(s){var t;console.log("ðŸ”„ Processing options data:",s),this.callOptions=[],this.putOptions=[],s.Records&&s.Records.length>0?(console.log("ðŸ“Š Processing TrueData API format with",s.Records.length,"records"),this.callOptions=s.Records.filter(i=>i.option_type==="CE"||i.option_type==="CALL").map(i=>({symbol:i.symbol_id||i.symbol,strike_price:i.strike_price||0,ltp:i.ltp||0,bid:i.bid||0,ask:i.ask||0,volume:i.volume||0,open_interest:i.oi||i.open_interest||0,option_type:"CALL",implied_volatility:i.implied_volatility||0})),this.putOptions=s.Records.filter(i=>i.option_type==="PE"||i.option_type==="PUT").map(i=>({symbol:i.symbol_id||i.symbol,strike_price:i.strike_price||0,ltp:i.ltp||0,bid:i.bid||0,ask:i.ask||0,volume:i.volume||0,open_interest:i.oi||i.open_interest||0,option_type:"PUT",implied_volatility:i.implied_volatility||0})),console.log("âœ… Processed",this.callOptions.length,"CALL options and",this.putOptions.length,"PUT options")):(console.log("âš ï¸ No Records array found, using mock data"),this.generateMockOptions((t=this.selectedStock)==null?void 0:t.symbol))},generateMockOptions(s){var n,o;console.log("ðŸŽ­ Generating mock options data for",s);const t=((n=this.selectedStock)==null?void 0:n.last)||((o=this.selectedStock)==null?void 0:o.ltp)||1e3;console.log("ðŸ’° Current price for mock data:",t);const i=this.generateStrikes(t);console.log("ðŸŽ¯ Generated strikes:",i),this.callOptions=i.map(a=>{const d=this.calculateOptionPrice(t,a,"CALL");return{symbol:`${s}${a}CE`,strike_price:a,ltp:d,bid:(d*.99).toFixed(2),ask:(d*1.01).toFixed(2),volume:Math.floor(Math.random()*1e3),open_interest:Math.floor(Math.random()*5e3),option_type:"CALL",implied_volatility:(Math.random()*.5+.2).toFixed(3)}}),this.putOptions=i.map(a=>{const d=this.calculateOptionPrice(t,a,"PUT");return{symbol:`${s}${a}PE`,strike_price:a,ltp:d,bid:(d*.99).toFixed(2),ask:(d*1.01).toFixed(2),volume:Math.floor(Math.random()*1e3),open_interest:Math.floor(Math.random()*5e3),option_type:"PUT",implied_volatility:(Math.random()*.5+.2).toFixed(3)}}),console.log("âœ… Generated",this.callOptions.length,"CALL options and",this.putOptions.length,"PUT options")},generateStrikes(s){const t=[],i=Math.round(s*.02);for(let n=-5;n<=5;n++){const o=Math.round(s+n*i);o>0&&t.push(o)}return t.sort((n,o)=>n-o)},calculateOptionPrice(s,t,i){if(i==="CALL"){const n=Math.max(0,s-t),o=s*(.008+Math.random()*.004);return(n+o).toFixed(2)}else{const n=Math.max(0,t-s),o=s*(.008+Math.random()*.004);return(n+o).toFixed(2)}},openTradeModal(s,t,i,n=null){this.tradeData={stock:s,optionType:t,action:i,strikePrice:n?n.strike_price:t==="CALL"?s.ltp*1.02:s.ltp*.98,quantity:1,lots:1,option:n},this.showTradeModal=!0},closeTradeModal(){this.showTradeModal=!1,this.tradeData={stock:{},optionType:"",action:"",strikePrice:0,quantity:1,lots:1,option:null}},increaseQuantity(){this.tradeData.quantity<1e3&&this.tradeData.quantity++},decreaseQuantity(){this.tradeData.quantity>1&&this.tradeData.quantity--},getLotSize(s){return{"NIFTY 50":75,"NIFTY BANK":25,"NIFTY IT":25,SENSEX:10,FINNIFTY:40,"NIFTY MIDCAP":50,BANKEX:15,AXISBANK:1200,RELIANCE:250,TCS:125,HDFC:200,INFY:200,"HDFC BANK":500,"ICICI BANK":1e3,SBIN:1500,BHARTIARTL:400,ITC:800,KOTAKBANK:200,LT:200,MARUTI:50}[s]||100},increaseLots(){this.tradeData.lots<100&&(this.tradeData.lots++,this.updateQuantityFromLots())},decreaseLots(){this.tradeData.lots>1&&(this.tradeData.lots--,this.updateQuantityFromLots())},updateQuantityFromLots(){this.tradeData.quantity=this.tradeData.lots},getOptionPrice(){if(this.tradeData.option)return this.tradeData.option.ltp||0;const s=this.tradeData.stock.ltp||1e3,t=this.tradeData.strikePrice;return this.tradeData.optionType==="CALL"?Math.max(0,s-t)+s*.01:Math.max(0,t-s)+s*.01},getTotalShares(){const s=this.getLotSize(this.tradeData.stock.symbol);return this.tradeData.lots*s},getTotalAmount(){const s=this.getOptionPrice(),t=this.getTotalShares();return s*t},async executeTrade(){var s,t,i;try{console.log("Executing trade...",this.tradeData);const n=localStorage.getItem("access_token");if(!n){this.showError("Please login to execute trades");return}const o={user_id:this.user.id,stock_symbol:this.tradeData.stock.symbol,option_type:this.tradeData.optionType,action:this.tradeData.action,strike_price:this.tradeData.strikePrice,quantity:this.tradeData.lots,total_amount:this.getTotalAmount(),lot_size:this.getLotSize(this.tradeData.stock.symbol),total_shares:this.getTotalShares(),option_price:this.getOptionPrice()};console.log("Trade payload:",o);const a=await f.post("/api/ai-trading/execute-trade",o,{headers:{Authorization:`Bearer ${n}`,Accept:"application/json","Content-Type":"application/json"}});console.log("Trade response:",a.data),a.data.success?(this.showSuccess(`Trade executed successfully! Order #${a.data.order_id}`),this.closeTradeModal(),this.loadUserOrders(),this.loadUserBalance()):this.showError(a.data.message||"Failed to execute trade")}catch(n){console.error("Error executing trade:",n),console.error("Error details:",(s=n.response)==null?void 0:s.data),this.showError(`Trade execution failed: ${((i=(t=n.response)==null?void 0:t.data)==null?void 0:i.message)||n.message}`)}},async executeTradeWithProfit(){var s,t,i;try{console.log("Executing trade with profit...",this.tradeData);const n=localStorage.getItem("access_token");if(!n){this.showError("Please login to execute trades");return}const o=this.tradeData.stock.ltp||this.tradeData.stock.last||1e3,a=this.getOptionPrice(),c=a*.15,g=a+c,y={user_id:this.user.id,stock_symbol:this.tradeData.stock.symbol,option_type:this.tradeData.optionType,action:this.tradeData.action,strike_price:this.tradeData.strikePrice,quantity:this.tradeData.lots,total_amount:this.getTotalAmount(),lot_size:this.getLotSize(this.tradeData.stock.symbol),total_shares:this.getTotalShares(),option_price:this.getOptionPrice(),trade_type:"PROFIT",exit_price:g,profit_amount:c,current_market_price:o};console.log("Profit trade payload:",y);const m=await f.post("/api/ai-trading/execute-trade",y,{headers:{Authorization:`Bearer ${n}`,Accept:"application/json","Content-Type":"application/json"}});console.log("Trade response:",m.data),m.data.success?(this.showSuccess(`Trade executed with profit! Order #${m.data.order_id} - Profit: â‚¹${c.toFixed(2)}`),this.closeTradeModal(),this.loadUserOrders(),this.loadUserBalance()):this.showError(m.data.message||"Failed to execute trade")}catch(n){console.error("Error executing trade with profit:",n),console.error("Error details:",(s=n.response)==null?void 0:s.data),this.showError(`Trade execution failed: ${((i=(t=n.response)==null?void 0:t.data)==null?void 0:i.message)||n.message}`)}},async executeTradeWithLoss(){var s,t,i;try{console.log("Executing trade with loss...",this.tradeData);const n=localStorage.getItem("access_token");if(!n){this.showError("Please login to execute trades");return}const o=this.tradeData.stock.ltp||this.tradeData.stock.last||1e3,a=this.getOptionPrice(),c=a*.1,g=a-c,y={user_id:this.user.id,stock_symbol:this.tradeData.stock.symbol,option_type:this.tradeData.optionType,action:this.tradeData.action,strike_price:this.tradeData.strikePrice,quantity:this.tradeData.lots,total_amount:this.getTotalAmount(),lot_size:this.getLotSize(this.tradeData.stock.symbol),total_shares:this.getTotalShares(),option_price:this.getOptionPrice(),trade_type:"LOSS",exit_price:g,loss_amount:c,current_market_price:o};console.log("Loss trade payload:",y);const m=await f.post("/api/ai-trading/execute-trade",y,{headers:{Authorization:`Bearer ${n}`,Accept:"application/json","Content-Type":"application/json"}});console.log("Trade response:",m.data),m.data.success?(this.showSuccess(`Trade executed with loss! Order #${m.data.order_id} - Loss: â‚¹${c.toFixed(2)}`),this.closeTradeModal(),this.loadUserOrders(),this.loadUserBalance()):this.showError(m.data.message||"Failed to execute trade")}catch(n){console.error("Error executing trade with loss:",n),console.error("Error details:",(s=n.response)==null?void 0:s.data),this.showError(`Trade execution failed: ${((i=(t=n.response)==null?void 0:t.data)==null?void 0:i.message)||n.message}`)}},async loadUserOrders(){try{const s=localStorage.getItem("access_token"),t=await f.get(`/api/ai-trading/user-orders/${this.user.id}`,{headers:{Authorization:`Bearer ${s}`,Accept:"application/json"}});t.data.success&&(this.userOrders=t.data.orders||[])}catch(s){console.error("Error loading user orders:",s)}},async loadUserBalance(s=!1){var t,i,n;try{console.log("Loading user balance for user ID:",this.user.id);const o=localStorage.getItem("access_token");if(console.log("Token exists:",!!o),!o){console.error("No access token found"),this.showError("No access token found. Please login again.");return}const a=await f.get(`/api/ai-trading/user-balance/${this.user.id}`,{headers:{Authorization:`Bearer ${o}`,Accept:"application/json"}});if(console.log("Balance API response:",a.data),a.data.success){const d=parseFloat(a.data.balance)||0,c=parseFloat(a.data.total_balance)||0,g=parseFloat(a.data.blocked_amount)||0;console.log("Live user balance updated:",{available:d,total:c,blocked:g}),this.user={...this.user,balance:d,total_balance:c,blocked_amount:g},console.log("User object after update:",this.user),s&&this.showSuccess(`Balance updated: ${a.data.formatted_balance} (Available) | Total: ${a.data.formatted_total_balance} | Blocked: ${a.data.formatted_blocked_amount}`)}else console.error("API returned success: false",a.data)}catch(o){console.error("Error loading user balance:",o),console.error("Error details:",(t=o.response)==null?void 0:t.data),this.showError("Failed to load user balance: "+(((n=(i=o.response)==null?void 0:i.data)==null?void 0:n.message)||o.message))}},async loadMarketStatus(){try{const s=localStorage.getItem("access_token"),t=await f.get("/api/ai-trading/market-status",{headers:{Authorization:`Bearer ${s}`,Accept:"application/json"}});t.data.success&&(this.marketStatus=t.data.data,console.log("Market status updated:",this.marketStatus))}catch(s){console.error("Error loading market status:",s),this.marketStatus={is_open:!1,status:"CLOSED",current_time:new Date().toLocaleTimeString("en-IN"),next_open_time:null,market_hours:{open:"09:15",close:"15:30",timezone:"Asia/Kolkata",days:"Monday to Friday"}},console.log("Using default market status due to API error")}},viewOrders(){console.log("View Orders clicked - navigating to orders page"),window.location.href=`/admin/ai-trading-orders?userId=${this.user.id}&userName=${encodeURIComponent(this.user.name)}&userBalance=${this.user.balance}&userEmail=${encodeURIComponent(this.user.email)}`},formatDateTime(s){return new Date(s).toLocaleString("en-IN")},showSuccess(s){typeof S<"u"?S.fire({title:"Success!",text:s,icon:"success",timer:3e3,showConfirmButton:!1,toast:!0,position:"top-end"}):(console.log("Success:",s),alert("Success: "+s))},getStatusIcon(s){switch(s){case"COMPLETED":return"fa-check-circle";case"PENDING":return"fa-clock";case"CANCELLED":return"fa-times-circle";case"CLOSED":return"fa-lock";default:return"fa-question-circle"}},getOptionIcon(s){switch(s){case"CALL":return"fa-arrow-up";case"PUT":return"fa-arrow-down";default:return"fa-question"}},getActionIcon(s){switch(s){case"BUY":return"fa-shopping-cart";case"SELL":return"fa-money-bill-wave";default:return"fa-exchange-alt"}},getCurrentPrice(s){const t=this.liveStocks.find(i=>i.symbol===s);return t?t.ltp.toFixed(2):"N/A"},calculateUnrealizedPnL(s){const t=parseFloat(this.getCurrentPrice(s.stock_symbol));if(isNaN(t))return 0;const i=parseFloat(s.strike_price),n=parseInt(s.quantity),o=s.option_type,a=s.action;let d=0;if(o==="CALL")if(a==="BUY")d=(Math.max(0,t-i)-i)*n;else{const c=Math.max(0,t-i);d=(i-c)*n}else if(a==="BUY")d=(Math.max(0,i-t)-i)*n;else{const c=Math.max(0,i-t);d=(i-c)*n}return Math.round(d*100)/100},getPnLClass(s){return s>0?"profit":s<0?"loss":"neutral"},getPnLText(s){return s>0?`+â‚¹${s.toLocaleString()}`:s<0?`-â‚¹${Math.abs(s).toLocaleString()}`:"â‚¹0"},async exitTrade(s){if(confirm("Are you sure you want to exit this trade? This action cannot be undone.")){this.exitingTrade=s;try{const t=localStorage.getItem("access_token"),i=await f.post(`/api/ai-trading/orders/${s}/exit`,{},{headers:{Authorization:`Bearer ${t}`,Accept:"application/json","Content-Type":"application/json"}});if(i.data.success){const n=i.data.data;this.showSuccess(`Trade exited successfully! ${n.pnl_type==="profit"?"Profit":"Loss"}: â‚¹${Math.abs(n.pnl).toLocaleString()}`),this.loadUserOrders(),this.loadUserBalance()}else this.showError(i.data.message||"Failed to exit trade")}catch(t){console.error("Error exiting trade:",t),this.showError("Failed to exit trade")}finally{this.exitingTrade=null}}},showError(s){typeof S<"u"?S.fire({title:"Error!",text:s,icon:"error",timer:4e3,showConfirmButton:!1,toast:!0,position:"top-end"}):(console.error("Error:",s),alert("Error: "+s))},formatDateTime(s){return s?new Date(s).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):""}}},Y={class:"ai-trading-session"},j={class:"page-header"},Q={class:"header-content"},W={class:"user-info"},X={class:"page-subtitle"},G={class:"header-actions"},H=["disabled"],Z=["disabled"],J={class:"market-status"},$={class:"market-status-top"},tt={class:"market-time"},et={class:"last-update"},st={key:0,class:"next-open"},ot={key:1,class:"trading-enabled-notice"},at={class:"trading-enabled-notice"},it={class:"notice-content"},rt={class:"notice-text"},lt={class:"notice-sub"},nt={class:"market-data-section"},dt={class:"section-title"},ct={class:"stock-count"},ut={class:"filters-section"},pt={class:"search-input-wrapper"},ht={class:"stocks-grid"},mt=["onClick"],gt={class:"stock-header"},kt={class:"stock-info"},ft={class:"stock-symbol"},yt={class:"stock-price"},vt={class:"stock-details"},bt={class:"detail-row"},St={class:"detail-row"},_t={class:"detail-row"},Tt={key:0,class:"empty-state"},wt={class:"empty-message"},Lt={class:"modal-header"},Dt={class:"modal-title"},Pt={class:"modal-body"},At={class:"stock-info-section"},xt={class:"stock-price-large"},Ct={class:"options-trading-section"},Mt={key:0,class:"loading-options"},Ot={key:1,class:"options-chain"},Et={class:"options-section"},It={class:"options-table"},Bt={class:"option-cell strike"},Ft={class:"option-cell bid"},Ut={class:"option-cell ask"},Nt={class:"option-cell volume"},Rt={class:"option-cell oi"},zt={class:"option-cell actions"},qt=["onClick"],Vt=["onClick"],Kt={class:"options-section"},Yt={class:"options-table"},jt={class:"option-cell strike"},Qt={class:"option-cell bid"},Wt={class:"option-cell ask"},Xt={class:"option-cell volume"},Gt={class:"option-cell oi"},Ht={class:"option-cell actions"},Zt=["onClick"],Jt=["onClick"],$t={class:"modal-header"},te={class:"modal-title"},ee={class:"modal-body"},se={class:"trade-info"},oe={class:"info-row"},ae={class:"info-row"},ie={class:"info-row"},re={class:"info-row"},le={class:"info-row"},ne={class:"quantity-section"},de={class:"lot-info"},ce={class:"lot-details"},ue={class:"lot-value"},pe={class:"lot-details"},he={class:"lot-input-wrapper"},me={class:"lot-details"},ge={class:"quantity-display"},ke={class:"trade-summary"},fe={class:"summary-row"},ye={class:"summary-row"},ve={class:"summary-row"},be={class:"summary-row"},Se={class:"total-amount"},_e={class:"summary-row"},Te={class:"modal-footer"},we={class:"trade-options"},Le=["disabled"],De=["disabled"];function Pe(s,t,i,n,o,a){var d,c,g,y,m,L,D,P,A,x,C,M;return h(),p("div",Y,[e("div",j,[e("div",Q,[e("button",{class:"back-btn",onClick:t[0]||(t[0]=(...r)=>a.goBack&&a.goBack(...r))},t[22]||(t[22]=[e("i",{class:"fas fa-arrow-left"},null,-1),u(" Back to AI Trading ")])),e("div",W,[t[24]||(t[24]=e("h1",{class:"page-title"},"ðŸ¤– AI Trading Session",-1)),e("p",X,[t[23]||(t[23]=u(" Trading for: ")),e("strong",null,l(o.user.name||"Loading..."),1),u(" (Available: â‚¹"+l(((d=o.user.balance)==null?void 0:d.toLocaleString())||"0")+" | Total: â‚¹"+l(((c=o.user.total_balance)==null?void 0:c.toLocaleString())||"0")+" | Blocked: â‚¹"+l(((g=o.user.blocked_amount)==null?void 0:g.toLocaleString())||"0")+") ",1)])])]),e("div",G,[e("button",{class:"refresh-btn",onClick:t[1]||(t[1]=(...r)=>a.refreshMarketData&&a.refreshMarketData(...r)),disabled:o.loading},[e("i",{class:k(["fas fa-sync-alt",{"fa-spin":o.loading}])},null,2),u(" "+l(o.loading?"Loading...":"Refresh Data"),1)],8,H),e("button",{class:"orders-btn",onClick:t[2]||(t[2]=(...r)=>a.viewOrders&&a.viewOrders(...r))},t[25]||(t[25]=[e("i",{class:"fas fa-list"},null,-1),u(" View Orders ")])),e("button",{class:"refresh-btn",onClick:t[3]||(t[3]=r=>a.loadUserBalance(!0)),disabled:o.loading},t[26]||(t[26]=[e("i",{class:"fas fa-wallet"},null,-1),u(" Refresh Balance ")]),8,Z)])]),e("div",J,[e("div",$,[e("div",{class:k(["status-indicator",o.marketStatus.is_open?"open":"closed"])},[t[27]||(t[27]=e("div",{class:"status-dot"},null,-1)),e("span",null,l(o.marketStatus.is_open?"Market LIVE":"Market CLOSED"),1),e("span",tt,l(o.marketStatus.current_time)+" IST",1)],2),e("div",et," Last Update: "+l(o.lastUpdate||"Never"),1)]),!o.marketStatus.is_open&&o.marketStatus.next_open_time?(h(),p("div",st," Next Open: "+l(a.formatDateTime(o.marketStatus.next_open_time)),1)):b("",!0),o.marketStatus.is_open?b("",!0):(h(),p("div",ot,t[28]||(t[28]=[e("i",{class:"fas fa-check-circle"},null,-1),e("span",null,"Trading is enabled 24/7 for testing purposes",-1)])))]),e("div",at,[e("div",it,[t[33]||(t[33]=e("i",{class:"fas fa-rocket"},null,-1)),e("div",rt,[t[31]||(t[31]=e("h3",null,"ðŸš€ Trading Enabled 24/7",-1)),t[32]||(t[32]=e("p",{class:"notice-info"},[e("strong",null,"Trading is enabled 24/7 for testing purposes! You can trade anytime!")],-1)),e("p",lt,[t[29]||(t[29]=u("Normal market hours: ")),e("strong",null,l(((y=o.marketStatus.market_hours)==null?void 0:y.days)||"Monday to Friday")+", "+l(((m=o.marketStatus.market_hours)==null?void 0:m.open)||"9:15 AM")+" - "+l(((L=o.marketStatus.market_hours)==null?void 0:L.close)||"3:30 PM")+" "+l(((D=o.marketStatus.market_hours)==null?void 0:D.timezone)||"IST"),1),t[30]||(t[30]=u(" (for reference only)"))])])])]),e("div",nt,[e("h2",dt,[t[34]||(t[34]=e("i",{class:"fas fa-chart-line"},null,-1)),t[35]||(t[35]=u(" Live Market Data ")),e("span",ct,"("+l(o.liveStocks.length)+" stocks)",1)]),e("div",ut,[e("div",pt,[t[37]||(t[37]=e("i",{class:"fas fa-search search-icon"},null,-1)),_(e("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>o.searchQuery=r),type:"text",class:"filter-input",placeholder:"Search stocks...",onKeyup:t[5]||(t[5]=q((...r)=>a.searchStocks&&a.searchStocks(...r),["enter"]))},null,544),[[U,o.searchQuery]]),e("button",{class:"search-btn",onClick:t[6]||(t[6]=(...r)=>a.searchStocks&&a.searchStocks(...r))},t[36]||(t[36]=[e("i",{class:"fas fa-search"},null,-1)]))]),_(e("select",{"onUpdate:modelValue":t[7]||(t[7]=r=>o.sortBy=r),class:"filter-select"},t[38]||(t[38]=[e("option",{value:"symbol"},"Sort by Symbol",-1),e("option",{value:"price"},"Sort by Price",-1),e("option",{value:"change"},"Sort by Change",-1),e("option",{value:"volume"},"Sort by Volume",-1)]),512),[[V,o.sortBy]])]),e("div",ht,[(h(!0),p(T,null,w(a.filteredStocks,r=>{var v,O,E,I,B,F;return h(),p("div",{key:r.symbol,class:"stock-card",onClick:Ae=>a.selectStock(r)},[e("div",gt,[e("div",kt,[e("h3",ft,l(r.symbol),1),e("div",yt,"â‚¹"+l(((v=r.ltp)==null?void 0:v.toFixed(2))||"0.00"),1)]),e("div",{class:k(["stock-change",r.change>=0?"positive":"negative"])},[e("i",{class:k(r.change>=0?"fas fa-arrow-up":"fas fa-arrow-down")},null,2),u(" "+l(r.change>=0?"+":"")+l(((O=r.change)==null?void 0:O.toFixed(2))||"0.00")+" ("+l(r.change_percent>=0?"+":"")+l(((E=r.change_percent)==null?void 0:E.toFixed(2))||"0.00")+"%) ",1)],2)]),e("div",vt,[e("div",bt,[t[39]||(t[39]=e("span",null,"High:",-1)),e("span",null,"â‚¹"+l(((I=r.high)==null?void 0:I.toFixed(2))||"0.00"),1)]),e("div",St,[t[40]||(t[40]=e("span",null,"Low:",-1)),e("span",null,"â‚¹"+l(((B=r.low)==null?void 0:B.toFixed(2))||"0.00"),1)]),e("div",_t,[t[41]||(t[41]=e("span",null,"Volume:",-1)),e("span",null,l(((F=r.volume)==null?void 0:F.toLocaleString())||"0"),1)])]),t[42]||(t[42]=e("div",{class:"click-hint"},[e("i",{class:"fas fa-mouse-pointer"}),e("span",null,"Click to view Options Trading")],-1))],8,mt)}),128))]),a.filteredStocks.length===0?(h(),p("div",Tt,[t[44]||(t[44]=e("div",{class:"empty-icon"},"ðŸ“Š",-1)),t[45]||(t[45]=e("h3",{class:"empty-title"},"No Market Data Available",-1)),e("p",wt,l(o.marketStatus==="CLOSED"?"Market is currently closed. Real-time data will be available during trading hours: 9:00 AM - 3:30 PM IST (Monday to Friday)":"Unable to fetch market data. Please try refreshing."),1),e("button",{class:"retry-btn",onClick:t[8]||(t[8]=(...r)=>a.refreshMarketData&&a.refreshMarketData(...r))},t[43]||(t[43]=[e("i",{class:"fas fa-sync-alt"},null,-1),u(" Try Again ")]))])):b("",!0)]),o.selectedStock?(h(),p("div",{key:0,class:"modal-overlay",onClick:t[11]||(t[11]=(...r)=>a.closeStockOptions&&a.closeStockOptions(...r))},[e("div",{class:"stock-options-modal",onClick:t[10]||(t[10]=R(()=>{},["stop"]))},[e("div",Lt,[e("h2",Dt,[t[46]||(t[46]=e("i",{class:"fas fa-chart-line"},null,-1)),u(" Options Trading - "+l(o.selectedStock.symbol),1)]),e("button",{class:"close-btn",onClick:t[9]||(t[9]=(...r)=>a.closeStockOptions&&a.closeStockOptions(...r))},t[47]||(t[47]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",Pt,[e("div",At,[e("div",xt,"â‚¹"+l(((P=o.selectedStock.ltp)==null?void 0:P.toFixed(2))||"0.00"),1),e("div",{class:k(["stock-change-large",o.selectedStock.change>=0?"positive":"negative"])},[e("i",{class:k(o.selectedStock.change>=0?"fas fa-arrow-up":"fas fa-arrow-down")},null,2),u(" "+l(o.selectedStock.change>=0?"+":"")+l(((A=o.selectedStock.change)==null?void 0:A.toFixed(2))||"0.00")+" ("+l(o.selectedStock.change_percent>=0?"+":"")+l(((x=o.selectedStock.change_percent)==null?void 0:x.toFixed(2))||"0.00")+"%) ",1)],2)]),e("div",Ct,[t[57]||(t[57]=e("h3",{class:"options-main-title"},"Options Trading",-1)),o.loadingOptions?(h(),p("div",Mt,t[48]||(t[48]=[e("div",{class:"loading-spinner"},[e("i",{class:"fas fa-spinner fa-spin"})],-1),e("p",null,"Loading options data...",-1)]))):(h(),p("div",Ot,[e("div",Et,[t[52]||(t[52]=e("h4",{class:"options-section-title call-title"},[e("i",{class:"fas fa-arrow-up"}),u(" CALL Options ")],-1)),e("div",It,[t[51]||(t[51]=N('<div class="options-header" data-v-0f4589bd><div class="header-cell" data-v-0f4589bd>Strike</div><div class="header-cell" data-v-0f4589bd>Bid</div><div class="header-cell" data-v-0f4589bd>Ask</div><div class="header-cell" data-v-0f4589bd>Volume</div><div class="header-cell" data-v-0f4589bd>OI</div><div class="header-cell" data-v-0f4589bd>Action</div></div>',1)),(h(!0),p(T,null,w(o.callOptions.slice(0,5),r=>(h(),p("div",{key:`call-${r.strike_price}`,class:"option-row call-row"},[e("div",Bt,l(r.strike_price),1),e("div",Ft,l(r.bid),1),e("div",Ut,l(r.ask),1),e("div",Nt,l(r.volume),1),e("div",Rt,l(r.open_interest),1),e("div",zt,[e("button",{class:"mini-btn buy-btn",onClick:v=>a.openTradeModal(o.selectedStock,"CALL","BUY",r),title:"Buy Call - Trading enabled 24/7"},t[49]||(t[49]=[e("i",{class:"fas fa-arrow-up"},null,-1),e("span",null,"BUY",-1)]),8,qt),e("button",{class:"mini-btn sell-btn",onClick:v=>a.openTradeModal(o.selectedStock,"CALL","SELL",r),title:"Sell Call - Trading enabled 24/7"},t[50]||(t[50]=[e("i",{class:"fas fa-arrow-down"},null,-1),e("span",null,"SELL",-1)]),8,Vt)])]))),128))])]),e("div",Kt,[t[56]||(t[56]=e("h4",{class:"options-section-title put-title"},[e("i",{class:"fas fa-arrow-down"}),u(" PUT Options ")],-1)),e("div",Yt,[t[55]||(t[55]=N('<div class="options-header" data-v-0f4589bd><div class="header-cell" data-v-0f4589bd>Strike</div><div class="header-cell" data-v-0f4589bd>Bid</div><div class="header-cell" data-v-0f4589bd>Ask</div><div class="header-cell" data-v-0f4589bd>Volume</div><div class="header-cell" data-v-0f4589bd>OI</div><div class="header-cell" data-v-0f4589bd>Action</div></div>',1)),(h(!0),p(T,null,w(o.putOptions.slice(0,5),r=>(h(),p("div",{key:`put-${r.strike_price}`,class:"option-row put-row"},[e("div",jt,l(r.strike_price),1),e("div",Qt,l(r.bid),1),e("div",Wt,l(r.ask),1),e("div",Xt,l(r.volume),1),e("div",Gt,l(r.open_interest),1),e("div",Ht,[e("button",{class:"mini-btn buy-btn",onClick:v=>a.openTradeModal(o.selectedStock,"PUT","BUY",r),title:"Buy Put - Trading enabled 24/7"},t[53]||(t[53]=[e("i",{class:"fas fa-arrow-up"},null,-1),e("span",null,"BUY",-1)]),8,Zt),e("button",{class:"mini-btn sell-btn",onClick:v=>a.openTradeModal(o.selectedStock,"PUT","SELL",r),title:"Sell Put - Trading enabled 24/7"},t[54]||(t[54]=[e("i",{class:"fas fa-arrow-down"},null,-1),e("span",null,"SELL",-1)]),8,Jt)])]))),128))])])]))])])])])):b("",!0),o.showTradeModal?(h(),p("div",{key:1,class:"modal-overlay",onClick:t[21]||(t[21]=(...r)=>a.closeTradeModal&&a.closeTradeModal(...r))},[e("div",{class:"modal-content",onClick:t[20]||(t[20]=R(()=>{},["stop"]))},[e("div",$t,[e("h3",te,[t[58]||(t[58]=e("i",{class:"fas fa-chart-line"},null,-1)),u(" "+l(o.tradeData.action)+" "+l(o.tradeData.optionType)+" - "+l(o.tradeData.stock.symbol),1)]),e("button",{class:"close-btn",onClick:t[12]||(t[12]=(...r)=>a.closeTradeModal&&a.closeTradeModal(...r))},t[59]||(t[59]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",ee,[e("div",se,[e("div",oe,[t[60]||(t[60]=e("span",null,"Stock:",-1)),e("span",null,l(o.tradeData.stock.symbol),1)]),e("div",ae,[t[61]||(t[61]=e("span",null,"Current Price:",-1)),e("span",null,"â‚¹"+l((C=o.tradeData.stock.ltp)==null?void 0:C.toFixed(2)),1)]),e("div",ie,[t[62]||(t[62]=e("span",null,"Option Type:",-1)),e("span",{class:k(["option-type-badge",o.tradeData.optionType.toLowerCase()])},l(o.tradeData.optionType),3)]),e("div",re,[t[63]||(t[63]=e("span",null,"Action:",-1)),e("span",{class:k(["action-badge",o.tradeData.action.toLowerCase()])},l(o.tradeData.action),3)]),e("div",le,[t[64]||(t[64]=e("span",null,"Strike Price:",-1)),e("span",null,"â‚¹"+l(o.tradeData.strikePrice),1)])]),e("div",ne,[t[68]||(t[68]=e("label",{class:"quantity-label"},"Lot Size & Quantity:",-1)),e("div",de,[e("div",ce,[t[65]||(t[65]=e("span",{class:"lot-label"},"Lot Size:",-1)),e("span",ue,l(a.getLotSize(o.tradeData.stock.symbol))+" shares",1)]),e("div",pe,[t[66]||(t[66]=e("span",{class:"lot-label"},"Lots:",-1)),e("div",he,[e("button",{class:"qty-btn",onClick:t[13]||(t[13]=(...r)=>a.decreaseLots&&a.decreaseLots(...r))},"-"),_(e("input",{"onUpdate:modelValue":t[14]||(t[14]=r=>o.tradeData.lots=r),type:"number",class:"lot-input",min:"1",max:"100",onInput:t[15]||(t[15]=(...r)=>a.updateQuantityFromLots&&a.updateQuantityFromLots(...r))},null,544),[[U,o.tradeData.lots,void 0,{number:!0}]]),e("button",{class:"qty-btn",onClick:t[16]||(t[16]=(...r)=>a.increaseLots&&a.increaseLots(...r))},"+")])]),e("div",me,[t[67]||(t[67]=e("span",{class:"lot-label"},"Total Shares:",-1)),e("span",ge,l(a.getTotalShares())+" shares",1)])])]),e("div",ke,[e("div",fe,[t[69]||(t[69]=e("span",null,"Option Price (LTP):",-1)),e("span",null,"â‚¹"+l(a.getOptionPrice()),1)]),e("div",ye,[t[70]||(t[70]=e("span",null,"Lots:",-1)),e("span",null,l(o.tradeData.lots)+" lots",1)]),e("div",ve,[t[71]||(t[71]=e("span",null,"Total Shares:",-1)),e("span",null,l(a.getTotalShares())+" shares",1)]),e("div",be,[t[72]||(t[72]=e("span",null,"Total Amount:",-1)),e("span",Se,"â‚¹"+l(a.getTotalAmount().toLocaleString()),1)]),e("div",_e,[t[73]||(t[73]=e("span",null,"Available Balance:",-1)),e("span",null,"â‚¹"+l((M=o.user.balance)==null?void 0:M.toLocaleString()),1)]),e("div",{class:k(["summary-row",a.getTotalAmount()>o.user.balance?"insufficient":"sufficient"])},[t[74]||(t[74]=e("span",null,"Status:",-1)),e("span",null,l(a.getTotalAmount()>o.user.balance?"Insufficient Balance":"Sufficient Balance"),1)],2)])]),e("div",Te,[e("button",{class:"btn btn-secondary",onClick:t[17]||(t[17]=(...r)=>a.closeTradeModal&&a.closeTradeModal(...r))}," Cancel "),e("div",we,[e("button",{class:"btn btn-profit",onClick:t[18]||(t[18]=(...r)=>a.executeTradeWithProfit&&a.executeTradeWithProfit(...r)),disabled:a.getTotalAmount()>o.user.balance||o.tradeData.lots<1},t[75]||(t[75]=[e("i",{class:"fas fa-arrow-up"},null,-1),u(" Trade with Profit ")]),8,Le),e("button",{class:"btn btn-loss",onClick:t[19]||(t[19]=(...r)=>a.executeTradeWithLoss&&a.executeTradeWithLoss(...r)),disabled:a.getTotalAmount()>o.user.balance||o.tradeData.lots<1},t[76]||(t[76]=[e("i",{class:"fas fa-arrow-down"},null,-1),u(" Trade with Loss ")]),8,De)])])])])):b("",!0)])}const Ce=z(K,[["render",Pe],["__scopeId","data-v-0f4589bd"]]);export{Ce as default};
