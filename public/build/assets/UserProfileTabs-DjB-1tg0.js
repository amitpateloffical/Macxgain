import{_ as V,s as x,S as y,g as u,Q as U,o as d,q as l,l as o,b as s,c as m,h as c,i as f,t as g,n as k,w as B,F as S,f as N,u as F}from"./app-BFj7m03g.js";const R={props:{userId:{type:String,required:!0}},data(){return{options:{name:"",email:"",phone:"",role:"",profile_image:"",bank_name:"",account_no:"",ifsc_code:"",aadhar_number:"",pan_number:"",address:"",aadhar_front_image:"",aadhar_back_image:"",pan_card_image:""},selectedFile:null,imagePreview:null,errors:{},userBalance:0,balanceLoading:!1,isEditMode:!1,kycImages:{},kycImagePreviews:{}}},created(){this.getUserProfile(),this.fetchUserBalance(),this.checkCameraAvailability()},methods:{RemoveError(a){this.errors[a]&&delete this.errors[a]},hasErrors(a){return this.errors&&this.errors[a]},getErrors(a){return this.errors[a]?this.errors[a][0]:""},getUserProfile(){x.get("/userprofile").then(a=>{this.options=a.data.data})},async fetchUserBalance(){this.balanceLoading=!0;try{const a=JSON.parse(localStorage.getItem("userData"));if(a&&a.id){const e=await x.post("/total_b",{id:a.id});e.data&&e.data.total_balance!==void 0&&(this.userBalance=e.data.total_balance,a.total_balance=e.data.total_balance,localStorage.setItem("userData",JSON.stringify(a)))}}catch(a){console.error("Error fetching balance:",a);const e=JSON.parse(localStorage.getItem("userData"));e&&e.total_balance!==void 0&&(this.userBalance=e.total_balance)}finally{this.balanceLoading=!1}},formatBalance(a){return a==null?"0.00":parseFloat(a).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})},toggleEditMode(){this.isEditMode=!this.isEditMode,this.isEditMode||(this.getUserProfile(),this.errors={})},onFileChange(a){const e=a.target.files[0];if(e){if(e.size>2*1024*1024){y.fire({icon:"error",title:"File too large",text:"Please select a file smaller than 2MB"}),a.target.value="";return}if(!["image/jpeg","image/jpg","image/png","image/gif"].includes(e.type)){y.fire({icon:"error",title:"Invalid file type",text:"Please select JPG, PNG, GIF, or JPEG files only"}),a.target.value="";return}this.selectedFile=e,this.imagePreview=URL.createObjectURL(e),console.log("Profile image selected:",e)}},triggerFileUpload(){this.$refs.fileInput.click()},async openCamera(){try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){y.fire({title:"Camera Not Supported",text:"Your device or browser does not support camera access.",icon:"error",confirmButtonText:"OK"});return}const a=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:{ideal:1280},height:{ideal:720}}});this.showCameraModal(a)}catch(a){console.log("Camera error:",a),a.name==="NotAllowedError"?y.fire({title:"Camera Permission Denied",text:"Please allow camera access to take photos. You can enable it in your browser settings.",icon:"warning",confirmButtonText:"OK"}):a.name==="NotFoundError"?y.fire({title:"Camera Not Found",text:"No camera detected on your device.",icon:"error",confirmButtonText:"OK"}):y.fire({title:"Camera Error",text:"Unable to access camera. Please try again.",icon:"error",confirmButtonText:"OK"})}},showCameraModal(a){document.body.insertAdjacentHTML("beforeend",`
        <div class="camera-modal">
          <div class="camera-container">
            <video id="camera-video" autoplay playsinline></video>
            <div class="camera-controls">
              <button id="capture-btn" class="capture-btn">
                <i class="bi bi-camera"></i> Capture Photo
              </button>
              <button id="switch-camera-btn" class="switch-camera-btn">
                <i class="bi bi-arrow-repeat"></i> Switch Camera
              </button>
              <button id="close-camera-btn" class="close-camera-btn">
                <i class="bi bi-x-circle"></i> Close
              </button>
            </div>
          </div>
        </div>
      `);const i=document.getElementById("camera-video");i.srcObject=a,document.getElementById("capture-btn").addEventListener("click",()=>{this.capturePhoto(i,a)}),document.getElementById("switch-camera-btn").addEventListener("click",()=>{this.switchCamera(a)}),document.getElementById("close-camera-btn").addEventListener("click",()=>{this.closeCamera(a)}),this.addCameraStyles()},async capturePhoto(a,e){const i=document.createElement("canvas"),w=i.getContext("2d");i.width=a.videoWidth,i.height=a.videoHeight,w.drawImage(a,0,0,i.width,i.height),i.toBlob(r=>{if(r){const t=new File([r],"profile-photo.jpg",{type:"image/jpeg"});this.selectedFile=t,this.imagePreview=URL.createObjectURL(r),this.closeCamera(e),y.fire({title:"Photo Captured!",text:"Your photo has been captured successfully.",icon:"success",timer:2e3,showConfirmButton:!1})}},"image/jpeg",.8)},async switchCamera(a){try{a.getTracks().forEach(w=>w.stop());const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:a.getVideoTracks()[0].getSettings().facingMode==="user"?"environment":"user"}}),i=document.getElementById("camera-video");i.srcObject=e,a=e}catch(e){console.log("Error switching camera:",e)}},closeCamera(a){a&&a.getTracks().forEach(i=>i.stop());const e=document.querySelector(".camera-modal");e&&e.remove(),this.removeCameraStyles()},addCameraStyles(){const a=document.createElement("style");a.id="camera-modal-styles",a.textContent=`
        .camera-modal {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.9);
          z-index: 9999;
          display: flex;
          align-items: center;
          justify-content: center;
        }
        
        .camera-container {
          background: #1a1a2e;
          border-radius: 20px;
          padding: 20px;
          text-align: center;
          max-width: 90vw;
          max-height: 90vh;
        }
        
        #camera-video {
          width: 100%;
          max-width: 640px;
          height: auto;
          border-radius: 15px;
          margin-bottom: 20px;
        }
        
        .camera-controls {
          display: flex;
          gap: 10px;
          justify-content: center;
          flex-wrap: wrap;
        }
        
        .capture-btn, .switch-camera-btn, .close-camera-btn {
          padding: 12px 20px;
          border: none;
          border-radius: 25px;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.3s ease;
          display: inline-flex;
          align-items: center;
          gap: 8px;
        }
        
        .capture-btn {
          background: linear-gradient(135deg, #00ff80, #00cc66);
          color: #000;
        }
        
        .switch-camera-btn {
          background: linear-gradient(135deg, #007bff, #0056b3);
          color: white;
        }
        
        .close-camera-btn {
          background: linear-gradient(135deg, #dc3545, #c82333);
          color: white;
        }
        
        .capture-btn:hover, .switch-camera-btn:hover, .close-camera-btn:hover {
          transform: translateY(-2px);
          box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        
        @media (max-width: 768px) {
          .camera-container {
            padding: 15px;
            margin: 10px;
          }
          
          .camera-controls {
            flex-direction: column;
            gap: 8px;
          }
          
          .capture-btn, .switch-camera-btn, .close-camera-btn {
            width: 100%;
            justify-content: center;
          }
        }
      `,document.head.appendChild(a)},removeCameraStyles(){const a=document.getElementById("camera-modal-styles");a&&a.remove()},checkCameraAvailability(){return!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia?(console.log("Camera not supported on this device/browser"),!1):(navigator.permissions&&navigator.permissions.query?navigator.permissions.query({name:"camera"}).then(a=>{console.log("Camera permission status:",a.state),a.state==="granted"?console.log("Camera permission already granted"):a.state==="denied"?console.log("Camera permission denied"):console.log("Camera permission not determined yet")}).catch(a=>{console.log("Permission query not supported:",a)}):console.log("Permission API not supported, will request on first use"),!0)},saveGeneralInfo(){const a=new FormData;a.append("id",this.options.id),a.append("name",this.options.name),a.append("email",this.options.email),a.append("phone",this.options.phone),a.append("role",this.options.role),a.append("bank_name",this.options.bank_name||""),a.append("account_no",this.options.account_no||""),a.append("ifsc_code",this.options.ifsc_code||""),a.append("aadhar_number",this.options.aadhar_number||""),a.append("pan_number",this.options.pan_number||""),a.append("address",this.options.address||""),this.selectedFile?(a.append("profile_image",this.selectedFile),console.log("Profile image appended:",this.selectedFile)):console.log("No profile image selected"),this.kycImages.aadhar_front_image&&a.append("aadhar_front_image",this.kycImages.aadhar_front_image),this.kycImages.aadhar_back_image&&a.append("aadhar_back_image",this.kycImages.aadhar_back_image),this.kycImages.pan_card_image&&a.append("pan_card_image",this.kycImages.pan_card_image),x.post(`/update-profile/${btoa(this.options.id)}`,a,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{console.log("Profile update response:",e.data),this.options=e.data.data,console.log("Updated options:",this.options),this.selectedFile=null,this.imagePreview=null,this.kycImages={},this.isEditMode=!1,window.dispatchEvent(new Event("profileUpdated")),y.fire({icon:"success",title:"Profile updated successfully",timer:1500,showConfirmButton:!1}),this.fetchUserProfile()}).catch(e=>{var i;((i=e.response)==null?void 0:i.data.code)===422&&(this.errors=e.response.data.errors)})},handleKYCImageUpload(a,e){const i=e.target.files[0];if(i){if(i.size>2*1024*1024){y.fire({icon:"error",title:"File too large",text:"Please select a file smaller than 2MB"}),e.target.value="";return}if(!["image/jpeg","image/jpg","image/png"].includes(i.type)){y.fire({icon:"error",title:"Invalid file type",text:"Please select JPG, PNG, or JPEG files only"}),e.target.value="";return}this.kycImages||(this.kycImages={}),this.kycImages[a]=i,this.kycImagePreviews||(this.kycImagePreviews={}),this.kycImagePreviews[a]=URL.createObjectURL(i)}},getImageUrl(a){return a?a.startsWith("http")?a:`${window.location.origin}/storage/${a}`:""},getProfileImageUrl(a){return a?a.startsWith("http")?a:`${window.location.origin}/storage/${a}`:"/storage/default-avatar.png"},fetchUserProfile(){x.get("/userprofile").then(a=>{a.data.data&&(this.options=a.data.data,console.log("Refreshed profile data:",this.options))}).catch(a=>{console.error("Error fetching user profile:",a)})},removeKYCImage(a){const e=document.getElementById(a);e&&(e.value=""),this.kycImages[a]&&delete this.kycImages[a],this.kycImagePreviews[a]&&(URL.revokeObjectURL(this.kycImagePreviews[a]),delete this.kycImagePreviews[a])}}},A={class:"profile-image-container mb-3"},T=["src"],D={key:0,class:"profile-upload-overlay"},L={key:1,class:"file-info"},O={class:"mt-4"},G={class:"fw-bold"},j={class:"text-muted"},K={class:"text-muted"},J={class:"edit-profile-section mt-3 mb-3"},Y={class:"balance-card mt-3"},z={class:"balance-amount"},q={class:"balance-refresh"},H=["disabled"],W={key:0,class:"text-danger small"},Q={key:0,class:"text-danger small"},X={key:0,class:"text-danger small"},Z={key:0,class:"text-danger small"},$={key:0,class:"text-danger small"},ee={key:0,class:"text-danger small"},ae={key:0,class:"text-danger small"},se={key:0,class:"text-danger small"},te={key:0,class:"mb-2"},re=["src"],oe={class:"file-input-wrapper"},le={key:1,class:"image-preview-container"},ne=["src"],ie={key:2,class:"text-danger small"},de={key:0,class:"mb-2"},ce=["src"],me={class:"file-input-wrapper"},ue={key:1,class:"image-preview-container"},pe=["src"],ge={key:2,class:"text-danger small"},be={key:0,class:"mb-2"},fe=["src"],_e={class:"file-input-wrapper"},he={key:1,class:"image-preview-container"},we=["src"],ve={key:2,class:"text-danger small"},ye={class:"mt-4"};function Ee(a,e,i,w,r,t){const E=u("b-button"),p=u("b-col"),_=u("b-form-input"),b=u("b-form-group"),v=u("b-row"),P=u("b-form-textarea"),C=u("b-form"),I=u("b-card"),M=u("b-container");return d(),U(M,{fluid:"",class:"main-content"},{default:l(()=>[o(I,{class:"profile-card shadow-lg border-0"},{default:l(()=>[o(v,null,{default:l(()=>[o(p,{md:"4",class:"text-center border-end border-gray-700 pe-4"},{default:l(()=>[s("div",A,[s("img",{src:r.imagePreview||t.getProfileImageUrl(r.options.profile_image),class:"profile-avatar",alt:"User Avatar",onError:e[0]||(e[0]=(...n)=>a.setDefaultImage&&a.setDefaultImage(...n))},null,40,T),r.isEditMode?(d(),m("div",D,[o(E,{variant:"success",class:"camera-btn",onClick:t.openCamera},{default:l(()=>e[25]||(e[25]=[s("i",{class:"bi bi-camera me-1"},null,-1),f(" Take Photo ")])),_:1},8,["onClick"])])):c("",!0),r.isEditMode?(d(),m("div",L,e[26]||(e[26]=[s("small",{class:"text-muted"},[s("i",{class:"bi bi-info-circle me-1"}),f(" Click to take a photo with your camera ")],-1)]))):c("",!0)]),s("div",O,[s("h5",G,g(r.options.name),1),s("p",j,[e[27]||(e[27]=s("strong",null,"Email:",-1)),f(" "+g(r.options.email),1)]),s("p",K,[e[28]||(e[28]=s("strong",null,"Contact:",-1)),f(" "+g(r.options.phone),1)]),s("div",J,[r.isEditMode?c("",!0):(d(),U(E,{key:0,type:"button",variant:"primary",class:"edit-profile-btn",onClick:t.toggleEditMode},{default:l(()=>e[29]||(e[29]=[s("i",{class:"bi bi-pencil me-1"},null,-1),f(" Edit Profile ")])),_:1},8,["onClick"]))]),s("div",Y,[e[30]||(e[30]=s("div",{class:"balance-header"},[s("i",{class:"bi bi-wallet2 me-2"}),s("span",null,"Current Balance")],-1)),s("div",z," ₹"+g(t.formatBalance(r.userBalance)),1),s("div",q,[s("button",{onClick:e[1]||(e[1]=(...n)=>t.fetchUserBalance&&t.fetchUserBalance(...n)),class:"refresh-btn",disabled:r.balanceLoading},[s("i",{class:k(["bi bi-arrow-clockwise",{spinning:r.balanceLoading}])},null,2),f(" "+g(r.balanceLoading?"Updating...":"Refresh"),1)],8,H)])])])]),_:1}),o(p,{md:"8",class:"ps-4"},{default:l(()=>[e[46]||(e[46]=s("h4",{class:"fw-bold mb-3 text-primary"},"Edit Profile",-1)),o(C,{onSubmit:B(t.saveGeneralInfo,["prevent"])},{default:l(()=>[o(v,null,{default:l(()=>[o(p,{md:"6",class:"mb-3"},{default:l(()=>[o(b,{label:"Full Name","label-class":"fw-semibold"},{default:l(()=>[o(_,{id:"name",modelValue:r.options.name,"onUpdate:modelValue":e[2]||(e[2]=n=>r.options.name=n),onInput:e[3]||(e[3]=n=>t.RemoveError("name")),state:t.hasErrors("name")?!1:null,readonly:!r.isEditMode,placeholder:"Enter Name",autocomplete:"off"},null,8,["modelValue","state","readonly"]),t.hasErrors("name")?(d(),m("div",W,g(t.getErrors("name")),1)):c("",!0)]),_:1})]),_:1}),o(p,{md:"6",class:"mb-3"},{default:l(()=>[o(b,{label:"Email","label-class":"fw-semibold"},{default:l(()=>[o(_,{modelValue:r.options.email,"onUpdate:modelValue":e[4]||(e[4]=n=>r.options.email=n),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),o(p,{md:"6",class:"mb-3"},{default:l(()=>[o(b,{label:"Phone","label-class":"fw-semibold"},{default:l(()=>[o(_,{id:"phone",modelValue:r.options.phone,"onUpdate:modelValue":e[5]||(e[5]=n=>r.options.phone=n),onInput:e[6]||(e[6]=n=>t.RemoveError("phone")),state:t.hasErrors("phone")?!1:null,readonly:!r.isEditMode,placeholder:"Enter Mobile Number",autocomplete:"off"},null,8,["modelValue","state","readonly"]),t.hasErrors("phone")?(d(),m("div",Q,g(t.getErrors("phone")),1)):c("",!0)]),_:1})]),_:1}),o(p,{md:"6",class:"mb-3"},{default:l(()=>[o(b,{label:"Bank Name","label-class":"fw-semibold"},{default:l(()=>[o(_,{id:"bank_name",modelValue:r.options.bank_name,"onUpdate:modelValue":e[7]||(e[7]=n=>r.options.bank_name=n),onInput:e[8]||(e[8]=n=>t.RemoveError("bank_name")),state:t.hasErrors("bank_name")?!1:null,readonly:!r.isEditMode,placeholder:"Enter Bank Name",autocomplete:"off"},null,8,["modelValue","state","readonly"]),t.hasErrors("bank_name")?(d(),m("div",X,g(t.getErrors("bank_name")),1)):c("",!0)]),_:1})]),_:1}),o(p,{md:"6",class:"mb-3"},{default:l(()=>[o(b,{label:"Account Number","label-class":"fw-semibold"},{default:l(()=>[o(_,{id:"account_no",modelValue:r.options.account_no,"onUpdate:modelValue":e[9]||(e[9]=n=>r.options.account_no=n),onInput:e[10]||(e[10]=n=>t.RemoveError("account_no")),state:t.hasErrors("account_no")?!1:null,readonly:!r.isEditMode,placeholder:"Enter Account Number",autocomplete:"off"},null,8,["modelValue","state","readonly"]),t.hasErrors("account_no")?(d(),m("div",Z,g(t.getErrors("account_no")),1)):c("",!0)]),_:1})]),_:1}),o(p,{md:"6",class:"mb-3"},{default:l(()=>[o(b,{label:"IFSC Code","label-class":"fw-semibold"},{default:l(()=>[o(_,{id:"ifsc_code",modelValue:r.options.ifsc_code,"onUpdate:modelValue":e[11]||(e[11]=n=>r.options.ifsc_code=n),onInput:e[12]||(e[12]=n=>t.RemoveError("ifsc_code")),state:t.hasErrors("ifsc_code")?!1:null,readonly:!r.isEditMode,placeholder:"Enter IFSC Code",autocomplete:"off"},null,8,["modelValue","state","readonly"]),t.hasErrors("ifsc_code")?(d(),m("div",$,g(t.getErrors("ifsc_code")),1)):c("",!0)]),_:1})]),_:1})]),_:1}),o(v,null,{default:l(()=>[o(p,{md:"6",class:"mb-3"},{default:l(()=>[o(b,{label:"Aadhar Number","label-class":"fw-semibold"},{default:l(()=>[o(_,{id:"aadhar_number",modelValue:r.options.aadhar_number,"onUpdate:modelValue":e[13]||(e[13]=n=>r.options.aadhar_number=n),onInput:e[14]||(e[14]=n=>t.RemoveError("aadhar_number")),state:t.hasErrors("aadhar_number")?!1:null,readonly:!r.isEditMode,placeholder:"Enter Aadhar Number",autocomplete:"off",maxlength:"12"},null,8,["modelValue","state","readonly"]),t.hasErrors("aadhar_number")?(d(),m("div",ee,g(t.getErrors("aadhar_number")),1)):c("",!0)]),_:1})]),_:1}),o(p,{md:"6",class:"mb-3"},{default:l(()=>[o(b,{label:"PAN Card Number","label-class":"fw-semibold"},{default:l(()=>[o(_,{id:"pan_number",modelValue:r.options.pan_number,"onUpdate:modelValue":e[15]||(e[15]=n=>r.options.pan_number=n),onInput:e[16]||(e[16]=n=>t.RemoveError("pan_number")),state:t.hasErrors("pan_number")?!1:null,readonly:!r.isEditMode,placeholder:"Enter PAN Number",autocomplete:"off",maxlength:"10",style:{"text-transform":"uppercase"}},null,8,["modelValue","state","readonly"]),t.hasErrors("pan_number")?(d(),m("div",ae,g(t.getErrors("pan_number")),1)):c("",!0)]),_:1})]),_:1})]),_:1}),o(v,null,{default:l(()=>[o(p,{md:"12",class:"mb-3"},{default:l(()=>[o(b,{label:"Address","label-class":"fw-semibold"},{default:l(()=>[o(P,{id:"address",modelValue:r.options.address,"onUpdate:modelValue":e[17]||(e[17]=n=>r.options.address=n),onInput:e[18]||(e[18]=n=>t.RemoveError("address")),state:t.hasErrors("address")?!1:null,readonly:!r.isEditMode,placeholder:"Enter Complete Address",rows:"3",autocomplete:"off"},null,8,["modelValue","state","readonly"]),t.hasErrors("address")?(d(),m("div",se,g(t.getErrors("address")),1)):c("",!0)]),_:1})]),_:1})]),_:1}),o(v,null,{default:l(()=>[o(p,{md:"12",class:"mb-3"},{default:l(()=>e[31]||(e[31]=[s("h6",{class:"fw-semibold text-primary mb-3"},[s("i",{class:"bi bi-file-earmark-image me-2"}),f("KYC Documents ")],-1)])),_:1})]),_:1}),o(v,null,{default:l(()=>[o(p,{md:"6",class:"mb-3"},{default:l(()=>[o(b,{label:"Aadhar Front Image","label-class":"fw-semibold"},{default:l(()=>[!r.isEditMode&&r.options.aadhar_front_image?(d(),m("div",te,[s("img",{src:t.getImageUrl(r.options.aadhar_front_image),alt:"Aadhar Front",class:"img-thumbnail",style:{"max-width":"200px","max-height":"150px"}},null,8,re)])):c("",!0),s("div",oe,[r.isEditMode?(d(),m("input",{key:0,type:"file",id:"aadhar_front_image",onChange:e[19]||(e[19]=n=>t.handleKYCImageUpload("aadhar_front_image",n)),accept:"image/*",class:k(["form-control",{"is-invalid":t.hasErrors("aadhar_front_image")}])},null,34)):c("",!0),e[32]||(e[32]=s("label",{for:"aadhar_front_image",class:"file-input-label"},[s("i",{class:"bi bi-cloud-upload me-2"}),f("Choose Aadhar Front Image ")],-1))]),r.isEditMode&&r.kycImagePreviews.aadhar_front_image?(d(),m("div",le,[e[34]||(e[34]=s("div",{class:"preview-label"},"Selected Image Preview:",-1)),s("img",{src:r.kycImagePreviews.aadhar_front_image,alt:"Aadhar Front Preview",class:"selected-image-preview"},null,8,ne),s("button",{type:"button",class:"btn-remove-image",onClick:e[20]||(e[20]=n=>t.removeKYCImage("aadhar_front_image"))},e[33]||(e[33]=[s("i",{class:"bi bi-x-circle"},null,-1),f(" Remove ")]))])):c("",!0),t.hasErrors("aadhar_front_image")?(d(),m("div",ie,g(t.getErrors("aadhar_front_image")),1)):c("",!0),e[35]||(e[35]=s("small",{class:"text-muted"},"Max size: 2MB, Format: JPG, PNG, JPEG",-1))]),_:1})]),_:1}),o(p,{md:"6",class:"mb-3"},{default:l(()=>[o(b,{label:"Aadhar Back Image","label-class":"fw-semibold"},{default:l(()=>[!r.isEditMode&&r.options.aadhar_back_image?(d(),m("div",de,[s("img",{src:t.getImageUrl(r.options.aadhar_back_image),alt:"Aadhar Back",class:"img-thumbnail",style:{"max-width":"200px","max-height":"150px"}},null,8,ce)])):c("",!0),s("div",me,[r.isEditMode?(d(),m("input",{key:0,type:"file",id:"aadhar_back_image",onChange:e[21]||(e[21]=n=>t.handleKYCImageUpload("aadhar_back_image",n)),accept:"image/*",class:k(["form-control",{"is-invalid":t.hasErrors("aadhar_back_image")}])},null,34)):c("",!0),e[36]||(e[36]=s("label",{for:"aadhar_back_image",class:"file-input-label"},[s("i",{class:"bi bi-cloud-upload me-2"}),f("Choose Aadhar Back Image ")],-1))]),r.isEditMode&&r.kycImagePreviews.aadhar_back_image?(d(),m("div",ue,[e[38]||(e[38]=s("div",{class:"preview-label"},"Selected Image Preview:",-1)),s("img",{src:r.kycImagePreviews.aadhar_back_image,alt:"Aadhar Back Preview",class:"selected-image-preview"},null,8,pe),s("button",{type:"button",class:"btn-remove-image",onClick:e[22]||(e[22]=n=>t.removeKYCImage("aadhar_back_image"))},e[37]||(e[37]=[s("i",{class:"bi bi-x-circle"},null,-1),f(" Remove ")]))])):c("",!0),t.hasErrors("aadhar_back_image")?(d(),m("div",ge,g(t.getErrors("aadhar_back_image")),1)):c("",!0),e[39]||(e[39]=s("small",{class:"text-muted"},"Max size: 2MB, Format: JPG, PNG, JPEG",-1))]),_:1})]),_:1})]),_:1}),o(v,null,{default:l(()=>[o(p,{md:"6",class:"mb-3"},{default:l(()=>[o(b,{label:"PAN Card Image","label-class":"fw-semibold"},{default:l(()=>[!r.isEditMode&&r.options.pan_card_image?(d(),m("div",be,[s("img",{src:t.getImageUrl(r.options.pan_card_image),alt:"PAN Card",class:"img-thumbnail",style:{"max-width":"200px","max-height":"150px"}},null,8,fe)])):c("",!0),s("div",_e,[r.isEditMode?(d(),m("input",{key:0,type:"file",id:"pan_card_image",onChange:e[23]||(e[23]=n=>t.handleKYCImageUpload("pan_card_image",n)),accept:"image/*",class:k(["form-control",{"is-invalid":t.hasErrors("pan_card_image")}])},null,34)):c("",!0),e[40]||(e[40]=s("label",{for:"pan_card_image",class:"file-input-label"},[s("i",{class:"bi bi-cloud-upload me-2"}),f("Choose PAN Card Image ")],-1))]),r.isEditMode&&r.kycImagePreviews.pan_card_image?(d(),m("div",he,[e[42]||(e[42]=s("div",{class:"preview-label"},"Selected Image Preview:",-1)),s("img",{src:r.kycImagePreviews.pan_card_image,alt:"PAN Card Preview",class:"selected-image-preview"},null,8,we),s("button",{type:"button",class:"btn-remove-image",onClick:e[24]||(e[24]=n=>t.removeKYCImage("pan_card_image"))},e[41]||(e[41]=[s("i",{class:"bi bi-x-circle"},null,-1),f(" Remove ")]))])):c("",!0),t.hasErrors("pan_card_image")?(d(),m("div",ve,g(t.getErrors("pan_card_image")),1)):c("",!0),e[43]||(e[43]=s("small",{class:"text-muted"},"Max size: 2MB, Format: JPG, PNG, JPEG",-1))]),_:1})]),_:1})]),_:1}),s("div",ye,[r.isEditMode?(d(),m(S,{key:0},[o(E,{type:"submit",variant:"success",class:"me-2 rounded-pill px-4"},{default:l(()=>e[44]||(e[44]=[s("i",{class:"bi bi-check-circle me-1"},null,-1),f(" Save Changes ")])),_:1}),o(E,{type:"button",variant:"secondary",class:"rounded-pill px-4",onClick:t.toggleEditMode},{default:l(()=>e[45]||(e[45]=[s("i",{class:"bi bi-x-circle me-1"},null,-1),f(" Cancel ")])),_:1},8,["onClick"])],64)):c("",!0)])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1})}const ke=V(R,[["render",Ee],["__scopeId","data-v-2117ad00"]]);x.defaults.withCredentials=!0;const xe={data(){return{showOldPassword:!1,showNewPassword:!1,showConfirmPassword:!1,errors:{},isSubmitting:!1}},methods:{RemoveError(a){this.errors[a]&&delete this.errors[a]},hasErrors(a){return this.errors&&this.errors[a]},getErrors(a){return this.errors[a]?this.errors[a][0]:""},toggleOldPasswordView(){this.showOldPassword=!this.showOldPassword},toggleNewPasswordView(){this.showNewPassword=!this.showNewPassword},toggleConfirmPasswordView(){this.showConfirmPassword=!this.showConfirmPassword},async changePassword(){this.isSubmitting=!0;try{(await x.post("/change-password",this.userpassword)).data.status==="success"&&y.fire({title:"Success!",text:"Password changed successfully.",icon:"success",timer:2e3,showConfirmButton:!1}).then(()=>{this.router.replace({name:"dashboard"})})}catch(a){a.response&&a.response.data.code===422?this.errors=a.response.data.errors:y.fire({title:"Error!",text:"Failed to change password. Please try again.",icon:"error",confirmButtonText:"OK"})}finally{this.isSubmitting=!1}}},setup(){const a=N({current_password:"",new_password:"",new_password_confirmation:""}),e=N([]),i=F();return{userpassword:a,errors:e,router:i}}},Pe={key:0,class:"text-danger small"},Ce={key:0,class:"text-danger small"},Ie={key:0,class:"text-danger small"},Me={class:"mt-4"};function Ue(a,e,i,w,r,t){const E=u("b-col"),p=u("b-form-input"),_=u("b-input-group-append"),b=u("b-input-group"),v=u("b-form-group"),P=u("b-button"),C=u("b-form"),I=u("b-row"),M=u("b-card"),n=u("b-container");return d(),U(n,{fluid:"",class:"main-content"},{default:l(()=>[o(M,{class:"profile-card shadow-lg border-0"},{default:l(()=>[o(I,null,{default:l(()=>[o(E,{md:"4",class:"text-center border-end border-gray-700 pe-4"},{default:l(()=>e[9]||(e[9]=[s("div",{class:"password-icon-container mb-4"},[s("div",{class:"password-icon"},[s("i",{class:"bi bi-shield-lock"})])],-1),s("div",{class:"mt-4"},[s("h5",{class:"fw-bold text-primary"},"Password Security"),s("p",{class:"text-muted"},[s("strong",null,"Keep your account safe")]),s("p",{class:"text-muted"},[s("strong",null,"Use a strong password")]),s("div",{class:"security-tips-card mt-3"},[s("div",{class:"tips-header"},[s("i",{class:"bi bi-lightbulb me-2"}),s("span",null,"Security Tips")]),s("div",{class:"tips-content"},[s("ul",{class:"tips-list"},[s("li",null,"Use at least 8 characters"),s("li",null,"Include numbers & symbols"),s("li",null,"Don't reuse old passwords")])])])],-1)])),_:1}),o(E,{md:"8",class:"ps-4"},{default:l(()=>[e[11]||(e[11]=s("h4",{class:"fw-bold mb-4 text-primary"},[s("i",{class:"bi bi-key me-2"}),f("Change Password ")],-1)),o(C,{onSubmit:B(t.changePassword,["prevent"])},{default:l(()=>[o(v,{label:"Current Password","label-class":"fw-semibold",class:"mb-3"},{default:l(()=>[o(b,{class:"input-group-merge"},{default:l(()=>[o(p,{type:r.showOldPassword?"text":"password",modelValue:w.userpassword.current_password,"onUpdate:modelValue":e[0]||(e[0]=h=>w.userpassword.current_password=h),id:"current_password",onInput:e[1]||(e[1]=h=>t.RemoveError("current_password")),state:t.hasErrors("current_password")?!1:null,placeholder:"Enter your current password",autocomplete:"current-password",class:"form-control"},null,8,["type","modelValue","state"]),o(_,{"is-text":""},{default:l(()=>[s("button",{type:"button",onClick:e[2]||(e[2]=(...h)=>t.toggleOldPasswordView&&t.toggleOldPasswordView(...h)),class:"toggle-password-btn"},[s("i",{class:k(r.showOldPassword?"bi bi-eye-slash":"bi bi-eye")},null,2)])]),_:1})]),_:1}),t.hasErrors("current_password")?(d(),m("div",Pe,g(t.getErrors("current_password")),1)):c("",!0)]),_:1}),o(v,{label:"New Password","label-class":"fw-semibold",class:"mb-3"},{default:l(()=>[o(b,{class:"input-group-merge"},{default:l(()=>[o(p,{type:r.showNewPassword?"text":"password",modelValue:w.userpassword.new_password,"onUpdate:modelValue":e[3]||(e[3]=h=>w.userpassword.new_password=h),id:"new_password",onInput:e[4]||(e[4]=h=>t.RemoveError("new_password")),state:t.hasErrors("new_password")?!1:null,placeholder:"Enter your new password",autocomplete:"new-password",class:"form-control"},null,8,["type","modelValue","state"]),o(_,{"is-text":""},{default:l(()=>[s("button",{type:"button",onClick:e[5]||(e[5]=(...h)=>t.toggleNewPasswordView&&t.toggleNewPasswordView(...h)),class:"toggle-password-btn"},[s("i",{class:k(r.showNewPassword?"bi bi-eye-slash":"bi bi-eye")},null,2)])]),_:1})]),_:1}),t.hasErrors("new_password")?(d(),m("div",Ce,g(t.getErrors("new_password")),1)):c("",!0)]),_:1}),o(v,{label:"Confirm New Password","label-class":"fw-semibold",class:"mb-4"},{default:l(()=>[o(b,{class:"input-group-merge"},{default:l(()=>[o(p,{type:r.showConfirmPassword?"text":"password",modelValue:w.userpassword.new_password_confirmation,"onUpdate:modelValue":e[6]||(e[6]=h=>w.userpassword.new_password_confirmation=h),id:"new_password_confirmation",onInput:e[7]||(e[7]=h=>t.RemoveError("new_password_confirmation")),state:t.hasErrors("new_password_confirmation")?!1:null,placeholder:"Confirm your new password",autocomplete:"new-password",class:"form-control"},null,8,["type","modelValue","state"]),o(_,{"is-text":""},{default:l(()=>[s("button",{type:"button",onClick:e[8]||(e[8]=(...h)=>t.toggleConfirmPasswordView&&t.toggleConfirmPasswordView(...h)),class:"toggle-password-btn"},[s("i",{class:k(r.showConfirmPassword?"bi bi-eye-slash":"bi bi-eye")},null,2)])]),_:1})]),_:1}),t.hasErrors("new_password_confirmation")?(d(),m("div",Ie,g(t.getErrors("new_password_confirmation")),1)):c("",!0)]),_:1}),s("div",Me,[o(P,{type:"submit",variant:"success",class:"change-password-btn",disabled:r.isSubmitting},{default:l(()=>[e[10]||(e[10]=s("i",{class:"bi bi-check-circle me-1"},null,-1)),f(" "+g(r.isSubmitting?"Changing Password...":"Change Password"),1)]),_:1},8,["disabled"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1})}const Ve=V(xe,[["render",Ue],["__scopeId","data-v-cd914128"]]),Ne={props:{userId:{type:String,required:!0}},components:{GeneralTab:ke,ChangePasswordTab:Ve},methods:{logout(){localStorage.removeItem("userData"),localStorage.removeItem("access_token"),localStorage.removeItem("token"),localStorage.removeItem("auth_token"),localStorage.removeItem("user"),sessionStorage.clear(),this.$router.push({name:"login"})}}},Be={class:"profile-tabs-container"},Se={class:"tabs-wrapper"},Fe={class:"tabs-header"},Re={class:"logout-section"};function Ae(a,e,i,w,r,t){const E=u("GeneralTab"),p=u("b-tab"),_=u("ChangePasswordTab"),b=u("b-tabs");return d(),m("div",Be,[s("div",Se,[s("div",Fe,[o(b,{pills:"","content-class":"mt-3","nav-class":"modern-nav-tabs"},{default:l(()=>[o(p,{title:"👤 Profile",active:""},{default:l(()=>[o(E,{userId:i.userId},null,8,["userId"])]),_:1}),o(p,{title:"🔒 Change Password"},{default:l(()=>[o(_,{userId:i.userId},null,8,["userId"])]),_:1})]),_:1}),s("div",Re,[s("button",{onClick:e[0]||(e[0]=(...v)=>t.logout&&t.logout(...v)),class:"logout-btn"},e[1]||(e[1]=[s("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor"},[s("path",{d:"M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.59L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"})],-1),s("span",null,"Logout",-1)]))])])])])}const De=V(Ne,[["render",Ae],["__scopeId","data-v-4d056d85"]]);export{De as default};
