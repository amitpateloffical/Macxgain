import{_ as x,g as C,c as i,o as n,b as s,h as d,l as F,a as D,i as p,n as c,t as o,F as T,r as O,q as A,j as m,v as f,Y as E,W as N,s as R}from"./app-BFj7m03g.js";const M={name:"UserOrders",data(){return{loading:!1,showPlaceOrderModal:!1,showDetailedAnalysis:!1,orders:[],orderForm:{stockSearch:"",selectedStock:null,type:"BUY",product:"CNC",quantity:1,price:0},stockSearchResults:[],availableStocks:[{symbol:"RELIANCE",name:"Reliance Industries Ltd",price:2456.75},{symbol:"TCS",name:"Tata Consultancy Services",price:3678.45},{symbol:"INFY",name:"Infosys Limited",price:1567.8},{symbol:"HDFC",name:"HDFC Bank Limited",price:1678.9},{symbol:"WIPRO",name:"Wipro Limited",price:456.78},{symbol:"MARUTI",name:"Maruti Suzuki India Ltd",price:9876.54},{symbol:"ICICIBANK",name:"ICICI Bank Ltd",price:987.65}],autoRefreshInterval:null}},computed:{filteredOrders(){return this.orders},totalOrders(){return this.orders.length},pendingOrders(){return this.orders.filter(a=>a.status==="PENDING").length},executedOrders(){return this.orders.filter(a=>a.status==="EXECUTED").length},cancelledOrders(){return this.orders.filter(a=>a.status==="CANCELLED").length},closedTrades(){return this.orders.filter(a=>a.status==="CLOSED"&&a.pnl!==null&&a.pnl!==void 0)},profitableTrades(){return this.closedTrades.filter(a=>a.pnl>0)},lossTrades(){return this.closedTrades.filter(a=>a.pnl<0)},totalProfit(){return this.profitableTrades.reduce((a,t)=>a+(t.pnl||0),0)},totalLoss(){return this.lossTrades.reduce((a,t)=>a+(t.pnl||0),0)},overallPnL(){return this.totalProfit+this.totalLoss},totalInvested(){return this.orders.filter(a=>a.status==="CLOSED").reduce((a,t)=>a+(t.totalAmount||0),0)},totalReturn(){return this.totalInvested+this.overallPnL},winRate(){return this.closedTrades.length===0?0:Math.round(this.profitableTrades.length/this.closedTrades.length*100)},avgProfitPerTrade(){return this.closedTrades.length===0?0:this.overallPnL/this.closedTrades.length},orderValue(){return(this.orderForm.quantity||0)*(this.orderForm.price||0)},canPlaceOrder(){return this.orderForm.selectedStock&&this.orderForm.quantity>0&&this.orderForm.price>0&&this.orderForm.type}},mounted(){this.loadOrders(),this.startAutoRefresh()},beforeUnmount(){this.autoRefreshInterval&&clearInterval(this.autoRefreshInterval)},methods:{async loadOrders(){var a,t;try{this.loading=!0;const u=localStorage.getItem("access_token"),v=JSON.parse(localStorage.getItem("userData")||"{}");if(!v.id){this.showError("User not found. Please login again.");return}if(!u){this.showError("Authentication token not found. Please login again.");return}const r=await R.get(`ai-trading/user-orders/${v.id}`);r.data.success?this.orders=r.data.orders.map(l=>({id:l.id,symbol:l.stock_symbol,exchange:"NSE",type:l.action,status:l.status==="COMPLETED"?"EXECUTED":l.status==="CLOSED"?"CLOSED":l.status,quantity:parseInt(l.quantity),price:parseFloat(l.strike_price),executedPrice:l.exit_price?parseFloat(l.exit_price):null,pnl:l.pnl?parseFloat(l.pnl):0,timestamp:new Date(l.created_at),executedAt:l.closed_at?new Date(l.closed_at):null,optionType:l.option_type,totalAmount:parseFloat(l.total_amount)})):this.showError(r.data.message||"Failed to load orders")}catch(u){console.error("Error loading orders:",u),((a=u.response)==null?void 0:a.status)===401?this.showError("Authentication failed. Please login again."):((t=u.response)==null?void 0:t.status)===403?this.showError("Access denied. You do not have permission to view orders."):this.showError("Failed to load orders. Please try again.")}finally{this.loading=!1}},startAutoRefresh(){this.autoRefreshInterval=setInterval(()=>{this.loadOrders(),console.log("Auto-refresh: Orders updated at",new Date().toLocaleTimeString())},1e4)},showError(a){alert(a)},getStatusIcon(a){switch(a){case"PENDING":return"fas fa-clock";case"EXECUTED":return"fas fa-check-circle";case"CANCELLED":return"fas fa-times-circle";default:return"fas fa-question-circle"}},formatTime(a){return a?new Date(a).toLocaleString("en-IN",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"}):"-"},searchStocks(){if(this.orderForm.stockSearch.length<2){this.stockSearchResults=[];return}this.stockSearchResults=this.availableStocks.filter(a=>a.symbol.toLowerCase().includes(this.orderForm.stockSearch.toLowerCase())||a.name.toLowerCase().includes(this.orderForm.stockSearch.toLowerCase())).slice(0,5)},selectStock(a){this.orderForm.selectedStock=a,this.orderForm.stockSearch=a.symbol,this.orderForm.price=a.price,this.stockSearchResults=[]},placeOrder(){if(!this.canPlaceOrder)return;const a={id:this.orders.length+1,symbol:this.orderForm.selectedStock.symbol,exchange:"NSE",type:this.orderForm.type,status:"PENDING",quantity:parseInt(this.orderForm.quantity),price:parseFloat(this.orderForm.price),executedPrice:0,pnl:0,timestamp:new Date,executedAt:null};this.orders.unshift(a),this.closeOrderModal(),this.$bvToast.toast(`${this.orderForm.type} order for ${this.orderForm.quantity} ${this.orderForm.selectedStock.symbol} placed successfully`,{title:"Order Placed",variant:"success",solid:!0})},closeOrderModal(){this.showPlaceOrderModal=!1,this.orderForm={stockSearch:"",selectedStock:null,type:"BUY",product:"CNC",quantity:1,price:0},this.stockSearchResults=[]}}},U={class:"orders-container"},V={class:"orders-header"},q={class:"header-content"},B={class:"header-actions"},Y=["disabled"],W={class:"stats-section"},X={class:"stats-grid"},z={class:"stat-card"},G={class:"stat-content"},H={class:"stat-value"},Q={class:"stat-card"},j={class:"stat-content"},J={class:"stat-value"},K={class:"stat-card profit"},Z={class:"stat-content"},$={class:"stat-value profit"},ss={class:"stat-card loss"},ts={class:"stat-content"},es={class:"stat-value loss"},ls={key:0,class:"pnl-analysis-section"},as={class:"section-header"},os={class:"pnl-summary"},rs={class:"pnl-card profit"},is={class:"pnl-content"},ns={class:"pnl-value"},ds={class:"pnl-count"},cs={class:"pnl-card loss"},us={class:"pnl-content"},ps={class:"pnl-value"},ms={class:"pnl-count"},vs={class:"pnl-content"},hs={class:"pnl-value"},fs={class:"pnl-count"},ys={key:0,class:"detailed-analysis"},_s={class:"analysis-grid"},gs={class:"analysis-item"},bs={class:"analysis-value"},Ss={class:"analysis-item"},ks={class:"analysis-value"},Ls={class:"analysis-item"},ws={class:"analysis-value"},Cs={class:"analysis-item"},Fs={class:"analysis-value"},Ts={class:"orders-content"},Os={key:0,class:"empty-state"},Es={key:1,class:"loading-state"},Ps={key:2,class:"orders-list"},Is={class:"order-header"},xs={class:"order-main-info"},Ds={class:"stock-info"},As={class:"stock-symbol"},Ns={class:"stock-exchange"},Rs={class:"order-status"},Ms={class:"order-time"},Us={class:"order-details"},Vs={class:"detail-row"},qs={class:"detail-group"},Bs={class:"detail-value"},Ys={class:"detail-group"},Ws={class:"detail-value"},Xs={class:"detail-group"},zs={class:"detail-value"},Gs={key:0,class:"detail-row"},Hs={class:"detail-group"},Qs={key:1,class:"detail-row"},js={key:0,class:"detail-group"},Js={class:"detail-value"},Ks={key:1,class:"detail-group"},Zs={key:2,class:"detail-group"},$s={class:"detail-value"},st={class:"place-order-content"},tt={class:"order-form"},et={class:"form-group"},lt={class:"stock-search-wrapper"},at={key:0,class:"search-results"},ot=["onClick"],rt={class:"result-info"},it={class:"result-symbol"},nt={class:"result-name"},dt={class:"result-price"},ct={class:"form-row"},ut={class:"form-group"},pt={class:"radio-group"},mt={class:"radio-option"},vt={class:"radio-option"},ht={class:"form-group"},ft={class:"form-row"},yt={class:"form-group"},_t={class:"form-group"},gt={class:"order-summary"},bt={class:"summary-row"},St={class:"summary-value"},kt={class:"summary-row total"},Lt={class:"summary-value"},wt={class:"modal-actions"},Ct=["disabled"];function Ft(a,t,u,v,r,l){var y,_,g,b,S,k,L,w;const P=C("b-modal"),I=C("BottomAppBar");return n(),i("div",U,[s("div",V,[s("div",q,[t[12]||(t[12]=D('<div class="header-left" data-v-15f42a4e><div class="header-icon" data-v-15f42a4e><i class="fas fa-list-alt" data-v-15f42a4e></i></div><div class="header-text" data-v-15f42a4e><h1 class="page-title" data-v-15f42a4e>Orders</h1><p class="page-subtitle" data-v-15f42a4e>Track your buy and sell orders</p></div></div>',1)),s("div",B,[s("button",{class:"btn-refresh",onClick:t[0]||(t[0]=(...e)=>l.loadOrders&&l.loadOrders(...e)),disabled:r.loading},[s("i",{class:c(["fas fa-sync-alt",{"fa-spin":r.loading}])},null,2),p(" "+o(r.loading?"Loading...":"Refresh"),1)],8,Y)])])]),s("div",W,[s("div",X,[s("div",z,[t[14]||(t[14]=s("div",{class:"stat-icon"},[s("i",{class:"fas fa-shopping-cart"})],-1)),s("div",G,[s("div",H,o(l.totalOrders),1),t[13]||(t[13]=s("div",{class:"stat-label"},"Total Orders",-1))])]),s("div",Q,[t[16]||(t[16]=s("div",{class:"stat-icon executed"},[s("i",{class:"fas fa-check-circle"})],-1)),s("div",j,[s("div",J,o(l.executedOrders),1),t[15]||(t[15]=s("div",{class:"stat-label"},"Executed",-1))])]),s("div",K,[t[18]||(t[18]=s("div",{class:"stat-icon profit"},[s("i",{class:"fas fa-arrow-up"})],-1)),s("div",Z,[s("div",$,"+â‚¹"+o((y=l.totalProfit)==null?void 0:y.toLocaleString()),1),t[17]||(t[17]=s("div",{class:"stat-label"},"Total Profit",-1))])]),s("div",ss,[t[20]||(t[20]=s("div",{class:"stat-icon loss"},[s("i",{class:"fas fa-arrow-down"})],-1)),s("div",ts,[s("div",es,"-â‚¹"+o((_=Math.abs(l.totalLoss))==null?void 0:_.toLocaleString()),1),t[19]||(t[19]=s("div",{class:"stat-label"},"Total Loss",-1))])])])]),l.closedTrades.length>0?(n(),i("div",ls,[s("div",as,[t[21]||(t[21]=s("h3",null,"ðŸ“Š Trading Performance Analysis",-1)),s("button",{class:"toggle-btn",onClick:t[1]||(t[1]=e=>r.showDetailedAnalysis=!r.showDetailedAnalysis)},[s("i",{class:c(["fas",r.showDetailedAnalysis?"fa-chevron-up":"fa-chevron-down"])},null,2),p(" "+o(r.showDetailedAnalysis?"Hide Details":"Show Details"),1)])]),s("div",os,[s("div",rs,[t[23]||(t[23]=s("div",{class:"pnl-icon"},[s("i",{class:"fas fa-arrow-up"})],-1)),s("div",is,[s("div",ns,"+â‚¹"+o((g=l.totalProfit)==null?void 0:g.toLocaleString()),1),t[22]||(t[22]=s("div",{class:"pnl-label"},"Total Profit",-1)),s("div",ds,o(l.profitableTrades.length)+" trades",1)])]),s("div",cs,[t[25]||(t[25]=s("div",{class:"pnl-icon"},[s("i",{class:"fas fa-arrow-down"})],-1)),s("div",us,[s("div",ps,"-â‚¹"+o((b=Math.abs(l.totalLoss))==null?void 0:b.toLocaleString()),1),t[24]||(t[24]=s("div",{class:"pnl-label"},"Total Loss",-1)),s("div",ms,o(l.lossTrades.length)+" trades",1)])]),s("div",{class:c(["pnl-card",l.overallPnL>=0?"profit":"loss"])},[t[27]||(t[27]=s("div",{class:"pnl-icon"},[s("i",{class:"fas fa-balance-scale"})],-1)),s("div",vs,[s("div",hs,o(l.overallPnL>=0?"+":"")+"â‚¹"+o((S=l.overallPnL)==null?void 0:S.toLocaleString()),1),t[26]||(t[26]=s("div",{class:"pnl-label"},"Net P&L",-1)),s("div",fs,o(l.closedTrades.length)+" total trades",1)])],2)]),r.showDetailedAnalysis?(n(),i("div",ys,[s("div",_s,[s("div",gs,[t[28]||(t[28]=s("span",{class:"analysis-label"},"Total Invested:",-1)),s("span",bs,"â‚¹"+o((k=l.totalInvested)==null?void 0:k.toLocaleString()),1)]),s("div",Ss,[t[29]||(t[29]=s("span",{class:"analysis-label"},"Total Return:",-1)),s("span",ks,"â‚¹"+o((L=l.totalReturn)==null?void 0:L.toLocaleString()),1)]),s("div",Ls,[t[30]||(t[30]=s("span",{class:"analysis-label"},"Win Rate:",-1)),s("span",ws,o(l.winRate)+"%",1)]),s("div",Cs,[t[31]||(t[31]=s("span",{class:"analysis-label"},"Avg Profit per Trade:",-1)),s("span",Fs,"â‚¹"+o((w=l.avgProfitPerTrade)==null?void 0:w.toLocaleString()),1)])])])):d("",!0)])):d("",!0),s("div",Ts,[l.filteredOrders.length===0&&!r.loading?(n(),i("div",Os,t[32]||(t[32]=[s("div",{class:"empty-icon"},[s("i",{class:"fas fa-inbox"})],-1),s("h3",{class:"empty-title"},"No orders found",-1),s("p",{class:"empty-subtitle"}," You haven't placed any orders yet ",-1)]))):d("",!0),r.loading?(n(),i("div",Es,t[33]||(t[33]=[s("div",{class:"loading-spinner"},[s("i",{class:"fas fa-spinner fa-spin"})],-1),s("p",null,"Loading your orders...",-1)]))):d("",!0),l.filteredOrders.length>0?(n(),i("div",Ps,[(n(!0),i(T,null,O(l.filteredOrders,e=>{var h;return n(),i("div",{key:e.id,class:c(["order-card",[e.type.toLowerCase(),e.status.toLowerCase(),{profit:e.pnl>0,loss:e.pnl<0}]])},[s("div",Is,[s("div",xs,[s("div",Ds,[s("h3",As,o(e.symbol),1),s("span",Ns,o(e.exchange),1)]),s("div",{class:c(["order-type-badge",e.type.toLowerCase()])},o(e.type),3)]),s("div",Rs,[s("div",{class:c(["status-badge",e.status.toLowerCase()])},[s("i",{class:c(l.getStatusIcon(e.status))},null,2),p(" "+o(e.status),1)],2),s("div",Ms,o(l.formatTime(e.timestamp)),1)])]),s("div",Us,[s("div",Vs,[s("div",qs,[t[34]||(t[34]=s("span",{class:"detail-label"},"Quantity",-1)),s("span",Bs,o(e.quantity),1)]),s("div",Ys,[t[35]||(t[35]=s("span",{class:"detail-label"},"Strike Price",-1)),s("span",Ws,"â‚¹"+o(e.price.toFixed(2)),1)]),s("div",Xs,[t[36]||(t[36]=s("span",{class:"detail-label"},"Total Amount",-1)),s("span",zs,"â‚¹"+o(((h=e.totalAmount)==null?void 0:h.toFixed(2))||(e.quantity*e.price).toFixed(2)),1)])]),e.optionType?(n(),i("div",Gs,[s("div",Hs,[t[37]||(t[37]=s("span",{class:"detail-label"},"Option Type",-1)),s("span",{class:c(["detail-value option-type",e.optionType.toLowerCase()])},[s("i",{class:c(e.optionType==="CALL"?"fas fa-arrow-up":"fas fa-arrow-down")},null,2),p(" "+o(e.optionType),1)],2)])])):d("",!0),e.status==="EXECUTED"||e.status==="CLOSED"?(n(),i("div",Qs,[e.executedPrice&&e.status==="CLOSED"?(n(),i("div",js,[t[38]||(t[38]=s("span",{class:"detail-label"},"Exit Price",-1)),s("span",Js,"â‚¹"+o(e.executedPrice.toFixed(2)),1)])):d("",!0),e.pnl!==null&&e.pnl!==void 0&&e.status==="CLOSED"?(n(),i("div",Ks,[t[39]||(t[39]=s("span",{class:"detail-label"},"P&L",-1)),s("span",{class:c(["detail-value",{profit:e.pnl>0,loss:e.pnl<0}])},o(e.pnl>0?"+":"")+"â‚¹"+o(e.pnl.toFixed(2)),3)])):d("",!0),e.executedAt&&e.status==="CLOSED"?(n(),i("div",Zs,[t[40]||(t[40]=s("span",{class:"detail-label"},"Closed At",-1)),s("span",$s,o(l.formatTime(e.executedAt)),1)])):d("",!0)])):d("",!0)])],2)}),128))])):d("",!0)]),F(P,{modelValue:r.showPlaceOrderModal,"onUpdate:modelValue":t[11]||(t[11]=e=>r.showPlaceOrderModal=e),title:"Place Order",centered:"",size:"lg","hide-footer":"","modal-class":"place-order-modal"},{default:A(()=>[s("div",st,[s("div",tt,[s("div",et,[t[42]||(t[42]=s("label",{class:"form-label"},"Select Stock",-1)),s("div",lt,[t[41]||(t[41]=s("i",{class:"fas fa-search search-icon"},null,-1)),m(s("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>r.orderForm.stockSearch=e),placeholder:"Search stock symbol or name...",class:"stock-search-input",onInput:t[3]||(t[3]=(...e)=>l.searchStocks&&l.searchStocks(...e))},null,544),[[f,r.orderForm.stockSearch]])]),r.stockSearchResults.length>0?(n(),i("div",at,[(n(!0),i(T,null,O(r.stockSearchResults,e=>(n(),i("div",{key:e.symbol,class:"search-result-item",onClick:h=>l.selectStock(e)},[s("div",rt,[s("div",it,o(e.symbol),1),s("div",nt,o(e.name),1)]),s("div",dt,"â‚¹"+o(e.price.toFixed(2)),1)],8,ot))),128))])):d("",!0)]),s("div",ct,[s("div",ut,[t[45]||(t[45]=s("label",{class:"form-label"},"Order Type",-1)),s("div",pt,[s("label",mt,[m(s("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=e=>r.orderForm.type=e),value:"BUY"},null,512),[[E,r.orderForm.type]]),t[43]||(t[43]=s("span",{class:"radio-label buy"},"BUY",-1))]),s("label",vt,[m(s("input",{type:"radio","onUpdate:modelValue":t[5]||(t[5]=e=>r.orderForm.type=e),value:"SELL"},null,512),[[E,r.orderForm.type]]),t[44]||(t[44]=s("span",{class:"radio-label sell"},"SELL",-1))])])]),s("div",ht,[t[47]||(t[47]=s("label",{class:"form-label"},"Product Type",-1)),m(s("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>r.orderForm.product=e),class:"form-select"},t[46]||(t[46]=[s("option",{value:"CNC"},"CNC (Cash & Carry)",-1),s("option",{value:"MIS"},"MIS (Intraday)",-1),s("option",{value:"NRML"},"NRML (Normal)",-1)]),512),[[N,r.orderForm.product]])])]),s("div",ft,[s("div",yt,[t[48]||(t[48]=s("label",{class:"form-label"},"Quantity",-1)),m(s("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=e=>r.orderForm.quantity=e),placeholder:"Enter quantity",class:"form-input",min:"1"},null,512),[[f,r.orderForm.quantity]])]),s("div",_t,[t[49]||(t[49]=s("label",{class:"form-label"},"Price",-1)),m(s("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=e=>r.orderForm.price=e),placeholder:"Enter price",class:"form-input",step:"0.01"},null,512),[[f,r.orderForm.price]])])]),s("div",gt,[s("div",bt,[t[50]||(t[50]=s("span",{class:"summary-label"},"Order Value:",-1)),s("span",St,"â‚¹"+o(l.orderValue.toFixed(2)),1)]),t[52]||(t[52]=s("div",{class:"summary-row"},[s("span",{class:"summary-label"},"Brokerage (â‚¹20):"),s("span",{class:"summary-value"},"â‚¹20.00")],-1)),s("div",kt,[t[51]||(t[51]=s("span",{class:"summary-label"},"Total Amount:",-1)),s("span",Lt,"â‚¹"+o((l.orderValue+20).toFixed(2)),1)])])]),s("div",wt,[s("button",{class:"btn-cancel",onClick:t[9]||(t[9]=(...e)=>l.closeOrderModal&&l.closeOrderModal(...e))},t[53]||(t[53]=[s("i",{class:"fas fa-times"},null,-1),p(" Cancel ")])),s("button",{class:"btn-place-order",onClick:t[10]||(t[10]=(...e)=>l.placeOrder&&l.placeOrder(...e)),disabled:!l.canPlaceOrder},t[54]||(t[54]=[s("i",{class:"fas fa-check"},null,-1),p(" Place Order ")]),8,Ct)])])]),_:1},8,["modelValue"]),F(I)])}const Ot=x(M,[["render",Ft],["__scopeId","data-v-15f42a4e"]]);export{Ot as default};
