import{_ as z,f as u,D as p,E as O,L as G,g as V,c as o,o as i,a as H,b as t,l as A,h as d,n as v,t as l,F as J,r as K,q as Q,i as j,s as N}from"./app-DIwzAcZV.js";const X={class:"withdrawal-request-screen"},Y={class:"stats-grid"},Z={class:"stat-content"},tt={class:"stat-number"},et={class:"stat-content"},st={class:"stat-number"},at={class:"stat-content"},lt={class:"stat-number"},nt={class:"stat-content"},ot={class:"stat-number"},it={class:"stat-card amount"},dt={class:"stat-content"},rt={class:"stat-number"},ut={class:"requests-container"},ct={key:0,class:"no-requests"},vt={key:1,class:"requests-grid"},pt={class:"request-header"},mt={class:"user-info"},_t={class:"user-avatar"},bt=["src","alt"],ft={class:"user-details"},gt={class:"user-name"},kt={class:"user-email"},jt={class:"user-phone"},ht={class:"status-badge"},wt={class:"request-details"},Rt={class:"detail-row"},yt={class:"detail-value amount"},Ct={class:"detail-row"},qt={class:"detail-value"},Pt={key:0,class:"detail-row"},Vt={class:"detail-value bank-details"},At={key:1,class:"detail-row"},Nt={class:"detail-value"},xt={key:2,class:"detail-row"},$t={class:"detail-value reject-reason"},Dt={key:3,class:"detail-row"},Ft={class:"detail-value"},Lt={class:"request-actions"},St=["onClick"],Et=["onClick"],Bt={key:2,class:"btn-action btn-lock",disabled:""},It={class:"status-timeline"},Mt={class:"timeline-content"},Tt={class:"timeline-date"},Wt={class:"timeline-icon"},Ut={class:"timeline-content"},zt={class:"timeline-status"},Ot={key:0,class:"timeline-date"},Gt={class:"request-actions mt-3 d-flex justify-content-end"},Ht={key:0,class:"pagination"},Jt=["disabled"],Kt=["disabled"],Qt={key:1,class:"loading-indicator"},Xt={__name:"WithdrawalRequest",setup(Yt){const n=u("all"),c=u([]),h=u(!1),r=u(1),R=u(10),y=u(0),_=u(!1),m=u(""),w=u(null),x=p(()=>c.value.length),$=p(()=>c.value.filter(a=>a.status==="pending").length),D=p(()=>c.value.filter(a=>a.status==="approved").length),F=p(()=>c.value.filter(a=>a.status==="rejected").length),L=p(()=>c.value.filter(a=>a.status==="approved").reduce((a,e)=>a+parseFloat(e.amount||0),0)),C=p(()=>n.value==="all"?c.value:c.value.filter(a=>a.status===n.value)),g=p(()=>Math.ceil(y.value/R.value)),b=async()=>{try{h.value=!0;const a=await N.get("/withdrawal-request",{params:{page:r.value,perPage:R.value,status:n.value==="all"?null:n.value}});c.value=a.data.data,y.value=a.data.total}catch(a){console.error("Error fetching requests:",a),alert("Failed to load withdrawal requests")}finally{h.value=!1}},q=async(a,e)=>{try{const f=e==="rejected"?{reject_reason:m.value}:{};await N.patch(`/withdrawal-request/${a}/status`,{status:e,...f}),await b(),e==="rejected"&&(_.value=!1,m.value="",w.value=null),alert(`Request has been ${e} successfully!`)}catch(f){console.error("Error updating request status:",f),alert("Failed to update request status")}},S=a=>{w.value=a,m.value="",_.value=!0},E=()=>{if(!m.value.trim()){alert("Please enter a rejection reason");return}q(w.value,"rejected")},P=a=>({pending:"status-pending",approved:"status-approved",rejected:"status-rejected"})[a]||"status-pending",B=a=>({pending:"Pending",approved:"Approved",rejected:"Rejected"})[a]||"Pending",k=a=>a?new Date(a).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",I=a=>a?parseFloat(a).toLocaleString("en-IN"):"0",M=()=>{r.value<g.value&&(r.value++,b())},T=()=>{r.value>1&&(r.value--,b())};return O(b),G(n,(a,e)=>{a!==e&&(r.value=1,b())}),(a,e)=>{const f=V("b-form-textarea"),W=V("b-modal");return i(),o("div",X,[e[33]||(e[33]=H('<div class="page-header" data-v-590b897a><div class="header-content" data-v-590b897a><h1 class="page-title" data-v-590b897a>ðŸ’³ Withdrawal Request</h1><p class="page-subtitle" data-v-590b897a>Manage and process withdrawal requests from users</p></div><div class="header-actions" data-v-590b897a></div></div>',1)),t("div",Y,[t("div",{class:v(["stat-card total clickable",{active:n.value==="all"}]),onClick:e[0]||(e[0]=s=>n.value="all")},[e[8]||(e[8]=t("div",{class:"stat-icon"},"ðŸ“Š",-1)),t("div",Z,[t("div",tt,l(x.value||0),1),e[7]||(e[7]=t("div",{class:"stat-label"},"Total Requests",-1))])],2),t("div",{class:v(["stat-card pending clickable",{active:n.value==="pending"}]),onClick:e[1]||(e[1]=s=>n.value="pending")},[e[10]||(e[10]=t("div",{class:"stat-icon"},"â³",-1)),t("div",et,[t("div",st,l($.value||0),1),e[9]||(e[9]=t("div",{class:"stat-label"},"Pending",-1))])],2),t("div",{class:v(["stat-card approved clickable",{active:n.value==="approved"}]),onClick:e[2]||(e[2]=s=>n.value="approved")},[e[12]||(e[12]=t("div",{class:"stat-icon"},"âœ…",-1)),t("div",at,[t("div",lt,l(D.value||0),1),e[11]||(e[11]=t("div",{class:"stat-label"},"Approved",-1))])],2),t("div",{class:v(["stat-card rejected clickable",{active:n.value==="rejected"}]),onClick:e[3]||(e[3]=s=>n.value="rejected")},[e[14]||(e[14]=t("div",{class:"stat-icon"},"âŒ",-1)),t("div",nt,[t("div",ot,l(F.value||0),1),e[13]||(e[13]=t("div",{class:"stat-label"},"Rejected",-1))])],2),t("div",it,[e[16]||(e[16]=t("div",{class:"stat-icon"},"ðŸ’°",-1)),t("div",dt,[t("div",rt,"â‚¹"+l(I(L.value)),1),e[15]||(e[15]=t("div",{class:"stat-label"},"Total Amount",-1))])])]),t("div",ut,[C.value.length===0?(i(),o("div",ct,[e[17]||(e[17]=t("div",{class:"no-requests-icon"},"ðŸ“­",-1)),t("h3",null,"No "+l(n.value==="all"?"":n.value)+" requests found",1),e[18]||(e[18]=t("p",null,"No withdrawal requests available at the moment",-1))])):(i(),o("div",vt,[(i(!0),o(J,null,K(C.value,s=>(i(),o("div",{key:s.id,class:v(["request-card",P(s.status)])},[t("div",pt,[t("div",mt,[t("div",_t,[t("img",{src:s.requester.profile_image||"../assest/img/tableprofileimg.png",alt:s.requester.name},null,8,bt)]),t("div",ft,[t("h4",gt,l(s.requester.name),1),t("p",kt,l(s.requester.email),1),t("p",jt,l(s.requester.mobile_code)+" "+l(s.requester.phone),1)])]),t("div",{class:v(["request-status",P(s.status)])},[t("span",ht,l(B(s.status)),1)],2)]),t("div",wt,[t("div",Rt,[e[19]||(e[19]=t("span",{class:"detail-label"},"Amount:",-1)),t("span",yt,"â‚¹"+l(parseFloat(s.amount).toLocaleString()),1)]),t("div",Ct,[e[20]||(e[20]=t("span",{class:"detail-label"},"Requested:",-1)),t("span",qt,l(k(s.created_at)),1)]),s.requester.bank_name?(i(),o("div",Pt,[e[21]||(e[21]=t("span",{class:"detail-label"},"Bank Details:",-1)),t("span",Vt,l(s.requester.bank_name)+" - "+l(s.requester.account_no)+" - "+l(s.requester.ifsc_code),1)])):d("",!0),s.description?(i(),o("div",At,[e[22]||(e[22]=t("span",{class:"detail-label"},"Reason:",-1)),t("span",Nt,l(s.description),1)])):d("",!0),s.reject_reason?(i(),o("div",xt,[e[23]||(e[23]=t("span",{class:"detail-label"},"Rejection Reason:",-1)),t("span",$t,l(s.reject_reason),1)])):d("",!0),s.approve_date?(i(),o("div",Dt,[e[24]||(e[24]=t("span",{class:"detail-label"},"Processed On:",-1)),t("span",Ft,l(k(s.approve_date)),1)])):d("",!0)]),t("div",Lt,[s.status==="pending"?(i(),o("button",{key:0,class:"btn-action btn-approve",onClick:U=>q(s.id,"approved")},e[25]||(e[25]=[t("i",{class:"fa-solid fa-check"},null,-1),j(" Approve ")]),8,St)):d("",!0),s.status==="pending"?(i(),o("button",{key:1,class:"btn-action btn-reject",onClick:U=>S(s.id)},e[26]||(e[26]=[t("i",{class:"fa-solid fa-times"},null,-1),j(" Reject ")]),8,Et)):d("",!0),s.status!=="pending"?(i(),o("button",Bt,[e[27]||(e[27]=t("i",{class:"fa-solid fa-lock"},null,-1)),j(" "+l(s.status==="approved"?"Approved":"Rejected"),1)])):d("",!0)]),t("div",It,[t("div",{class:v(["timeline-item",{active:["pending","approved","rejected"].includes(s.status)}])},[e[29]||(e[29]=t("div",{class:"timeline-icon"},"ðŸ“",-1)),t("div",Mt,[e[28]||(e[28]=t("span",{class:"timeline-status"},"Request Submitted",-1)),t("span",Tt,l(k(s.created_at)),1)])],2),t("div",{class:v(["timeline-item",{active:["approved","rejected"].includes(s.status)}])},[t("div",Wt,l(s.status==="approved"?"âœ…":"âŒ"),1),t("div",Ut,[t("span",zt,l(s.status==="approved"?"Approved":"Rejected"),1),s.approve_date?(i(),o("span",Ot,l(k(s.approve_date)),1)):d("",!0)])],2)])],2))),128))]))]),A(W,{modelValue:_.value,"onUpdate:modelValue":e[6]||(e[6]=s=>_.value=s),title:"Reject Request","hide-footer":""},{default:Q(()=>[t("div",null,[A(f,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=s=>m.value=s),placeholder:"Enter rejection reason",rows:"4",class:"w-100"},null,8,["modelValue"]),t("div",Gt,[t("button",{onClick:E,class:"btn-action btn-approve me-2"}," Confirm "),t("button",{onClick:e[5]||(e[5]=s=>_.value=!1),class:"btn-action btn-reject"}," Cancel ")])])]),_:1},8,["modelValue"]),g.value>1?(i(),o("div",Ht,[t("button",{onClick:T,disabled:r.value===1},e[30]||(e[30]=[t("i",{class:"fa-solid fa-chevron-left"},null,-1)]),8,Jt),t("span",null,"Page "+l(r.value)+" of "+l(g.value),1),t("button",{onClick:M,disabled:r.value===g.value},e[31]||(e[31]=[t("i",{class:"fa-solid fa-chevron-right"},null,-1)]),8,Kt)])):d("",!0),h.value?(i(),o("div",Qt,e[32]||(e[32]=[t("i",{class:"fa-solid fa-spinner fa-spin"},null,-1),j(" Loading requests... ")]))):d("",!0)])}}},te=z(Xt,[["__scopeId","data-v-590b897a"]]);export{te as default};
