import{r as A,J as G,a as p,c as f,o as d,b as e,e as g,A as D,k as a,f as o,P as L,t as n,O as y,i as s,n as P,d as $,l as w,_ as z,a4 as J,a5 as W,a6 as Q,a7 as Z,a8 as j,a0 as K,a1 as X,$ as Y,F as R,x as H,w as ee,S as te}from"./app-bFpPY_8Q.js";/* empty css                   */import{C as c}from"./vue-select.es-D7GWzju7.js";import{f as le,d as se,C as q}from"./Close-C2a9f5Yu.js";import{M as ie,a as ae}from"./Maximize-BYQCjNYh.js";const oe="/build/assets/no_ticket-Bp-Oei_O.svg",re={class:"listing_screen"},ne={class:"title_line_screen px-4 py-2"},de={class:"title_line_left"},ue={class:"table_img_cell"},pe={key:2,class:"titlelineicon"},me={class:"title_line_right"},be={class:"mt-4 px-4"},ve={key:0,class:"table_listing"},fe={key:0,class:"badgehigh"},_e={key:1,class:"badgemedium"},ge={key:2,class:"badgelow"},ce={class:"table_img_cell"},ye={class:"grid_table_action"},ke={key:1,class:"table_grid_view"},we={class:"table_grid_list"},he={class:"table_grid_list_item border_warnning"},Ce={class:"table_grid_title"},Me={class:"table_grid_title_right"},Te={class:"table_grid_action"},De={class:"table_grid_list_item border_hot"},Se={class:"table_grid_title"},Ne={class:"table_grid_title_right"},Ae={class:"table_grid_action"},xe={key:1,class:"No_data_available"},Ve={key:0,class:"backdrop_shadow"},Fe={class:"sidebar_toolbox"},Be={class:"sidebar_toolbox_right_side"},Oe={class:"sidebar_form"},Ee={class:"px-4 py-3 column_sidebar"},Ie={class:"sidebarbtn_group"},Pe={class:"sidebar_toolbox"},qe={class:"sidebar_toolbox_right_side"},Le={class:"sidebar_form"},Re={class:"px-4 py-3 column_sidebar"},He={class:"px-4 py-3 column_sidebar"},Ue={class:"sidebarbtn_group"},Ge={class:"sidebar_toolbox"},$e={class:"sidebar_toolbox_right_side"},ze={__name:"Ticket",setup(u){const l=A({tablefield:[{key:"select",label:""},{key:"ticket_id",label:"Ticket ID"},{key:"ticket_name",label:"Ticket Name",sortable:!0},{key:"priority",label:"Priority"},{key:"ticket_type",label:"Ticket Type"},{key:"requester",label:"Client"},{key:"created_at",label:"Request Date"},{key:"actions",label:""}],tabledata:[],tableGridStatus:!0,loader:!0,currentPage:1,perPage:10,sortBy:"",sortDesc:!1,filterData:{ticket_id:"",ticket_name:"",ticket_type:"",priority:""},customerid:"MTE2"}),k=A({filterSelectField:[{profile_name:"Prashant",profile_image:"tableprofileimg.png"},{profile_name:"Ritesh",profile_image:"tableprofileimg.png"},{profile_name:"Vishal",profile_image:"tableprofileimg.png"}]}),r=A({shadow:!1,filter:!1,add:!1,view:!1}),m=A({FormMaxMinStatus:!0});(()=>{w.get("/tickets",{params:{page:l.value.currentPage,perPage:l.value.perPage,sortBy:l.value.sortBy,sortDesc:l.value.sortDesc,...l.value.filterData,customer:l.value.customerid}}).then(b=>{l.value.tabledata=b.data.data.data,l.value.loader=!1}).catch(b=>{console.log(b)})})();const S=b=>{b.target.nextSibling.classList.toggle("active_table_dropdown")};return G(r.value,async(b,t)=>{b.filter||b.add||b.view?r.value.shadow=!0:r.value.shadow=!1}),(b,t)=>{const h=p("b-button"),x=p("b-form-checkbox"),C=p("b-link"),E=p("b-table"),V=p("b-overlay"),F=p("b-form-input"),v=p("b-form-group"),M=p("b-form-radio"),N=p("b-form-textarea"),B=p("b-form"),O=p("b-col"),I=p("b-row");return d(),f("div",re,[e("div",ne,[e("div",de,[t[23]||(t[23]=e("h5",null,"Tickets",-1)),l.value.tabledata.length?(d(),D(y(c),{key:0,options:k.value.filterSelectField,label:"profile_name",class:"v_select_profile"},{option:a(({profile_name:i,profile_image:T})=>[e("span",ue,[t[20]||(t[20]=e("span",{class:"table_img"},[e("img",{src:L,alt:"profile"})],-1)),o(" "+n(i),1)])]),_:1},8,["options"])):g("",!0),l.value.tabledata.length?(d(),f("span",{key:1,class:"titlelineicon",onClick:t[0]||(t[0]=i=>r.value.filter=!r.value.filter)},[s(le),t[21]||(t[21]=o(" Filters "))])):g("",!0),l.value.tabledata.length?(d(),f("span",pe,[s(se),t[22]||(t[22]=o(" Delete "))])):g("",!0)]),e("div",me,[l.value.tabledata.length&&l.value.tableGridStatus?(d(),f("i",{key:0,class:"fa-regular fa-rectangle-list",onClick:t[1]||(t[1]=i=>l.value.tableGridStatus=!l.value.tableGridStatus)})):g("",!0),l.value.tabledata.length&&!l.value.tableGridStatus?(d(),f("i",{key:1,class:"fa-solid fa-table-cells",onClick:t[2]||(t[2]=i=>l.value.tableGridStatus=!l.value.tableGridStatus)})):g("",!0),s(h,{class:"btn_primary",onClick:t[3]||(t[3]=i=>r.value.add=!r.value.add)},{default:a(()=>t[24]||(t[24]=[o("Add Ticket")])),_:1})])]),e("div",be,[s(V,{show:l.value.loader,rounded:"lg",opacity:"0.8",class:"loader_section","no-wrap":""},{overlay:a(()=>t[25]||(t[25]=[e("span",{class:"loadersdots"},null,-1)])),default:a(()=>[l.value.tabledata.length?(d(),f("div",ve,[l.value.tableGridStatus?(d(),D(E,{key:0,items:l.value.tabledata,fields:l.value.tablefield},{"head(select)":a(i=>[s(x,null,{default:a(()=>t[26]||(t[26]=[o("All")])),_:1})]),"cell(select)":a(i=>[s(x)]),"cell(priority)":a(i=>[i.value=="High"?(d(),f("span",fe,n(i.value),1)):g("",!0),i.value=="Medium"?(d(),f("span",_e,n(i.value),1)):g("",!0),i.value=="Low"?(d(),f("span",ge,n(i.value),1)):g("",!0)]),"cell(ticket_id)":a(i=>[s(C,{onClick:t[4]||(t[4]=T=>r.value.view=!r.value.view)},{default:a(()=>[o(n(i.value),1)]),_:2},1024)]),"cell(requester)":a(i=>[e("span",ce,[t[27]||(t[27]=e("span",{class:"table_img"},[e("img",{src:L,alt:"profile"})],-1)),o(n(i.value),1)])]),"cell(actions)":a(i=>[e("div",ye,[e("i",{class:"fa-solid fa-ellipsis",onClick:t[5]||(t[5]=T=>S(T))}),t[28]||(t[28]=e("div",{class:"table_action_dropdown"},[e("ul",null,[e("li",null,"Edit"),e("li",null,"Make Copy"),e("li",null,"Merge Ticket"),e("li",null,"Close"),e("li",null,"Delete")])],-1))])]),_:1},8,["items","fields"])):(d(),f("div",ke,[e("div",we,[e("div",he,[e("div",Ce,[t[31]||(t[31]=e("span",{class:"table_grid_label"},"#TC-190",-1)),e("span",Me,[t[30]||(t[30]=e("p",null,[e("span",null,"Request Date:"),o(" 10/10/2024")],-1)),e("div",Te,[e("i",{class:"fa-solid fa-ellipsis",onClick:t[6]||(t[6]=i=>S(i))}),t[29]||(t[29]=e("div",{class:"table_action_dropdown"},[e("ul",null,[e("li",null,"Edit"),e("li",null,"Make Copy"),e("li",null,"Merge Ticket"),e("li",null,"Close"),e("li",null,"Delete")])],-1))])])]),t[32]||(t[32]=e("div",{class:"table_grid_item_details"},[e("h4",null,"ABC Corp"),e("p",null,"Our client ABC Corp is experiencing issues with their website taking too long to load. Please investigate the issue and provide a solution."),e("span",{class:"table_grid_sub_label"},"Type"),e("p",null,"Dummy type")],-1))]),e("div",De,[e("div",Se,[t[35]||(t[35]=e("span",{class:"table_grid_label"},"#TC-190",-1)),e("span",Ne,[t[34]||(t[34]=e("p",null,[e("span",null,"Request Date:"),o(" 10/10/2024")],-1)),e("div",Ae,[e("i",{class:"fa-solid fa-ellipsis",onClick:t[7]||(t[7]=i=>S(i))}),t[33]||(t[33]=e("div",{class:"table_action_dropdown"},[e("ul",null,[e("li",null,"Edit"),e("li",null,"Make Copy"),e("li",null,"Merge Ticket"),e("li",null,"Close"),e("li",null,"Delete")])],-1))])])]),t[36]||(t[36]=e("div",{class:"table_grid_item_details"},[e("h4",null,"ABC Corp"),e("p",null,"Our client ABC Corp is experiencing issues with their website taking too long to load. Please investigate the issue and provide a solution."),e("span",{class:"table_grid_sub_label"},"Type"),e("p",null,"Dummy type")],-1))])])]))])):(d(),f("div",xe,t[37]||(t[37]=[e("div",null,[e("img",{src:oe,alt:"no_ticket"}),e("p",null,"No Tickets Found"),e("span",null,"No tickets added."),e("span",null,[o("Click "),e("b",null,"'add ticket'"),o(" to start!")])],-1)])))]),_:1},8,["show"])]),r.value.shadow?(d(),f("div",Ve)):g("",!0),e("div",{class:P(["filter_sidebar sidebar_main",[r.value.filter?"filter_active":""]])},[e("div",Fe,[t[38]||(t[38]=e("h6",null,"Filter Ticket",-1)),e("div",Be,[s(C,{onClick:t[8]||(t[8]=i=>r.value.filter=!r.value.filter)},{default:a(()=>[s(q)]),_:1})])]),e("div",Oe,[s(B,null,{default:a(()=>[e("div",Ee,[t[44]||(t[44]=e("label",{for:"ticket-name"},[o("Ticket Name "),e("span",null,"*")],-1)),s(v,{"label-for":"ticket-name"},{default:a(()=>[s(F),t[39]||(t[39]=e("small",{class:"text-danger"},null,-1)),t[40]||(t[40]=e("div",{class:"text-danger"},null,-1))]),_:1}),t[45]||(t[45]=e("label",{for:"priority"},[o("Priority"),e("span",null," *")],-1)),s(v,{"label-for":"priority",class:"radio_group"},{default:a(()=>[s(M,{name:"radio_priority",modelValue:b.prioritystatus,"onUpdate:modelValue":t[9]||(t[9]=i=>b.prioritystatus=i),button:"","button-variant":"outline_high",class:"radio_btn"},{default:a(()=>t[41]||(t[41]=[e("span",null,null,-1),o(" High")])),_:1},8,["modelValue"]),s(M,{name:"radio_priority",modelValue:b.prioritystatus,"onUpdate:modelValue":t[10]||(t[10]=i=>b.prioritystatus=i),button:"","button-variant":"outline_medium",class:"radio_btn"},{default:a(()=>t[42]||(t[42]=[e("span",null,null,-1),o(" Medium")])),_:1},8,["modelValue"]),s(M,{name:"radio_priority",modelValue:b.prioritystatus,"onUpdate:modelValue":t[11]||(t[11]=i=>b.prioritystatus=i),button:"","button-variant":"outline_low",class:"radio_btn"},{default:a(()=>t[43]||(t[43]=[e("span",null,null,-1),o(" Low")])),_:1},8,["modelValue"])]),_:1}),t[46]||(t[46]=e("label",{for:"ticket-type"},[o("Ticket Type "),e("span",null," *")],-1)),s(v,{"label-for":"ticket-type"},{default:a(()=>[s(y(c),{label:"title",value:"id",id:"ticket-type",placeholder:"Select ticket type"})]),_:1}),t[47]||(t[47]=e("label",{for:"requester"},[o("Requester/Client "),e("span",null," *")],-1)),s(v,{"label-for":"requester"},{default:a(()=>[s(y(c),{id:"requester",placeholder:"Select requester/client",label:"label",value:"value"})]),_:1}),t[48]||(t[48]=e("label",{for:"assignee"},[o("Assignee "),e("span",null," *")],-1)),s(v,{"label-for":"assignee"},{default:a(()=>[s(y(c),{id:"assignee",placeholder:"Select assignee"})]),_:1}),t[49]||(t[49]=e("label",{for:"Tags"},[o("Tags "),e("span",null," *")],-1)),s(v,{"label-for":"tags"},{default:a(()=>[s(y(c),{id:"tags",label:"title",value:"id",placeholder:"Select tag"})]),_:1}),t[50]||(t[50]=e("label",{for:"Followers"},"Followers",-1)),s(v,{"label-for":"followers"},{default:a(()=>[s(y(c),{id:"followers",multiple:"",placeholder:"Select followers"})]),_:1}),t[51]||(t[51]=e("label",{for:"messsage_from"},"Message From",-1)),s(v,{"label-for":"messsage_from"},{default:a(()=>[s(y(c),{id:"messsage_from",placeholder:"Select message from"})]),_:1}),t[52]||(t[52]=e("label",{for:"message"},"Message",-1)),s(v,{"label-for":"message"},{default:a(()=>[s(N,{id:"message",placeholder:"Enter your message here...",rows:"2"})]),_:1})]),e("div",Ie,[s(h,{type:"submit",class:"btn_primary me-2"},{default:a(()=>t[53]||(t[53]=[o("Apply")])),_:1}),s(h,{class:"btn_secondary_border",onClick:t[12]||(t[12]=i=>r.value.filter=!r.value.filter)},{default:a(()=>t[54]||(t[54]=[o("Cancel")])),_:1})])]),_:1})])],2),e("div",{class:P(["add_sidebar sidebar_main",[r.value.add?"add_active":"",m.value.FormMaxMinStatus?"":"extra_add_active"]])},[e("div",Pe,[t[55]||(t[55]=e("h6",null,"Create New Ticket",-1)),e("div",qe,[s(C,{class:"me-3",onClick:t[13]||(t[13]=i=>m.value.FormMaxMinStatus=!m.value.FormMaxMinStatus)},{default:a(()=>[m.value.FormMaxMinStatus?(d(),D(ie,{key:0})):(d(),D(ae,{key:1}))]),_:1}),s(C,{onClick:t[14]||(t[14]=i=>(r.value.add=!1,m.value.FormMaxMinStatus=!0))},{default:a(()=>[s(q)]),_:1})])]),e("div",Le,[s(B,null,{default:a(()=>[s(I,null,{default:a(()=>[m.value.FormMaxMinStatus?g("",!0):(d(),D(O,{key:0,md:"6",class:"border_right"},{default:a(()=>[e("div",Re,[t[56]||(t[56]=e("p",{class:"sidebar_small_heading"},"Message",-1)),t[57]||(t[57]=e("label",{for:"from"},[o("From "),e("span",null," *")],-1)),s(v,{"label-for":"from"},{default:a(()=>[s(y(c),{id:"from",label:"from",value:"id",placeholder:"Select"})]),_:1}),s(v,{"label-for":"Message"},{default:a(()=>[s(N,{placeholder:"Type your message",rows:"20"})]),_:1})])]),_:1})),s(O,{md:m.value.FormMaxMinStatus?12:6},{default:a(()=>[e("div",He,[t[63]||(t[63]=e("label",{for:"ticket-name"},[o("Ticket Name "),e("span",null,"*")],-1)),s(v,{"label-for":"ticket-name"},{default:a(()=>[s(F),t[58]||(t[58]=e("small",{class:"text-danger"},null,-1)),t[59]||(t[59]=e("div",{class:"text-danger"},null,-1))]),_:1}),t[64]||(t[64]=e("label",{for:"priority"},[o("Priority"),e("span",null," *")],-1)),s(v,{"label-for":"priority",class:"radio_group"},{default:a(()=>[s(M,{name:"radio_priority",modelValue:b.prioritystatus,"onUpdate:modelValue":t[15]||(t[15]=i=>b.prioritystatus=i),button:"","button-variant":"outline_high",class:"radio_btn"},{default:a(()=>t[60]||(t[60]=[e("span",null,null,-1),o(" High")])),_:1},8,["modelValue"]),s(M,{name:"radio_priority",modelValue:b.prioritystatus,"onUpdate:modelValue":t[16]||(t[16]=i=>b.prioritystatus=i),button:"","button-variant":"outline_medium",class:"radio_btn"},{default:a(()=>t[61]||(t[61]=[e("span",null,null,-1),o(" Medium")])),_:1},8,["modelValue"]),s(M,{name:"radio_priority",modelValue:b.prioritystatus,"onUpdate:modelValue":t[17]||(t[17]=i=>b.prioritystatus=i),button:"","button-variant":"outline_low",class:"radio_btn"},{default:a(()=>t[62]||(t[62]=[e("span",null,null,-1),o(" Low")])),_:1},8,["modelValue"])]),_:1}),t[65]||(t[65]=e("label",{for:"ticket-type"},[o("Ticket Type "),e("span",null," *")],-1)),s(v,{"label-for":"ticket-type"},{default:a(()=>[s(y(c),{label:"title",value:"id",id:"ticket-type",placeholder:"Select ticket type"})]),_:1}),t[66]||(t[66]=e("label",{for:"requester"},[o("Requester/Client "),e("span",null," *")],-1)),s(v,{"label-for":"requester"},{default:a(()=>[s(y(c),{id:"requester",placeholder:"Select requester/client",label:"label",value:"value"})]),_:1}),t[67]||(t[67]=e("label",{for:"assignee"},[o("Assignee "),e("span",null," *")],-1)),s(v,{"label-for":"assignee"},{default:a(()=>[s(y(c),{id:"assignee",placeholder:"Select assignee"})]),_:1}),t[68]||(t[68]=e("label",{for:"tags"},[o("Tags "),e("span",null," *")],-1)),s(v,{"label-for":"tags"},{default:a(()=>[s(y(c),{id:"tags",label:"title",value:"id",placeholder:"Select tag"})]),_:1}),t[69]||(t[69]=e("label",{for:"followers"},"Followers",-1)),s(v,{"label-for":"followers"},{default:a(()=>[s(y(c),{id:"followers",multiple:"",placeholder:"Select followers"})]),_:1}),t[70]||(t[70]=e("label",{for:"messsage_from"},"Message From",-1)),s(v,{"label-for":"messsage_from"},{default:a(()=>[s(y(c),{id:"messsage_from",placeholder:"Select message from"})]),_:1}),t[71]||(t[71]=e("label",{for:"message"},"Message",-1)),s(v,{"label-for":"message"},{default:a(()=>[s(N,{id:"message",placeholder:"Enter your message here...",rows:"2"})]),_:1})])]),_:1},8,["md"])]),_:1}),e("div",Ue,[s(h,{type:"submit",class:"btn_primary me-2"},{default:a(()=>t[72]||(t[72]=[o("Submit")])),_:1}),s(h,{class:"btn_secondary_border",onClick:t[18]||(t[18]=i=>r.value.add=!r.value.add)},{default:a(()=>t[73]||(t[73]=[o("Cancel")])),_:1})])]),_:1})])],2),e("div",{class:P(["view_sidebar sidebar_main",[r.value.view?"view_active":""]])},[e("div",Ge,[t[75]||(t[75]=e("h6",null,"Ticket Details",-1)),e("div",$e,[s(h,{class:"btn_primary me-3",to:"/ticket/view-ticket-details/"},{default:a(()=>t[74]||(t[74]=[o("View Details")])),_:1}),s(C,{onClick:t[19]||(t[19]=i=>r.value.view=!r.value.view)},{default:a(()=>[s(q)]),_:1})])]),t[76]||(t[76]=$('<div class="sidebar_view"><div class="px-4 py-2 border_bottom"><h4 class="my-3">#TC-190</h4><span class="view_label">Ticket Name</span><p class="view_value">Website Outage</p><div class="view_divide"><div class="view_divider_part"><div class="view_divider_part_item"><span class="view_label">Priority:</span><span class="view_status_badge status_medium">Medium</span></div><div class="view_divider_part_item"><span class="view_label">Requester/Client:</span><span>ABC Corp</span></div><div class="view_divider_part_item border-bottom-0"><span class="view_label">Tags:</span><span>Report, Task, Monthly</span></div></div><div class="view_divider_part"><div class="view_divider_part_item"><span class="view_label">Ticket Type:</span><span>Task</span></div><div class="view_divider_part_item"><span class="view_label">Assignee:</span><span>John Doe</span></div><div class="view_divider_part_item border-bottom-0"><span class="view_label">Followers:</span><span>Helen White</span></div></div></div><h4 class="mt-4">Message</h4><div class="view_sidebar_message"><span class="view_label">From</span><p>Technical Support Team</p><span class="view_label">Message</span><p>Our client ABC Corp is experiencing issues with their website taking too long to load. Please investigate the issue and provide a solution.</p></div></div><div class="px-4 py-2 border_bottom"><h4 class="my-3">Activities Logs</h4><div class="timeline_view grey_timeline"><ul><li><h5>Notify Client</h5><p>The website is now operational. Please check and confirm.</p><span>September 20, 2024, 10:50 AM</span></li><li><h5>Resolve Outage</h5><p>Identified and fixed the server issue. Website is back online.</p><span>September 20, 2024, 10:45 AM</span></li></ul></div></div><div class="px-4 py-2"><h4 class="my-3">Task</h4><div class="timeline_view grey_timeline"><ul><li><h5>Investigate Website Outage | IT Team</h5><p>Check server logs and monitoring tools to identify the cause of the website downtime.</p><span>September 20, 2024, 10:15 AM</span></li><li><h5>Resolve Server Issue | IT Team</h5><p>Fix the identified server configuration issue causing the website outage.</p><span>September 20, 2024, 10:15 AM</span></li></ul></div></div></div>',1))],2)])}}},Je={name:"UserDetailCard",components:{BCard:Y,BRow:X,BCol:K,BForm:j,BFormInput:Z,BFormGroup:Q,vSelect:c,BFormCheckbox:W,BLink:J,TicketEventHandler:ze},data(){return{errors:{},activities:[],isModalVisible:!1,oldActivity:{},newActivity:{},activitiesModal:[],showTicketHandler:!1,notes:[],newNote:{author:"",message:"",note_for:"customers",note_for_id:null},ticketTypeOptions:[],priorityOptions:[],tagOptions:[],assigneeOptions:[],requesterOptions:[],followerOptions:[],users:[],decodeBase64:l=>decodeURIComponent(escape(atob(l)))}},computed:{decodedCustomerId(){return this.$route.params.id?atob(this.$route.params.id):null}},created(){this.fetchNotes(),this.newNote.note_for_id=this.decodeBase64(this.$route.params.id)},watch:{"newNote.author":function(){this.RemoveError("author")}},mounted(){const u=this.$route.params.id;w.get(`/customer/${u}`).then(l=>{this.userData=l.data.data}).catch(()=>{this.error="Failed to load ticket type.",this.loading=!1}),w.get("/getallcustomer").then(l=>{this.users=l.data.alluser}),this.fetchActivityLogs(),w.get("/get-ticket-type").then(l=>{this.ticketTypeOptions=l.data.data,this.priorityOptions=l.data.priorityOptions}),w.get("/get-ticket-teg").then(l=>{this.tagOptions=l.data.data}),w.get("/alluser").then(l=>{this.assigneeOptions=l.data.alluser,this.requesterOptions=l.data.alluser,this.followerOptions=l.data.alluser})},methods:{formatDatetime(u){const l=new Date(u),k={year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0};return new Intl.DateTimeFormat("en-GB",k).format(l).replace(",","")},fetchNotes(){const u=this.$route.params.id;w.get(`/notes/${u}`).then(l=>{this.notes=l.data.data}).catch(()=>{this.error="Failed to load notes.",this.loading=!1})},hasErrors(u){return u in this.errors},getErrors(u){return this.errors[u][0]},RemoveError(u){this.errors[u]=" "},resetNotes(){this.newNote.author="",this.newNote.message="",this.newNote.note_for="tickets",this.newNote.note_for_id=this.decodeBase64(this.$route.params.id)},addNote(){w.post("/notes",this.newNote).then(u=>{this.fetchNotes(),te.fire({title:"Note Added Successful!",icon:"success",timer:2e3,showConfirmButton:!1}),setTimeout(()=>{this.resetNotes()},2e3)}).catch(u=>{this.loading=!1,u.response.data.code==422&&(this.errors=u.response.data.errors)})},toggleTicketHandler(){this.showTicketHandler=!this.showTicketHandler},openModal(u,l){this.fetchModalActivity(u).then(()=>{if(Array.isArray(this.activitiesModal)&&this.activitiesModal.length>0){const k=l=="created"?this.activitiesModal[0]:this.activitiesModal.find(r=>r.id===u);if(k&&k.properties)try{const r=JSON.parse(k.properties);this.oldActivity=r.old?{description:r.old||"No description"}:{description:"No old data"},this.newActivity={description:r.attributes||"No description"},this.isModalVisible=!0}catch{}}}).catch(k=>{})},fetchModalActivity(){const u=this.$route.params.id;return w.get(`/getCustomerOldNewActivity/${u}`).then(l=>{l.data&&Array.isArray(l.data.data)&&(this.activitiesModal=l.data.data),this.loading=!1}).catch(l=>{console.error("Failed to load activity details:",l),this.loading=!1})},fetchActivityLogs(){const u=this.$route.params.id;w.get(`/customer-activities/${u}`).then(l=>{l&&l.data&&l.data.status==="success"&&(this.activities=(l.data.data||[]).map(k=>({...k}))),this.fetchNotes()}).catch(()=>{this.loading=!1,this.error="Failed to fetch activities."})},formatDate(u){const l=new Date(u),k=["January","February","March","April","May","June","July","August","September","October","November","December"],r=l.getDate(),m=l.getMonth();return k[m]+" "+r},fetchUserData(){console.log("Fetching user data...")}},setup(){return{userData:A({name:"",contactPerson:"",priority:"-",email:"",phone:"",orgName:"",assignedTo:"",addLine1:"",addLine2:"",state:"",city:"",country:"",zip:""})}}},We={class:"container mt-4"},Qe={class:"page__breadcrumb"},Ze={class:"list-unstyled"},je={class:"activity-logs-section"},Ke={key:0},Xe={key:1},Ye={key:2},et=["onClick"],tt={key:3},lt=["onClick"],st={key:0},it={class:"text-danger"},at={key:0,class:"text-danger"},ot={class:"text-danger"},rt={key:0,class:"text-danger"},nt={class:"notes-section mt-2"},dt={class:"d-flex align-items-center mb-2"},ut={class:"datetime"},pt={class:"text-muted datetime"};function mt(u,l,k,r,m,_){const S=p("b-link"),b=p("b-col"),t=p("b-tab"),h=p("feather-icon"),x=p("TicketEventHandler"),C=p("b-card"),E=p("v-select"),V=p("b-form-group"),F=p("b-form-textarea"),v=p("b-button"),M=p("b-form"),N=p("b-avatar"),B=p("b-tabs"),O=p("b-row"),I=p("b-modal");return d(),f("div",We,[s(C,{class:"p-3"},{default:a(()=>[e("div",Qe,[e("p",null,[s(S,{to:{name:"customer"}},{default:a(()=>l[6]||(l[6]=[o(" Customer "),e("i",{class:"fas fa-chevron-right"},null,-1)])),_:1}),l[7]||(l[7]=o(" View"))])]),s(O,null,{default:a(()=>[s(b,{md:"4"},{default:a(()=>[e("h5",null,n(r.userData.customer_id)+"- | "+n(r.userData.name),1),e("ul",Ze,[e("li",null,[l[8]||(l[8]=e("strong",null,"Contact Person:",-1)),o(" "+n(r.userData.name),1)]),e("li",null,[l[9]||(l[9]=e("strong",null,"Priority:",-1)),o(" "+n(r.userData.priority),1)]),e("li",null,[l[10]||(l[10]=e("strong",null,"Email:",-1)),o(" "+n(r.userData.email),1)]),e("li",null,[l[11]||(l[11]=e("strong",null,"Phone:",-1)),o(" "+n(r.userData.contactnumber),1)]),e("li",null,[l[12]||(l[12]=e("strong",null,"Org. Name:",-1)),o(n(r.userData.orgName??"Qtech Software"),1)]),e("li",null,[l[13]||(l[13]=e("strong",null,"Assigned To:",-1)),o(n(r.userData.assignee_name??"Admin"),1)]),e("li",null,[l[14]||(l[14]=e("strong",null,"Add Line 1:",-1)),o(" "+n(r.userData.engagement),1)]),e("li",null,[l[15]||(l[15]=e("strong",null,"Add Line 2:",-1)),o(" "+n(r.userData.addLine2??"Mumbai"),1)]),e("li",null,[l[16]||(l[16]=e("strong",null,"State:",-1)),o(" "+n(r.userData.state??"Mumbai"),1)]),e("li",null,[l[17]||(l[17]=e("strong",null,"City:",-1)),o(" "+n(r.userData.city??"Mumbai"),1)]),e("li",null,[l[18]||(l[18]=e("strong",null,"Country:",-1)),o(" "+n(r.userData.country??"India"),1)]),e("li",null,[l[19]||(l[19]=e("strong",null,"ZIP CODE:",-1)),o(" "+n(r.userData.zip??123455),1)])])]),_:1}),s(b,{md:"8"},{default:a(()=>[s(B,null,{default:a(()=>[s(t,{title:"Health"},{default:a(()=>l[20]||(l[20]=[e("p",null,"Health content here...",-1)])),_:1}),s(t,{title:"Product/Service"},{default:a(()=>l[21]||(l[21]=[e("p",null,"Product/Service content here...",-1)])),_:1}),s(t,{title:"Invoice"},{default:a(()=>l[22]||(l[22]=[e("p",null,"Invoice content here...",-1)])),_:1}),s(t,{onClick:_.toggleTicketHandler,title:"Ticket"},{default:a(()=>[e("h5",null,[s(h,{icon:"CalendarIcon",size:"14"})]),s(x,{customerid:this.$route.params.id,class:"ticket-event-handler",customerview:"customerview"},null,8,["customerid"])]),_:1},8,["onClick"]),s(t,{title:"Activity Logs",onClick:_.fetchActivityLogs},{default:a(()=>[e("div",je,[(d(!0),f(R,null,H(m.activities,(i,T)=>(d(),D(C,{key:T,class:"activity-log"},{default:a(()=>[e("p",null,[i.type==="ticket"?(d(),f("span",Ke,[l[23]||(l[23]=o(" Ticket added by ")),e("strong",null,n(i.created_by),1),o(" on "+n(_.formatDate(i.created_at)),1)])):g("",!0),i.type==="note"?(d(),f("span",Xe,[l[24]||(l[24]=o(" Note added by ")),e("strong",null,n(i.created_by),1),o(" with description "+n(i.note)+" on "+n(_.formatDate(i.created_at)),1)])):g("",!0),i.type==="customer_created"?(d(),f("span",Ye,[l[25]||(l[25]=o(" Customer created by ")),e("strong",null,n(i.created_by),1),o(" on "+n(_.formatDate(i.created_at))+". ",1),e("i",{class:"fas fa-eye ml-2",onClick:U=>_.openModal(i.id,i.event)},null,8,et)])):g("",!0),i.type==="customer_updated"?(d(),f("span",tt,[l[26]||(l[26]=o(" Customer updated by ")),e("strong",null,n(i.created_by),1),o(" on on "+n(_.formatDate(i.created_at))+". ",1),e("i",{class:"fas fa-eye ml-2",onClick:U=>_.openModal(i.id,i.event)},null,8,lt)])):g("",!0)])]),_:2},1024))),128)),m.activities.length===0?(d(),f("div",st,l[27]||(l[27]=[e("p",null,"No activities found for this ticket.",-1)]))):g("",!0)])]),_:1},8,["onClick"]),s(t,{onClick:_.fetchNotes},{title:a(()=>l[28]||(l[28]=[o(" Notes ")])),default:a(()=>[s(M,{onSubmit:ee(_.addNote,["prevent"]),class:"mt-4"},{default:a(()=>[s(V,{label:"From","label-for":"from-select"},{default:a(()=>[s(E,{id:"assignee",modelValue:m.newNote.author,"onUpdate:modelValue":l[0]||(l[0]=i=>m.newNote.author=i),options:m.users,reduce:i=>i.value,onChange:l[1]||(l[1]=i=>_.RemoveError("author"))},null,8,["modelValue","options","reduce"]),e("small",it,n(m.errors[0]),1),_.hasErrors("author")?(d(),f("div",at,n(_.getErrors("author")),1)):g("",!0)]),_:1}),s(V,null,{default:a(()=>[s(F,{modelValue:m.newNote.message,"onUpdate:modelValue":l[2]||(l[2]=i=>m.newNote.message=i),onInput:l[3]||(l[3]=i=>_.RemoveError("message")),placeholder:"Enter here...",rows:"3"},null,8,["modelValue"]),e("small",ot,n(m.errors[0]),1),_.hasErrors("message")?(d(),f("div",rt,n(_.getErrors("message")),1)):g("",!0)]),_:1}),s(v,{type:"submit",variant:"primary"},{default:a(()=>l[29]||(l[29]=[o("Submit")])),_:1})]),_:1},8,["onSubmit"]),e("div",nt,[(d(!0),f(R,null,H(m.notes,(i,T)=>(d(),f("div",{class:"note",key:T},[e("div",dt,[s(N,{variant:i.avatarVariant},{default:a(()=>[o(n(i.initials),1)]),_:2},1032,["variant"]),e("div",ut,[e("strong",null,n(i.author),1),e("small",pt,n(_.formatDatetime(i.added_at)),1)])]),e("div",null,[e("p",null,n(i.note),1)])]))),128))])]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),s(I,{modelValue:m.isModalVisible,"onUpdate:modelValue":l[5]||(l[5]=i=>m.isModalVisible=i),title:"Activity Details"},{"modal-footer":a(({ok:i})=>[s(v,{variant:"secondary",onClick:l[4]||(l[4]=T=>m.isModalVisible=!1)},{default:a(()=>l[32]||(l[32]=[o("Close")])),_:1})]),default:a(()=>[e("div",null,[l[30]||(l[30]=e("h5",null,"Old Activity:",-1)),e("p",null,n(m.oldActivity.description),1),l[31]||(l[31]=e("h5",null,"New Activity:",-1)),e("p",null,n(m.newActivity.description),1)])]),_:1},8,["modelValue"])])}const ct=z(Je,[["render",mt],["__scopeId","data-v-be66d96e"]]);export{ct as default};
