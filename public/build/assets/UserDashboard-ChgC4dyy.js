import{_ as S,f as c,D as p,E,c as d,o as r,b as s,t as l,n as k,i as g,h as N,j as V,v as $,F as A,r as B,X as T}from"./app-BFj7m03g.js";const R={class:"modern-dashboard"},j={class:"dashboard-header"},q={class:"header-content"},z={class:"dashboard-subtitle"},G={class:"header-stats"},O={class:"stat-item"},Q={class:"stat-item"},X={class:"stat-value"},H={key:0,class:"live-indicator"},J={class:"stat-item"},K={class:"stat-value"},P={class:"stats-grid quick-stats"},W={class:"stat-card"},Y={class:"stat-content"},Z={class:"stat-value"},ss={class:"stat-card"},ts={class:"stat-content"},as={class:"stat-value"},es={class:"stat-card"},ls={class:"stat-content"},os={class:"stat-value"},is={class:"stat-card"},ns={class:"stat-content"},ds={class:"stat-value"},rs={class:"section-container"},cs={class:"section-header"},vs={class:"header-actions"},us={class:"search-container"},ps=["disabled"],ms={class:"market-data-grid"},_s={class:"market-card all-stocks-card"},hs={class:"card-header"},gs={class:"card-title-section"},fs={class:"card-subtitle"},bs={key:0,class:"update-indicator"},ys={class:"card-content"},ks={key:0,class:"loading-state"},Ls={key:1,class:"empty-state"},Ds={key:2,class:"stocks-list"},xs={class:"stock-info"},Cs={class:"stock-name"},Is={class:"stock-symbol"},Ns={class:"stock-metrics"},Ts={class:"stock-price"},Us={__name:"UserDashboard",setup(Fs){const n=c(!1),m=c({}),o=c([]),_=c([]),f=c(null),L=c(new Date),v=c(""),h=p(()=>o.value.length),U=p(()=>o.value.filter(e=>e.change_percent>0).length),F=p(()=>o.value.filter(e=>e.change_percent<0).length),u=p(()=>f.value?C(f.value):"N/A"),w=p(()=>C(L.value)),D=()=>{if(!v.value.trim())_.value=o.value;else{const e=v.value.toLowerCase();_.value=o.value.filter(t=>t.symbol.toLowerCase().includes(e))}},x=e=>e?parseFloat(e).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}):"0",C=e=>e?new Date(e).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"N/A",b=async()=>{o.value.length===0&&(n.value=!0);try{const e=await T.get("http://localhost:8000/api/truedata/live-data");if(e.data.success){const t=e.data.data,i=Object.values(t).map(a=>({symbol:a.symbol,ltp:a.ltp,change:a.change,change_percent:a.change_percent,high:a.high,low:a.low,open:a.open,prev_close:a.prev_close,volume:a.volume,timestamp:a.timestamp,data_source:a.data_source,is_live:a.is_live,market_status:a.market_status}));o.value.length>0?i.forEach(a=>{const y=o.value.findIndex(M=>M.symbol===a.symbol);y!==-1?o.value[y]={...o.value[y],ltp:a.ltp,change:a.change,change_percent:a.change_percent,high:a.high,low:a.low,open:a.open,prev_close:a.prev_close,volume:a.volume,timestamp:a.timestamp}:o.value.push(a)}):o.value=i,f.value=e.data.last_update,m.value=e.data.market_status||{},D(),console.log(`ðŸ”„ Live data updated: ${o.value.length} symbols from database at ${u.value}`)}else console.error("Failed to fetch live data:",e.data.message)}catch(e){console.error("Error fetching live data:",e)}finally{n.value=!1}},I=async()=>{try{const e=await T.get("http://localhost:8000/api/truedata/market-status");e.data.success&&(m.value=e.data.data)}catch(e){console.error("Error fetching market status:",e)}};return E(()=>{I(),b(),setInterval(()=>{b()},1e4),setInterval(()=>{I()},3e4),setInterval(()=>{L.value=new Date},1e3)}),(e,t)=>(r(),d("div",R,[s("div",j,[s("div",q,[t[1]||(t[1]=s("h1",{class:"dashboard-title"},"ðŸ“Š Live Market Data",-1)),s("p",z,"Real-time stock prices from database ("+l(h.value)+" symbols)",1)]),s("div",G,[s("div",O,[t[2]||(t[2]=s("span",{class:"stat-label"},"Market Status",-1)),s("span",{class:k(["stat-value",m.value.is_live?"market-open":"market-closed"])},l(m.value.status||"Loading..."),3)]),s("div",Q,[t[3]||(t[3]=s("span",{class:"stat-label"},"Last Updated",-1)),s("span",X,[g(l(u.value)+" ",1),n.value?N("",!0):(r(),d("span",H,"â—"))])]),s("div",J,[t[5]||(t[5]=s("span",{class:"stat-label"},"Current Time",-1)),s("span",K,[g(l(w.value)+" ",1),t[4]||(t[4]=s("span",{class:"live-indicator"},"â—",-1))])])])]),s("div",P,[s("div",W,[t[8]||(t[8]=s("div",{class:"stat-icon"},[s("i",{class:"fas fa-chart-line"})],-1)),s("div",Y,[t[6]||(t[6]=s("h3",{class:"stat-title"},"Total Symbols",-1)),s("p",Z,l(h.value),1),t[7]||(t[7]=s("p",{class:"stat-description"},"Live market data",-1))])]),s("div",ss,[t[11]||(t[11]=s("div",{class:"stat-icon"},[s("i",{class:"fas fa-arrow-up"})],-1)),s("div",ts,[t[9]||(t[9]=s("h3",{class:"stat-title"},"Gainers",-1)),s("p",as,l(U.value),1),t[10]||(t[10]=s("p",{class:"stat-description"},"Stocks gaining today",-1))])]),s("div",es,[t[14]||(t[14]=s("div",{class:"stat-icon"},[s("i",{class:"fas fa-arrow-down"})],-1)),s("div",ls,[t[12]||(t[12]=s("h3",{class:"stat-title"},"Losers",-1)),s("p",os,l(F.value),1),t[13]||(t[13]=s("p",{class:"stat-description"},"Stocks declining today",-1))])]),s("div",is,[t[17]||(t[17]=s("div",{class:"stat-icon"},[s("i",{class:"fas fa-clock"})],-1)),s("div",ns,[t[15]||(t[15]=s("h3",{class:"stat-title"},"Last Update",-1)),s("p",ds,l(u.value),1),t[16]||(t[16]=s("p",{class:"stat-description"},"Real-time data",-1))])])]),s("div",rs,[s("div",cs,[t[19]||(t[19]=s("h2",{class:"section-title"},"ðŸ“ˆ Live Market Data",-1)),s("div",vs,[s("div",us,[V(s("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=i=>v.value=i),placeholder:"Search stocks...",class:"search-input",onInput:D},null,544),[[$,v.value]]),t[18]||(t[18]=s("i",{class:"fas fa-search search-icon"},null,-1))]),s("button",{class:"refresh-btn",onClick:b,disabled:n.value},[s("i",{class:k(["fas fa-sync-alt",{"fa-spin":n.value}])},null,2),g(" "+l(n.value?"Updating...":"Refresh"),1)],8,ps)])]),s("div",ms,[s("div",_s,[s("div",hs,[t[21]||(t[21]=s("div",{class:"card-icon blue"},"ðŸ“Š",-1)),s("div",gs,[t[20]||(t[20]=s("h3",{class:"card-title"},"All Live Stocks",-1)),s("p",fs,[g(l(v.value?`${_.value.length} of ${h.value}`:h.value)+" symbols from database ",1),!n.value&&u.value?(r(),d("span",bs,"â€¢ Updated "+l(u.value),1)):N("",!0)])])]),s("div",ys,[n.value?(r(),d("div",ks,t[22]||(t[22]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"Loading live market data...",-1)]))):o.value.length?(r(),d("div",Ds,[(r(!0),d(A,null,B(_.value,(i,a)=>(r(),d("div",{key:a,class:"stock-item"},[s("div",xs,[s("span",Cs,l(i.symbol),1),s("span",Is,l(x(i.ltp)),1)]),s("div",Ns,[s("span",Ts,"â‚¹"+l(x(i.ltp)),1),s("span",{class:k(["stock-change",i.change_percent>=0?"positive":"negative"])},l(i.change_percent>=0?"+":"")+l(i.change_percent.toFixed(2))+"% ",3)])]))),128))])):(r(),d("div",Ls,t[23]||(t[23]=[s("div",{class:"empty-icon"},"ðŸ“Š",-1),s("p",null,"No live data available",-1)])))])])])])]))}},Ms=S(Us,[["__scopeId","data-v-613914d4"]]);export{Ms as default};
