import{C as k}from"./vue-select.es-By2pVrIx.js";import{_ as w,a as u,c,o as d,b as o,e as g,i as s,t as a,f as i,k as n,w as M,y as S,l as v}from"./app-CKEtSxiX.js";import{u as N}from"./index-BDYEGvFS.js";const U={components:{vSelect:k},watch:{"customer.assignedTo":function(){this.removeError("assignedTo")},"customer.engagement":function(){this.removeError("engagement")}},data(){return{customer:{name:"",contactperson:"",email:"",contactnumber:"",assignedTo:null,engagement:null},successMessage:"",assignedToOptions:[],engagementOptions:["High","Medium","Low"],errors:{},isLoading:!1}},mounted(){this.fetchCustomerDetails(),v.get("/getAssignee").then(m=>{this.assignedToOptions=m.data.data})},methods:{updateCustomer(){this.isLoading=!0;const m=N();v.post(`/update/${this.$route.params.id}`,this.customer).then(e=>{this.isLoading=!1,this.successMessage="Customer Updated successfully!",this.clearSuccessMessage(),m.success("Customer updated successfully!"),this.resetForm(),this.$router.push({name:"customer"})}).catch(e=>{this.isLoading=!1,e.response.data.code==422&&(this.errors=e.response.data.errors)})},fetchCustomerDetails(m){v.get(`/edit/${this.$route.params.id}`).then(e=>{this.customer=e.data.data;const _=e.data.data.assignedto;this.customer.assignedTo=_&&!isNaN(_)?parseInt(_):null})},clearSuccessMessage(){setTimeout(()=>{this.successMessage=""},2e3)},removeError(m){this.errors[m]&&delete this.errors[m]},hasErrors(m){return this.errors&&this.errors[m]},getErrors(m){return this.errors[m]?this.errors[m][0]:""},resetForm(){this.customer={id:null,name:"",contactperson:"",email:"",contactnumber:"",assignedTo:null,engagement:null}}},created(){}},I={class:"dashboard"},L={class:"list__page"},O={key:0,class:"alert alert-success"},B={class:"page__breadcrumb"},D={class:"text-danger"},A={key:0,class:"text-danger"},F={class:"text-danger"},H={key:0,class:"text-danger"},P={class:"text-danger"},j={key:0,class:"text-danger"},q={class:"text-danger"},z={key:0,class:"text-danger"},G={class:"text-danger"},J={key:0,class:"text-danger"},K={class:"text-danger"},Q={key:0,class:"text-danger"};function R(m,e,_,W,t,l){const y=u("b-link"),f=u("b-form-input"),b=u("b-form-group"),p=u("b-col"),h=u("v-select"),E=u("b-row"),V=u("b-button"),C=u("b-form"),T=u("b-overlay"),x=u("b-card");return d(),c("div",I,[o("div",L,[t.successMessage?(d(),c("div",O,a(t.successMessage),1)):g("",!0),o("div",B,[o("p",null,[s(y,{to:{name:"customer"}},{default:n(()=>e[11]||(e[11]=[i(" Customer "),o("i",{class:"fas fa-chevron-right"},null,-1)])),_:1}),e[12]||(e[12]=i(" Edit"))])]),s(x,{title:"Edit Customer Details"},{default:n(()=>[s(T,{show:t.isLoading,rounded:"sm",class:"loadShow btninl"},{default:n(()=>[s(C,{onSubmit:M(l.updateCustomer,["prevent"])},{default:n(()=>[s(E,null,{default:n(()=>[s(p,{md:"6"},{default:n(()=>[e[13]||(e[13]=o("label",{class:"form-label"},[i(" Customer Name "),o("span",{style:{color:"red"}}," *")],-1)),s(b,{"label-for":"name-input"},{default:n(()=>[s(f,{id:"name-input",modelValue:t.customer.name,"onUpdate:modelValue":e[0]||(e[0]=r=>t.customer.name=r),placeholder:"Enter customer name",trim:"",onInput:e[1]||(e[1]=r=>l.removeError("name"))},null,8,["modelValue"]),o("small",D,a(t.errors[0]),1),l.hasErrors("name")?(d(),c("div",A,a(l.getErrors("name")),1)):g("",!0)]),_:1})]),_:1}),s(p,{md:"6"},{default:n(()=>[e[14]||(e[14]=o("label",{class:"form-label"},[i(" Contact Person "),o("span",{style:{color:"red"}}," *")],-1)),s(b,{"label-for":"contact-person-input"},{default:n(()=>[s(f,{id:"contact-person-input",modelValue:t.customer.contactperson,"onUpdate:modelValue":e[2]||(e[2]=r=>t.customer.contactperson=r),placeholder:"Enter contact person",onInput:e[3]||(e[3]=r=>l.removeError("contactperson"))},null,8,["modelValue"]),o("small",F,a(t.errors[0]),1),l.hasErrors("contactperson")?(d(),c("div",H,a(l.getErrors("contactperson")),1)):g("",!0)]),_:1})]),_:1}),s(p,{md:"6"},{default:n(()=>[e[15]||(e[15]=o("label",{class:"form-label"},[i(" Email "),o("span",{style:{color:"red"}}," *")],-1)),s(b,{"label-for":"email-input"},{default:n(()=>[s(f,{id:"email-input",modelValue:t.customer.email,"onUpdate:modelValue":e[4]||(e[4]=r=>t.customer.email=r),type:"email",placeholder:"Enter email address",onInput:e[5]||(e[5]=r=>l.removeError("email"))},null,8,["modelValue"]),o("small",P,a(t.errors[0]),1),l.hasErrors("email")?(d(),c("div",j,a(l.getErrors("email")),1)):g("",!0)]),_:1})]),_:1}),s(p,{md:"6"},{default:n(()=>[e[16]||(e[16]=o("label",{class:"form-label"},[i(" Contact Number "),o("span",{style:{color:"red"}}," *")],-1)),s(b,{"label-for":"contact-number-input"},{default:n(()=>[s(f,{id:"contact-number-input",modelValue:t.customer.contactnumber,"onUpdate:modelValue":e[6]||(e[6]=r=>t.customer.contactnumber=r),type:"tel",placeholder:"Enter contact number",onInput:e[7]||(e[7]=r=>l.removeError("contactnumber"))},null,8,["modelValue"]),o("small",q,a(t.errors[0]),1),l.hasErrors("contactnumber")?(d(),c("div",z,a(l.getErrors("contactnumber")),1)):g("",!0)]),_:1})]),_:1}),s(p,{md:"6"},{default:n(()=>[e[17]||(e[17]=o("label",{class:"form-label"},[i(" Assigned To "),o("span",{style:{color:"red"}}," *")],-1)),s(b,{label:"","label-for":"assigned-to-select"},{default:n(()=>[s(h,{label:"name",value:"id",reduce:r=>r.id,id:"assigned-to-select",modelValue:t.customer.assignedTo,"onUpdate:modelValue":e[8]||(e[8]=r=>t.customer.assignedTo=r),onInput:e[9]||(e[9]=r=>l.removeError("assignedTo")),options:t.assignedToOptions,placeholder:"Select assignee"},{"selected-item":n(({item:r})=>[o("span",null,a(r?r.name:"Not Assigned"),1)]),_:1},8,["reduce","modelValue","options"]),o("small",G,a(t.errors[0]),1),l.hasErrors("assignedTo")?(d(),c("div",J,a(l.getErrors("assignedTo")),1)):g("",!0)]),_:1})]),_:1}),s(p,{md:"12"},{default:n(()=>[e[18]||(e[18]=o("label",{class:"form-label"},[i(" Engagement "),o("span",{style:{color:"red"}}," *")],-1)),s(b,{label:"","label-for":"engagement-select"},{default:n(()=>[s(h,{id:"engagement-select",modelValue:t.customer.engagement,"onUpdate:modelValue":e[10]||(e[10]=r=>t.customer.engagement=r),options:t.engagementOptions,placeholder:"Select engagement level"},null,8,["modelValue","options"]),o("small",K,a(t.errors[0]),1),l.hasErrors("engagement")?(d(),c("div",Q,a(l.getErrors("engagement")),1)):g("",!0)]),_:1})]),_:1})]),_:1}),s(E,null,{default:n(()=>[s(p,null,{default:n(()=>[t.isLoading?g("",!0):(d(),S(V,{key:0,type:"submit",variant:"primary"},{default:n(()=>e[19]||(e[19]=[i("Update Customer")])),_:1}))]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["show"])]),_:1})])])}const $=w(U,[["render",R],["__scopeId","data-v-b24851d0"]]);export{$ as default};
