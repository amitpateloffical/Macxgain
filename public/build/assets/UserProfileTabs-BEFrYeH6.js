import{_ as k,s as E,S as I,g as d,Q as N,o as c,q as t,l as s,b as l,t as p,i as v,w as S,c as w,h,f as x,u as U,n as C}from"./app-Da8Q9-cl.js";const F={props:{userId:{type:String,required:!0}},data(){return{options:{name:"",email:"",phone:"",role:"",profile_image:""},selectedFile:null,imagePreview:null,errors:{}}},created(){this.getUserProfile()},methods:{RemoveError(r){this.errors[r]&&delete this.errors[r]},hasErrors(r){return this.errors&&this.errors[r]},getErrors(r){return this.errors[r]?this.errors[r][0]:""},getUserProfile(){E.get("/userprofile").then(r=>{this.options=r.data.data})},onFileChange(r){this.selectedFile=r.target.files[0],this.selectedFile&&(this.imagePreview=URL.createObjectURL(this.selectedFile))},triggerFileUpload(){this.$refs.fileInput.click()},saveGeneralInfo(){const r=new FormData;r.append("id",this.options.id),r.append("name",this.options.name),r.append("email",this.options.email),r.append("phone",this.options.phone),r.append("role",this.options.role),r.append("bank_name",this.options.bank_name||""),r.append("account_no",this.options.account_no||""),r.append("ifsc_code",this.options.ifsc_code||""),this.selectedFile&&r.append("profile_image",this.selectedFile),E.post(`/update-profile/${btoa(this.options.id)}`,r,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{this.options=e.data.data,this.selectedFile=null,this.imagePreview=null,window.dispatchEvent(new Event("profileUpdated")),I.fire({icon:"success",title:"Profile updated successfully",timer:1500,showConfirmButton:!1}),e.data.data.is_admin==0?this.$router.push("/user/dashboard"):this.$router.push("/admin/dashboard")}).catch(e=>{var _;((_=e.response)==null?void 0:_.data.code)===422&&(this.errors=e.response.data.errors)})}}},R={class:"mt-4"},O={class:"fw-bold"},B={class:"text-muted"},T={class:"text-muted"},L={key:0,class:"text-danger small"},G={key:0,class:"text-danger small"},D={key:0,class:"text-danger small"},M={key:0,class:"text-danger small"},q={key:0,class:"text-danger small"},z={class:"mt-4"};function A(r,e,_,f,n,o){const i=d("b-col"),u=d("b-form-input"),m=d("b-form-group"),b=d("b-row"),g=d("b-button"),P=d("b-form"),V=d("b-card"),y=d("b-container");return c(),N(y,{fluid:"",class:"main-content"},{default:t(()=>[s(V,{class:"profile-card shadow-lg border-0"},{default:t(()=>[s(b,null,{default:t(()=>[s(i,{md:"4",class:"text-center border-end border-gray-700 pe-4"},{default:t(()=>[l("div",R,[l("h5",O,p(n.options.name),1),l("p",B,[e[11]||(e[11]=l("strong",null,"Email:",-1)),v(" "+p(n.options.email),1)]),l("p",T,[e[12]||(e[12]=l("strong",null,"Contact:",-1)),v(" "+p(n.options.phone),1)])])]),_:1}),s(i,{md:"8",class:"ps-4"},{default:t(()=>[e[15]||(e[15]=l("h4",{class:"fw-bold mb-3 text-primary"},"Edit Profile",-1)),s(P,{onSubmit:S(o.saveGeneralInfo,["prevent"])},{default:t(()=>[s(b,null,{default:t(()=>[s(i,{md:"6",class:"mb-3"},{default:t(()=>[s(m,{label:"Full Name","label-class":"fw-semibold"},{default:t(()=>[s(u,{id:"name",modelValue:n.options.name,"onUpdate:modelValue":e[0]||(e[0]=a=>n.options.name=a),onInput:e[1]||(e[1]=a=>o.RemoveError("name")),state:o.hasErrors("name")?!1:null,placeholder:"Enter Name",autocomplete:"off"},null,8,["modelValue","state"]),o.hasErrors("name")?(c(),w("div",L,p(o.getErrors("name")),1)):h("",!0)]),_:1})]),_:1}),s(i,{md:"6",class:"mb-3"},{default:t(()=>[s(m,{label:"Email","label-class":"fw-semibold"},{default:t(()=>[s(u,{modelValue:n.options.email,"onUpdate:modelValue":e[2]||(e[2]=a=>n.options.email=a),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),s(i,{md:"6",class:"mb-3"},{default:t(()=>[s(m,{label:"Phone","label-class":"fw-semibold"},{default:t(()=>[s(u,{id:"phone",modelValue:n.options.phone,"onUpdate:modelValue":e[3]||(e[3]=a=>n.options.phone=a),onInput:e[4]||(e[4]=a=>o.RemoveError("phone")),state:o.hasErrors("phone")?!1:null,placeholder:"Enter Mobile Number",autocomplete:"off"},null,8,["modelValue","state"]),o.hasErrors("phone")?(c(),w("div",G,p(o.getErrors("phone")),1)):h("",!0)]),_:1})]),_:1}),s(i,{md:"6",class:"mb-3"},{default:t(()=>[s(m,{label:"Bank Name","label-class":"fw-semibold"},{default:t(()=>[s(u,{id:"bank_name",modelValue:n.options.bank_name,"onUpdate:modelValue":e[5]||(e[5]=a=>n.options.bank_name=a),onInput:e[6]||(e[6]=a=>o.RemoveError("bank_name")),state:o.hasErrors("bank_name")?!1:null,placeholder:"Enter Bank Name",autocomplete:"off"},null,8,["modelValue","state"]),o.hasErrors("bank_name")?(c(),w("div",D,p(o.getErrors("bank_name")),1)):h("",!0)]),_:1})]),_:1}),s(i,{md:"6",class:"mb-3"},{default:t(()=>[s(m,{label:"Account Number","label-class":"fw-semibold"},{default:t(()=>[s(u,{id:"account_no",modelValue:n.options.account_no,"onUpdate:modelValue":e[7]||(e[7]=a=>n.options.account_no=a),onInput:e[8]||(e[8]=a=>o.RemoveError("account_no")),state:o.hasErrors("account_no")?!1:null,placeholder:"Enter Account Number",autocomplete:"off"},null,8,["modelValue","state"]),o.hasErrors("account_no")?(c(),w("div",M,p(o.getErrors("account_no")),1)):h("",!0)]),_:1})]),_:1}),s(i,{md:"6",class:"mb-3"},{default:t(()=>[s(m,{label:"IFSC Code","label-class":"fw-semibold"},{default:t(()=>[s(u,{id:"ifsc_code",modelValue:n.options.ifsc_code,"onUpdate:modelValue":e[9]||(e[9]=a=>n.options.ifsc_code=a),onInput:e[10]||(e[10]=a=>o.RemoveError("ifsc_code")),state:o.hasErrors("ifsc_code")?!1:null,placeholder:"Enter IFSC Code",autocomplete:"off"},null,8,["modelValue","state"]),o.hasErrors("ifsc_code")?(c(),w("div",q,p(o.getErrors("ifsc_code")),1)):h("",!0)]),_:1})]),_:1})]),_:1}),l("div",z,[s(g,{type:"submit",variant:"primary",class:"me-2 rounded-pill px-4"},{default:t(()=>e[13]||(e[13]=[l("i",{class:"bi bi-check-circle me-1"},null,-1),v(" Save ")])),_:1}),s(g,{type:"reset",variant:"secondary",class:"rounded-pill px-4"},{default:t(()=>e[14]||(e[14]=[l("i",{class:"bi bi-x-circle me-1"},null,-1),v(" Cancel ")])),_:1})])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1})}const H=k(F,[["render",A],["__scopeId","data-v-094ffc53"]]);E.defaults.withCredentials=!0;const j={data(){return{showOldPassword:!1,showNewPassword:!1,showConfirmPassword:!1,errors:{}}},methods:{RemoveError(r){this.errors[r]&&delete this.errors[r]},hasErrors(r){return this.errors&&this.errors[r]},getErrors(r){return this.errors[r]?this.errors[r][0]:""},toggleOldPasswordView(){this.showOldPassword=!this.showOldPassword},toggleNewPasswordView(){this.showNewPassword=!this.showNewPassword},toggleConfirmPasswordView(){this.showConfirmPassword=!this.showConfirmPassword}},setup(){const r=x({current_password:"",new_password:"",new_password_confirmation:""}),e=x([]),_=U();return{userpassword:r,changePassword:()=>{E.post("/change-password",r.value).then(n=>{n.data.status==="success"&&I.fire({title:"Success!",text:"Password changed successfully.",icon:"success",timer:2e3,showConfirmButton:!1}).then(()=>{_.replace({name:"dashboard"})})}).catch(n=>{n.response&&n.response.data.code===422&&(e.value=n.response.data.errors)})},errors:e}}},Q={key:0,class:"text-danger small"},J={key:0,class:"text-danger small"},K={key:0,class:"text-danger small"};function W(r,e,_,f,n,o){const i=d("b-form-input"),u=d("b-input-group-append"),m=d("b-input-group"),b=d("b-form-group"),g=d("b-button"),P=d("b-form"),V=d("b-card"),y=d("b-container");return c(),N(y,{fluid:"",class:"main-content"},{default:t(()=>[s(V,{class:"profile-card"},{default:t(()=>[e[10]||(e[10]=l("h4",{class:"mb-4"},"Change Password",-1)),s(P,null,{default:t(()=>[s(b,{label:"Old Password"},{default:t(()=>[s(m,{class:"input-group-merge"},{default:t(()=>[s(i,{type:n.showOldPassword?"text":"password",modelValue:f.userpassword.current_password,"onUpdate:modelValue":e[0]||(e[0]=a=>f.userpassword.current_password=a),id:"current_password",onInput:e[1]||(e[1]=a=>o.RemoveError("current_password")),state:o.hasErrors("current_password")?!1:null,placeholder:"Enter Current Password",autocomplete:"off"},null,8,["type","modelValue","state"]),s(u,{"is-text":""},{default:t(()=>[l("button",{type:"button",onClick:e[2]||(e[2]=(...a)=>o.toggleOldPasswordView&&o.toggleOldPasswordView(...a)),class:"toggle-password-btn"},[l("i",{class:C(n.showOldPassword?"fa fa-eye-slash":"fa fa-eye")},null,2)])]),_:1})]),_:1}),o.hasErrors("current_password")?(c(),w("div",Q,p(o.getErrors("current_password")),1)):h("",!0)]),_:1}),s(b,{label:"New Password"},{default:t(()=>[s(m,{class:"input-group-merge"},{default:t(()=>[s(i,{type:n.showNewPassword?"text":"password",modelValue:f.userpassword.new_password,"onUpdate:modelValue":e[3]||(e[3]=a=>f.userpassword.new_password=a),id:"new_password",onInput:e[4]||(e[4]=a=>o.RemoveError("new_password")),state:o.hasErrors("new_password")?!1:null,placeholder:"Enter New Password",autocomplete:"off"},null,8,["type","modelValue","state"]),s(u,{"is-text":""},{default:t(()=>[l("button",{type:"button",onClick:e[5]||(e[5]=(...a)=>o.toggleNewPasswordView&&o.toggleNewPasswordView(...a)),class:"toggle-password-btn"},[l("i",{class:C(n.showNewPassword?"fa fa-eye-slash":"fa fa-eye")},null,2)])]),_:1})]),_:1}),o.hasErrors("new_password")?(c(),w("div",J,p(o.getErrors("new_password")),1)):h("",!0)]),_:1}),s(b,{label:"Confirm Password"},{default:t(()=>[s(m,{class:"input-group-merge"},{default:t(()=>[s(i,{type:n.showConfirmPassword?"text":"password",modelValue:f.userpassword.new_password_confirmation,"onUpdate:modelValue":e[6]||(e[6]=a=>f.userpassword.new_password_confirmation=a),id:"new_password_confirmation",onInput:e[7]||(e[7]=a=>o.RemoveError("new_password_confirmation")),state:o.hasErrors("new_password_confirmation")?!1:null,placeholder:"Confirm New Password",autocomplete:"off"},null,8,["type","modelValue","state"]),s(u,{"is-text":""},{default:t(()=>[l("button",{type:"button",onClick:e[8]||(e[8]=(...a)=>o.toggleConfirmPasswordView&&o.toggleConfirmPasswordView(...a)),class:"toggle-password-btn"},[l("i",{class:C(n.showConfirmPassword?"fa fa-eye-slash":"fa fa-eye")},null,2)])]),_:1})]),_:1}),o.hasErrors("new_password_confirmation")?(c(),w("div",K,p(o.getErrors("new_password_confirmation")),1)):h("",!0)]),_:1}),s(g,{type:"submit",variant:"success",class:"mt-3",onClick:f.changePassword},{default:t(()=>e[9]||(e[9]=[v(" Change Password ")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})}const X=k(j,[["render",W],["__scopeId","data-v-537c2527"]]),Y={props:{userId:{type:String,required:!0}},components:{GeneralTab:H,ChangePasswordTab:X},methods:{logout(){confirm("Are you sure you want to logout?")&&this.performLogout()},performLogout(){localStorage.removeItem("userData"),localStorage.removeItem("access_token"),localStorage.removeItem("token"),localStorage.removeItem("auth_token"),localStorage.removeItem("user"),sessionStorage.clear(),this.$router.push({name:"login"})}}},Z={class:"profile-tabs-container"},$={class:"tabs-wrapper"},ee={class:"tabs-header"},se={class:"logout-section"};function oe(r,e,_,f,n,o){const i=d("GeneralTab"),u=d("b-tab"),m=d("ChangePasswordTab"),b=d("b-tabs");return c(),w("div",Z,[l("div",$,[l("div",ee,[s(b,{pills:"","content-class":"mt-3","nav-class":"modern-nav-tabs"},{default:t(()=>[s(u,{title:"👤 General",active:""},{default:t(()=>[s(i,{userId:_.userId},null,8,["userId"])]),_:1}),s(u,{title:"🔒 Change Password"},{default:t(()=>[s(m,{userId:_.userId},null,8,["userId"])]),_:1})]),_:1}),l("div",se,[l("button",{onClick:e[0]||(e[0]=(...g)=>o.logout&&o.logout(...g)),class:"logout-btn"},e[1]||(e[1]=[l("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.59L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"})],-1),l("span",null,"Logout",-1)]))])])])])}const re=k(Y,[["render",oe],["__scopeId","data-v-eb6c4032"]]);export{re as default};
