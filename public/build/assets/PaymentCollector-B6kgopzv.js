import{_ as v,c as i,o as d,b as s,h as m,i as p,t as c,w as h,j as f,v as g,p as _,F as k,r as C,W as y,n as b}from"./app-DkZr9LdR.js";const D={name:"PaymentCollector",data(){return{loading:!1,showAddForm:!1,editingCollector:null,paymentCollectors:[],formData:{bank_name:"",account_holder_name:"",account_number:"",ifsc_code:"",branch_name:"",barcode_image:"",qr_code:"",is_primary:!1,notes:""}}},mounted(){this.loadPaymentCollectors()},methods:{async loadPaymentCollectors(){var o;try{this.loading=!0;const e=localStorage.getItem("access_token"),n=await y.get("/api/admin-payment-collectors",{headers:{Authorization:`Bearer ${e}`,Accept:"application/json"}});n.data.success&&(this.paymentCollectors=n.data.data)}catch(e){console.error("Error loading payment collectors:",e),(o=this.$toast)==null||o.error("Failed to load payment collectors")}finally{this.loading=!1}},async submitForm(){var o,e,n,r;try{this.loading=!0;const a=localStorage.getItem("access_token"),l=this.editingCollector?`/api/admin-payment-collectors/${this.editingCollector.id}`:"/api/admin-payment-collectors",t=this.editingCollector?"PUT":"POST",u=await y({method:t,url:l,data:this.formData,headers:{Authorization:`Bearer ${a}`,Accept:"application/json","Content-Type":"application/json"}});u.data.success&&((o=this.$toast)==null||o.success(u.data.message),this.closeForm(),await this.loadPaymentCollectors())}catch(a){console.error("Error saving payment collector:",a),(r=this.$toast)==null||r.error(((n=(e=a.response)==null?void 0:e.data)==null?void 0:n.message)||"Failed to save payment collector")}finally{this.loading=!1}},async markAsPrimary(o){var e,n;try{this.loading=!0;const r=localStorage.getItem("access_token");(await y.patch(`/api/admin-payment-collectors/${o}/primary`,{},{headers:{Authorization:`Bearer ${r}`,Accept:"application/json"}})).data.success&&((e=this.$toast)==null||e.success("Payment method marked as primary"),await this.loadPaymentCollectors())}catch(r){console.error("Error marking as primary:",r),(n=this.$toast)==null||n.error("Failed to mark as primary")}finally{this.loading=!1}},async toggleStatus(o){var e,n;try{this.loading=!0;const r=localStorage.getItem("access_token");(await y.patch(`/api/admin-payment-collectors/${o}/toggle-status`,{},{headers:{Authorization:`Bearer ${r}`,Accept:"application/json"}})).data.success&&((e=this.$toast)==null||e.success("Status updated successfully"),await this.loadPaymentCollectors())}catch(r){console.error("Error toggling status:",r),(n=this.$toast)==null||n.error("Failed to update status")}finally{this.loading=!1}},async deleteCollector(o){var e,n;if(confirm("Are you sure you want to delete this payment method?"))try{this.loading=!0;const r=localStorage.getItem("access_token");(await y.delete(`/api/admin-payment-collectors/${o}`,{headers:{Authorization:`Bearer ${r}`,Accept:"application/json"}})).data.success&&((e=this.$toast)==null||e.success("Payment method deleted successfully"),await this.loadPaymentCollectors())}catch(r){console.error("Error deleting payment collector:",r),(n=this.$toast)==null||n.error("Failed to delete payment method")}finally{this.loading=!1}},editCollector(o){this.editingCollector=o,this.formData={...o},this.showAddForm=!1},closeForm(){this.showAddForm=!1,this.editingCollector=null,this.resetForm()},resetForm(){this.formData={bank_name:"",account_holder_name:"",account_number:"",ifsc_code:"",branch_name:"",barcode_image:"",qr_code:"",is_primary:!1,notes:""}},handleFileUpload(o){const e=o.target.files[0];if(e){const n=new FileReader;n.onload=r=>{this.formData.barcode_image=r.target.result},n.readAsDataURL(e)}},removeImage(){this.formData.barcode_image="",this.$refs.fileInput.value=""},getImageSrc(o){return o?o.startsWith("data:")?o:`${window.location.origin}/storage/${o}`:""},maskAccountNumber(o){if(!o)return"";const e=o.length;return e<=4?o:"*".repeat(e-4)+o.slice(-4)},handleImageError(o){console.error("Image failed to load:",o.target.src),o.target.style.display="none";const e=o.target.parentNode;if(!e.querySelector(".image-error")){const n=document.createElement("div");n.className="image-error",n.innerHTML='<i class="fas fa-exclamation-triangle"></i> Image not available',e.appendChild(n)}},handleImageLoad(o){console.log("Image loaded successfully:",o.target.src)},navigateTo(o){this.$router.push(o)}}},w={class:"payment-collector-screen"},A={class:"page-header"},I={class:"header-content"},F={class:"header-left"},P={class:"header-right"},x={class:"modal-header"},S={class:"form-grid"},B={class:"form-group"},U={class:"form-group"},M={class:"form-group"},E={class:"form-group"},N={class:"form-group"},q={class:"form-group"},V={class:"form-group full-width"},T={class:"file-upload-area"},R={key:0,class:"upload-placeholder"},j={key:1,class:"image-preview"},L=["src"],z={class:"form-group full-width"},Q={class:"form-group full-width"},H={class:"checkbox-label"},W={class:"form-actions"},O=["disabled"],G={key:0,class:"fas fa-spinner fa-spin"},J={class:"collectors-section"},K={class:"section-header"},X={class:"collectors-count"},Y={key:0,class:"empty-state"},Z={key:1,class:"collectors-grid"},$={class:"card-header"},ee={class:"bank-info"},se={class:"bank-name"},te={class:"account-holder"},ae={class:"card-badges"},oe={key:0,class:"badge primary"},le={class:"card-content"},ne={class:"account-details"},re={class:"detail-row"},ie={class:"value"},de={class:"detail-row"},ce={class:"value"},me={key:0,class:"detail-row"},ue={class:"value"},pe={key:1,class:"detail-row"},fe={class:"value"},ge={key:0,class:"barcode-section"},ye=["src"],be={key:1,class:"notes-section"},he={class:"notes-text"},ve={class:"card-actions"},_e=["onClick","disabled"],ke=["onClick","disabled"],Ce=["onClick"],De=["onClick","disabled"],we={key:1,class:"loading-overlay"};function Ae(o,e,n,r,a,l){return d(),i("div",w,[s("div",A,[s("div",I,[s("div",F,[s("button",{class:"back-btn",onClick:e[0]||(e[0]=t=>l.navigateTo("/admin/dashboard"))},e[20]||(e[20]=[s("i",{class:"fas fa-arrow-left"},null,-1)])),e[21]||(e[21]=s("div",{class:"header-info"},[s("h1",{class:"page-title"},"ðŸ’³ Payment Collector"),s("p",{class:"page-subtitle"},"Manage payment collection details and bank accounts")],-1))]),s("div",P,[s("button",{class:"add-btn",onClick:e[1]||(e[1]=t=>a.showAddForm=!0)},e[22]||(e[22]=[s("i",{class:"fas fa-plus"},null,-1),p(" Add Payment Details ")]))])])]),a.showAddForm||a.editingCollector?(d(),i("div",{key:0,class:"modal-overlay",onClick:e[16]||(e[16]=(...t)=>l.closeForm&&l.closeForm(...t))},[s("div",{class:"modal-content",onClick:e[15]||(e[15]=h(()=>{},["stop"]))},[s("div",x,[s("h3",null,c(a.editingCollector?"Edit":"Add")+" Payment Details",1),s("button",{class:"close-btn",onClick:e[2]||(e[2]=(...t)=>l.closeForm&&l.closeForm(...t))},e[23]||(e[23]=[s("i",{class:"fas fa-times"},null,-1)]))]),s("form",{onSubmit:e[14]||(e[14]=h((...t)=>l.submitForm&&l.submitForm(...t),["prevent"])),class:"payment-form"},[s("div",S,[s("div",B,[e[24]||(e[24]=s("label",{class:"form-label"},"Bank Name *",-1)),f(s("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>a.formData.bank_name=t),type:"text",class:"form-input",placeholder:"e.g., State Bank of India",required:""},null,512),[[g,a.formData.bank_name]])]),s("div",U,[e[25]||(e[25]=s("label",{class:"form-label"},"Account Holder Name *",-1)),f(s("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>a.formData.account_holder_name=t),type:"text",class:"form-input",placeholder:"e.g., Macxgain Technologies",required:""},null,512),[[g,a.formData.account_holder_name]])]),s("div",M,[e[26]||(e[26]=s("label",{class:"form-label"},"Account Number *",-1)),f(s("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>a.formData.account_number=t),type:"text",class:"form-input",placeholder:"e.g., 1234567890123456",required:""},null,512),[[g,a.formData.account_number]])]),s("div",E,[e[27]||(e[27]=s("label",{class:"form-label"},"IFSC Code *",-1)),f(s("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>a.formData.ifsc_code=t),type:"text",class:"form-input",placeholder:"e.g., SBIN0001234",required:""},null,512),[[g,a.formData.ifsc_code]])]),s("div",N,[e[28]||(e[28]=s("label",{class:"form-label"},"Branch Name",-1)),f(s("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>a.formData.branch_name=t),type:"text",class:"form-input",placeholder:"e.g., Mumbai Main Branch"},null,512),[[g,a.formData.branch_name]])]),s("div",q,[e[29]||(e[29]=s("label",{class:"form-label"},"QR Code/UPI ID",-1)),f(s("input",{"onUpdate:modelValue":e[8]||(e[8]=t=>a.formData.qr_code=t),type:"text",class:"form-input",placeholder:"e.g., macxgain@paytm or UPI QR code data"},null,512),[[g,a.formData.qr_code]])])]),s("div",V,[e[32]||(e[32]=s("label",{class:"form-label"},"Barcode/QR Image",-1)),s("div",T,[s("input",{type:"file",ref:"fileInput",onChange:e[9]||(e[9]=(...t)=>l.handleFileUpload&&l.handleFileUpload(...t)),accept:"image/*",class:"file-input"},null,544),a.formData.barcode_image?m("",!0):(d(),i("div",R,e[30]||(e[30]=[s("i",{class:"fas fa-cloud-upload-alt"},null,-1),s("p",null,"Click to upload barcode/QR image",-1)]))),a.formData.barcode_image?(d(),i("div",j,[s("img",{src:l.getImageSrc(a.formData.barcode_image),alt:"Barcode Preview"},null,8,L),s("button",{type:"button",onClick:e[10]||(e[10]=(...t)=>l.removeImage&&l.removeImage(...t)),class:"remove-img-btn"},e[31]||(e[31]=[s("i",{class:"fas fa-times"},null,-1)]))])):m("",!0)])]),s("div",z,[e[33]||(e[33]=s("label",{class:"form-label"},"Notes",-1)),f(s("textarea",{"onUpdate:modelValue":e[11]||(e[11]=t=>a.formData.notes=t),class:"form-textarea",placeholder:"Additional notes or instructions...",rows:"3"},null,512),[[g,a.formData.notes]])]),s("div",Q,[s("label",H,[f(s("input",{"onUpdate:modelValue":e[12]||(e[12]=t=>a.formData.is_primary=t),type:"checkbox",class:"form-checkbox"},null,512),[[_,a.formData.is_primary]]),e[34]||(e[34]=s("span",{class:"checkbox-text"},"Mark as Primary Payment Method",-1))])]),s("div",W,[s("button",{type:"button",onClick:e[13]||(e[13]=(...t)=>l.closeForm&&l.closeForm(...t)),class:"btn-cancel"}," Cancel "),s("button",{type:"submit",class:"btn-submit",disabled:a.loading},[a.loading?(d(),i("i",G)):m("",!0),p(" "+c(a.editingCollector?"Update":"Add")+" Payment Details ",1)],8,O)])],32)])])):m("",!0),s("div",J,[s("div",K,[e[35]||(e[35]=s("h2",null,"Payment Collection Methods",-1)),s("div",X,c(a.paymentCollectors.length)+" methods configured",1)]),a.paymentCollectors.length===0?(d(),i("div",Y,[e[37]||(e[37]=s("div",{class:"empty-icon"},"ðŸ’³",-1)),e[38]||(e[38]=s("h3",null,"No Payment Methods",-1)),e[39]||(e[39]=s("p",null,"Add your first payment collection method to get started",-1)),s("button",{class:"btn-primary",onClick:e[17]||(e[17]=t=>a.showAddForm=!0)},e[36]||(e[36]=[s("i",{class:"fas fa-plus"},null,-1),p(" Add Payment Method ")]))])):(d(),i("div",Z,[(d(!0),i(k,null,C(a.paymentCollectors,t=>(d(),i("div",{key:t.id,class:b(["collector-card",{primary:t.is_primary,inactive:!t.is_active}])},[s("div",$,[s("div",ee,[s("h3",se,c(t.bank_name),1),s("div",te,c(t.account_holder_name),1)]),s("div",ae,[t.is_primary?(d(),i("span",oe,e[40]||(e[40]=[s("i",{class:"fas fa-star"},null,-1),p(" Primary ")]))):m("",!0),s("span",{class:b(["badge",t.is_active?"active":"inactive"])},c(t.is_active?"Active":"Inactive"),3)])]),s("div",le,[s("div",ne,[s("div",re,[e[41]||(e[41]=s("span",{class:"label"},"Account Number:",-1)),s("span",ie,c(l.maskAccountNumber(t.account_number)),1)]),s("div",de,[e[42]||(e[42]=s("span",{class:"label"},"IFSC Code:",-1)),s("span",ce,c(t.ifsc_code),1)]),t.branch_name?(d(),i("div",me,[e[43]||(e[43]=s("span",{class:"label"},"Branch:",-1)),s("span",ue,c(t.branch_name),1)])):m("",!0),t.qr_code?(d(),i("div",pe,[e[44]||(e[44]=s("span",{class:"label"},"UPI/QR:",-1)),s("span",fe,c(t.qr_code),1)])):m("",!0)]),t.barcode_image?(d(),i("div",ge,[e[45]||(e[45]=s("div",{class:"barcode-label"},"Payment QR/Barcode:",-1)),s("img",{src:l.getImageSrc(t.barcode_image),alt:"Payment Barcode",class:"barcode-image",onError:e[18]||(e[18]=(...u)=>l.handleImageError&&l.handleImageError(...u)),onLoad:e[19]||(e[19]=(...u)=>l.handleImageLoad&&l.handleImageLoad(...u))},null,40,ye)])):m("",!0),t.notes?(d(),i("div",be,[e[46]||(e[46]=s("div",{class:"notes-label"},"Notes:",-1)),s("div",he,c(t.notes),1)])):m("",!0)]),s("div",ve,[!t.is_primary&&t.is_active?(d(),i("button",{key:0,onClick:u=>l.markAsPrimary(t.id),class:"action-btn primary-btn",disabled:a.loading},e[47]||(e[47]=[s("i",{class:"fas fa-star"},null,-1),p(" Make Primary ")]),8,_e)):m("",!0),s("button",{onClick:u=>l.toggleStatus(t.id),class:b(["action-btn status-btn",t.is_active?"deactivate":"activate"]),disabled:a.loading},[s("i",{class:b(t.is_active?"fas fa-pause":"fas fa-play")},null,2),p(" "+c(t.is_active?"Deactivate":"Activate"),1)],10,ke),s("button",{onClick:u=>l.editCollector(t),class:"action-btn edit-btn"},e[48]||(e[48]=[s("i",{class:"fas fa-edit"},null,-1),p(" Edit ")]),8,Ce),s("button",{onClick:u=>l.deleteCollector(t.id),class:"action-btn delete-btn",disabled:a.loading},e[49]||(e[49]=[s("i",{class:"fas fa-trash"},null,-1),p(" Delete ")]),8,De)])],2))),128))]))]),a.loading?(d(),i("div",we,e[50]||(e[50]=[s("div",{class:"loading-spinner"},[s("i",{class:"fas fa-spinner fa-spin"}),s("p",null,"Processing...")],-1)]))):m("",!0)])}const Fe=v(D,[["render",Ae],["__scopeId","data-v-33e56b16"]]);export{Fe as default};
