import{_ as L,$ as P,a0 as I,a1 as M,a2 as T,a3 as F,a4 as V,a5 as A,a6 as N,g as p,c as k,o as C,b as a,l as n,q as o,h as B,i as f,t as h,n as w,Q as U,f as v,D as E,L as R,s as z,S as x}from"./app-D_glKhLu.js";import{C as J}from"./vue-select.es-PR_LSJus.js";const O={components:{BTable:N,BButton:A,vSelect:J,BRow:V,BCol:F,BCard:T,BCollapse:M,BModal:I,BPagination:P},computed:{sortIcon(){return this.sortDesc?"fas fa-sort-down":"fas fa-sort-up"},rangeStart(){return this.totalrows===0?0:(this.currentPage-1)*this.perPage+1},rangeEnd(){return this.currentPage*this.perPage>=this.totalrows?this.totalrows:this.currentPage*this.perPage}},data(){return{fields:[{key:"created_at",label:"Date & Time",sortable:!0},{key:"user",label:"User"},{key:"ip_address",label:"Ip Address",sortable:!0},{key:"login_at",label:"Login At"},{key:"logout_at",label:"Logout At"},{key:"login_duration",label:"Login Duration"},{key:"user_agent",label:"User Agent"}],months:[{name:"January",value:1},{name:"February",value:2},{name:"March",value:3},{name:"April",value:4},{name:"May",value:5},{name:"June",value:6},{name:"July",value:7},{name:"August",value:8},{name:"September",value:9},{name:"October",value:10},{name:"November",value:11},{name:"December",value:12}],fetchTeam:[],LoginFilter:{month:new Date().getMonth()+1}}},mounted(){this.LoginFilter.month=new Date().getMonth()+1,this.refetchData()},methods:{formatDate(r){if(!r)return"";const e=new Date(r);if(isNaN(e))return"";const d={year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"};let t=new Intl.DateTimeFormat("en-GB",d).format(e).replace(",",""),i=e.getHours();const s=e.getMinutes();let m="AM";i>=12?(m="PM",i>12&&(i-=12)):(i===0&&(i=12),m="AM");const _=s<10?`0${s}`:s;return t=`${t.replace(/(\d{2}):(\d{2})/,`${i}:${_}`)} ${m}`,t},onSortChanged(r){this.sortBy=r.sortBy,this.sortDesc=r.sortDesc},changeSorting(r){this.sortBy===r?this.sortDesc=!this.sortDesc:(this.sortBy=r,this.sortDesc=!1),this.refetchData()},getSortIcon(r){return this.sortBy===r?this.sortDesc?"fas fa-sort-down":"fas fa-sort-up":"fas fa-sort"}},setup(){const r=v(null),e=v([]),d=v(1),t=v(10),i=v(""),s=v(!1),m=v(0),_=[10,50,75,100],g=v(!1),c=v({month:new Date().getMonth()+1}),y=()=>{c.value.month?(d.value=1,b(),g.value=!1):x.fire({icon:"error",title:"Please Select Month",text:"You must select a month to filter the logs."})},b=()=>{z.get("/login-logs",{params:{month:c.value.month,page:d.value,perPage:t.value,sortBy:i.value,sortDesc:s.value}}).then(u=>{const D=u.data;e.value=Array.isArray(D.data)?D.data:[],m.value=D.total_count,d.value=D.current_page}).catch(u=>{x.fire({icon:"error",title:"Error Fetching Login Logs",text:u.response?u.response.data.message:"Unknown error occurred"})})},S=()=>{d.value=1,c.value.month=new Date().getMonth()+1,b(),g.value=!1},l=E(()=>{if(r.value&&r.value.localItems){const u=r.value.localItems.length;return{from:t.value*(d.value-1)+(u?1:0),to:t.value*(d.value-1)+u,of:m.value}}return{from:0,to:0,of:0}});return R([d,t],()=>{b()}),{refTeamListTable:r,fetchTeam:e,LoginFilterDataSubmit:y,ResetFilter:S,refetchData:b,dataMeta:l,showfilter:g,currentPage:d,perPage:t,totalrows:m,LoginFilter:c,sortBy:i,sortDesc:s,perPageOptions:_}}},Q={class:"dashboard"},Y={class:"list__page"},j={class:"list__title"},q={key:0},G={class:"text-nowrap"},H={class:"mx-2 mb-2"},W={class:"d-flex align-items-center"},K={class:"d-flex align-items-center"},X={class:"showing_pagination_result"},Z={class:"d-flex justify-content-end"};function $(r,e,d,t,i,s){const m=p("b-button"),_=p("v-select"),g=p("b-col"),c=p("b-row"),y=p("b-card"),b=p("b-table"),S=p("b-pagination");return C(),k("div",Q,[a("div",Y,[n(c,null,{default:o(()=>[n(g,{md:"12",lg:"12"},{default:o(()=>[a("div",j,[e[10]||(e[10]=a("h2",null,[a("i",{class:"fas fa-envelope"}),f(" Login Logs")],-1)),n(m,{onClick:e[0]||(e[0]=l=>t.showfilter=!t.showfilter),variant:"primary"},{default:o(()=>e[9]||(e[9]=[f(" Filter ")])),_:1})]),t.showfilter?(C(),k("div",q,[n(y,{class:"filterBox mb-0"},{default:o(()=>[n(c,{class:"p-2"},{default:o(()=>[n(g,{md:"6",xl:"4"},{default:o(()=>[n(_,{options:i.months,modelValue:t.LoginFilter.month,"onUpdate:modelValue":e[1]||(e[1]=l=>t.LoginFilter.month=l),label:"name",reduce:l=>l.value,placeholder:"Select a Month"},null,8,["options","modelValue","reduce"])]),_:1})]),_:1}),n(c,null,{default:o(()=>[n(g,{md:"2",xl:"2"},{default:o(()=>[n(m,{onClick:t.LoginFilterDataSubmit,variant:"primary w-100"},{default:o(()=>e[11]||(e[11]=[f("Search")])),_:1},8,["onClick"])]),_:1}),n(g,{md:"2",xl:"2"},{default:o(()=>[n(m,{onClick:t.ResetFilter,variant:"secondary w-100"},{default:o(()=>e[12]||(e[12]=[f("Reset")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})])):B("",!0),n(y,{"no-body":"",class:"mb-0 mt-2 tblhedclr"},{default:o(()=>[n(b,{responsive:"",ref:"refTeamListTable",items:t.fetchTeam,fields:i.fields,"sort-by":t.sortBy,"sort-desc":t.sortDesc,onSortChanged:s.onSortChanged,class:"mb-2 staticTable","show-empty":"","empty-text":"No matching records found"},{"cell(created_at)":o(l=>[a("span",null,h(s.formatDate(l.value)),1)]),"head(created_at)":o(l=>[a("span",{onClick:e[2]||(e[2]=u=>s.changeSorting("created_at"))},[e[13]||(e[13]=f(" Date & Time ")),a("i",{class:w(s.getSortIcon("created_at"))},null,2)])]),"head(user)":o(l=>[a("span",{onClick:e[3]||(e[3]=u=>s.changeSorting("user"))},[e[14]||(e[14]=f(" User ")),a("i",{class:w(s.getSortIcon("user"))},null,2)])]),"head(ip_address)":o(l=>[a("span",{onClick:e[4]||(e[4]=u=>s.changeSorting("ip_address"))},[e[15]||(e[15]=f(" Ip Address ")),a("i",{class:w(s.getSortIcon("ip_address"))},null,2)])]),"cell(login_at)":o(l=>[a("span",null,h(s.formatDate(l.value)),1)]),"head(login_at)":o(l=>[a("span",{onClick:e[5]||(e[5]=u=>s.changeSorting("login_at"))},[e[16]||(e[16]=f(" Login At ")),a("i",{class:w(s.getSortIcon("login_at"))},null,2)])]),"cell(logout_at)":o(l=>[a("span",null,h(s.formatDate(l.value)),1)]),"head(logout_at)":o(l=>[a("span",{onClick:e[6]||(e[6]=u=>s.changeSorting("logout_at"))},[e[17]||(e[17]=f(" Date & Time ")),a("i",{class:w(s.getSortIcon("logout_at"))},null,2)])]),"cell(user)":o(l=>[a("div",G,h(l.item.user_name),1)]),_:1},8,["items","fields","sort-by","sort-desc","onSortChanged"]),a("div",H,[n(c,{class:"align-items-center"},{default:o(()=>[n(g,{cols:"12",md:"4"},{default:o(()=>[a("div",W,[e[18]||(e[18]=a("span",{class:"mr-2 showing_pagination_result"},"Show",-1)),n(_,{modelValue:t.perPage,"onUpdate:modelValue":e[7]||(e[7]=l=>t.perPage=l),options:t.perPageOptions,clearable:!1,class:"mr-2"},null,8,["modelValue","options"]),e[19]||(e[19]=a("span",{class:"showing_pagination_result"},"entries",-1))])]),_:1}),n(g,{cols:"12",md:"4"},{default:o(()=>[a("div",K,[a("span",X,"Showing "+h(s.rangeStart)+" to "+h(s.rangeEnd)+" of "+h(t.totalrows)+" entries",1)])]),_:1}),n(g,{cols:"12",md:"4"},{default:o(()=>[a("div",Z,[t.totalrows>0?(C(),U(S,{key:0,modelValue:t.currentPage,"onUpdate:modelValue":e[8]||(e[8]=l=>t.currentPage=l),"total-rows":t.totalrows,"per-page":t.perPage,onInput:t.refetchData,pills:"","first-number":"","last-number":"","prev-class":"prev-item","next-class":"next-item"},{"prev-text":o(()=>e[20]||(e[20]=[a("i",{class:"fa-solid fa-angles-left"},null,-1)])),"next-text":o(()=>e[21]||(e[21]=[a("i",{class:"fa-solid fa-angles-right"},null,-1)])),_:1},8,["modelValue","total-rows","per-page","onInput"])):B("",!0)])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1})])])}const ae=L(O,[["render",$]]);export{ae as default};
