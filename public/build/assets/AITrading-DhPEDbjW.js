import{A as _}from"./AdminMobileNav-DI3t1v3n.js";import{_ as U,g as p,c as r,o as d,b as e,h as m,i as u,n as v,t as o,j as w,v as k,F as f,r as b,l as y,w as C}from"./app-BFj7m03g.js";const T={name:"AITrading",components:{AdminMobileNav:_},data(){return{users:[],isLoading:!1,searchQuery:"",activeFilter:"all",currentPage:1,itemsPerPage:20,filters:[{label:"All",value:"all"},{label:"Active",value:"A"},{label:"Inactive",value:"I"},{label:"New",value:"new"}],apiBaseUrl:`${window.location.origin}/api`,showUserModal:!1,selectedUser:null}},computed:{filteredUsers(){let t=this.users;if(this.searchQuery){const s=this.searchQuery.toLowerCase();t=t.filter(n=>n.name.toLowerCase().includes(s)||n.email.toLowerCase().includes(s)||n.id.toString().includes(s))}if(this.activeFilter!=="all")switch(this.activeFilter){case"A":t=t.filter(n=>n.status==="A");break;case"I":t=t.filter(n=>n.status==="I");break;case"new":const s=new Date;s.setMonth(s.getMonth()-1),t=t.filter(n=>new Date(n.created_at)>s);break}return t},paginatedUsers(){const t=(this.currentPage-1)*this.itemsPerPage,s=t+this.itemsPerPage;return this.filteredUsers.slice(t,s)},totalPages(){return Math.ceil(this.filteredUsers.length/this.itemsPerPage)},visiblePages(){const t=[];let n=Math.max(1,this.currentPage-Math.floor(2.5)),c=Math.min(this.totalPages,n+5-1);c-n+1<5&&(n=Math.max(1,c-5+1));for(let i=n;i<=c;i++)t.push(i);return t},totalUsers(){return this.users.length},totalBalance(){return this.users.reduce((t,s)=>t+(parseFloat(s.total_balance)||0),0)},activeUsers(){return this.users.filter(t=>t.status==="A").length},newUsers(){const t=new Date;return t.setMonth(t.getMonth()-1),this.users.filter(s=>new Date(s.created_at)>t).length}},mounted(){this.fetchUsers()},methods:{async fetchUsers(){var t,s;this.isLoading=!0;try{const n=localStorage.getItem("access_token");if(!n)throw new Error("No authentication token found");const c=await fetch(`${this.apiBaseUrl}/users`,{method:"GET",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json",Accept:"application/json"}});if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);const i=await c.json();if(i.success&&i.data)this.users=i.data.filter(a=>!a.is_admin).map(a=>({id:a.id,name:a.name,email:a.email,total_balance:a.total_balance||0,status:a.status||"I",created_at:a.created_at,phone:a.phone,is_admin:a.is_admin||0,profile_image:a.profile_image}));else throw new Error(i.message||"Failed to fetch users")}catch(n){console.error("Error fetching users:",n),(s=(t=this.$toast)==null?void 0:t.error)==null||s.call(t,n.message||"Failed to fetch users"),this.users=[]}finally{this.isLoading=!1}},refreshUsers(){this.fetchUsers()},getProfileImageUrl(t){return t?t.startsWith("http")?t:`${window.location.origin}/storage/${t}`:"/build/assets/tableprofileimg-DaN7tIxX.png"},handleProfileImageError(t,s){console.log(`Profile image failed to load for ${s}, creating initials fallback`),console.log("Failed image src:",t.target.src),t.target.style.display="none";const n=s.split(" ").map(i=>i[0]).join("").toUpperCase().substring(0,3),c=document.createElement("div");c.className="profile-initials-fallback",c.textContent=n,c.style.cssText=`
        width: 48px;
        height: 48px;
        border-radius: 50%;
        background: linear-gradient(135deg, #00ff80, #00cc66);
        color: #000;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 16px;
        border: 3px solid #00ff80;
      `,t.target.parentNode.appendChild(c)},getUserInitials(t){return t.split(" ").map(s=>s[0]).join("").toUpperCase()},getBalanceStatus(t){const s=parseFloat(t)||0;return s>5e4?"high":s>2e4?"medium":"low"},getBalanceStatusText(t){const s=parseFloat(t)||0;return s>5e4?"High Balance":s>2e4?"Medium Balance":"Low Balance"},getUserStatus(t){return t==="A"?"active":"inactive"},getUserStatusText(t){return t==="A"?"Active":"Inactive"},formatDate(t){return new Date(t).toLocaleDateString("en-IN")},formatTime(t){return new Date(t).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})},viewUserDetails(t){console.log("View user details:",t),this.selectedUser=t,this.showUserModal=!0},tradeWithUser(t){var s,n;console.log("Trade with AI for user:",t),(n=(s=this.$toast)==null?void 0:s.success)==null||n.call(s,`Initiating AI Trading session for ${t.name}`),this.$router.push({name:"ai_trading_session",query:{userId:t.id,userName:t.name,userBalance:t.total_balance,userEmail:t.email}})},closeUserModal(){this.showUserModal=!1,this.selectedUser=null},deleteUser(t){confirm(`Are you sure you want to delete ${t.name}?`)&&(console.log("Delete user:",t),this.users=this.users.filter(s=>s.id!==t.id))},navigateTo(t){this.$router.push({name:t})}}},M={class:"ai-trading-screen"},x={class:"page-header"},A={class:"header-actions"},I=["disabled"],P={class:"stats-grid"},B={class:"stat-card"},D={class:"stat-content"},S={class:"stat-number"},N={class:"stat-card"},L={class:"stat-content"},F={class:"stat-number"},E={class:"stat-card"},V={class:"stat-content"},j={class:"stat-number"},Q={class:"stat-card"},W={class:"stat-content"},q={class:"stat-number"},R={class:"search-filters"},z={class:"search-box"},H={class:"filter-buttons"},G=["onClick"],J={class:"users-grid-container"},X={key:0,class:"loading-container"},K={key:1,class:"no-data"},O={key:2,class:"users-grid"},Y={class:"card-header"},Z={class:"user-avatar"},$=["src","alt","onError","onLoad"],ss={key:1,class:"avatar-text"},es={class:"user-status"},ts={class:"user-info"},as={class:"user-name"},ls={class:"user-mobile"},is={class:"user-id"},ns={class:"balance-section"},os={class:"balance-amount"},rs={class:"card-actions"},ds=["onClick"],cs=["onClick"],us={key:3,class:"pagination"},vs=["disabled"],gs={class:"page-numbers"},ms=["onClick"],fs=["disabled"],bs={class:"modal-header"},hs={key:0,class:"modal-body"},_s={class:"user-profile-section"},Us={class:"profile-avatar"},ps={class:"avatar-text-large"},ws={class:"profile-info"},ks={class:"profile-name"},ys={class:"profile-status"},Cs={class:"details-grid"},Ts={class:"detail-item"},Ms={class:"detail-value"},xs={class:"detail-item"},As={class:"detail-value"},Is={class:"detail-item"},Ps={class:"detail-value"},Bs={class:"detail-item"},Ds={class:"detail-value"},Ss={class:"detail-item"},Ns={class:"detail-value balance-highlight"},Ls={class:"detail-item"},Fs={class:"detail-value"},Es={class:"modal-actions"},Vs={class:"mobile-bottom-nav"};function js(t,s,n,c,i,a){const h=p("AdminMobileNav");return d(),r("div",M,[e("div",x,[s[15]||(s[15]=e("div",{class:"header-content"},[e("h1",{class:"page-title"},"🤖 AI Trading - Regular Users"),e("p",{class:"page-subtitle"},"Manage regular users (non-admin) in AI trading cart")],-1)),e("div",A,[e("button",{class:"refresh-btn",onClick:s[0]||(s[0]=(...l)=>a.refreshUsers&&a.refreshUsers(...l)),disabled:i.isLoading},[e("i",{class:v(["fas fa-sync-alt",{"fa-spin":i.isLoading}])},null,2),u(" "+o(i.isLoading?"Loading...":"Refresh"),1)],8,I)])]),e("div",P,[e("div",B,[s[17]||(s[17]=e("div",{class:"stat-icon"},"👥",-1)),e("div",D,[e("div",S,o(a.totalUsers),1),s[16]||(s[16]=e("div",{class:"stat-label"},"Regular Users",-1))])]),e("div",N,[s[19]||(s[19]=e("div",{class:"stat-icon"},"💰",-1)),e("div",L,[e("div",F,"₹"+o(a.totalBalance.toLocaleString()),1),s[18]||(s[18]=e("div",{class:"stat-label"},"Total Balance",-1))])]),e("div",E,[s[21]||(s[21]=e("div",{class:"stat-icon"},"📈",-1)),e("div",V,[e("div",j,o(a.activeUsers),1),s[20]||(s[20]=e("div",{class:"stat-label"},"Active Users",-1))])]),e("div",Q,[s[23]||(s[23]=e("div",{class:"stat-icon"},"🆕",-1)),e("div",W,[e("div",q,o(a.newUsers),1),s[22]||(s[22]=e("div",{class:"stat-label"},"New This Month",-1))])])]),e("div",R,[e("div",z,[s[24]||(s[24]=e("i",{class:"fas fa-search search-icon"},null,-1)),w(e("input",{"onUpdate:modelValue":s[1]||(s[1]=l=>i.searchQuery=l),type:"text",placeholder:"Search users by name, mobile, or ID...",class:"search-input"},null,512),[[k,i.searchQuery]])]),e("div",H,[(d(!0),r(f,null,b(i.filters,l=>(d(),r("button",{key:l.value,class:v(["filter-btn",{active:i.activeFilter===l.value}]),onClick:g=>i.activeFilter=l.value},o(l.label),11,G))),128))])]),e("div",J,[y(h),i.isLoading?(d(),r("div",X,s[25]||(s[25]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"Loading users...",-1)]))):a.filteredUsers.length===0?(d(),r("div",K,[s[26]||(s[26]=e("div",{class:"no-data-icon"},"👥",-1)),s[27]||(s[27]=e("h3",null,"No Users Found",-1)),e("p",null,o(i.searchQuery?"Try adjusting your search terms":"No users available at the moment"),1)])):(d(),r("div",O,[(d(!0),r(f,null,b(a.paginatedUsers,l=>(d(),r("div",{key:l.id,class:"user-card"},[e("div",Y,[e("div",Z,[l.profile_image?(d(),r("img",{key:0,src:a.getProfileImageUrl(l.profile_image),alt:l.name,onError:g=>a.handleProfileImageError(g,l.name),onLoad:()=>console.log("Profile image loaded successfully for:",l.name)},null,40,$)):(d(),r("span",ss,o(a.getUserInitials(l.name)),1))]),e("div",es,[e("span",{class:v(["status-badge",a.getUserStatus(l.status)])},o(a.getUserStatusText(l.status)),3)])]),e("div",ts,[e("h3",as,o(l.name),1),e("p",ls,[s[28]||(s[28]=e("i",{class:"fas fa-mobile-alt"},null,-1)),u(" "+o(l.phone||"No Mobile"),1)]),e("div",is,"ID: "+o(l.id),1)]),e("div",ns,[s[29]||(s[29]=e("div",{class:"balance-label"},"Total Balance",-1)),e("div",os,"₹"+o(l.total_balance||"0.00"),1),e("div",{class:v(["balance-status",a.getBalanceStatus(l.total_balance)])},o(a.getBalanceStatusText(l.total_balance)),3)]),e("div",rs,[e("button",{class:"action-btn view-btn",onClick:g=>a.viewUserDetails(l)},s[30]||(s[30]=[e("i",{class:"fas fa-eye"},null,-1),u(" View Details ")]),8,ds),e("button",{class:"action-btn trade-btn",onClick:g=>a.tradeWithUser(l)},s[31]||(s[31]=[e("i",{class:"fas fa-robot"},null,-1),u(" Trade with AI ")]),8,cs)])]))),128))])),a.totalPages>1?(d(),r("div",us,[e("button",{class:"page-btn",disabled:i.currentPage===1,onClick:s[2]||(s[2]=l=>i.currentPage=i.currentPage-1)},s[32]||(s[32]=[e("i",{class:"fas fa-chevron-left"},null,-1)]),8,vs),e("div",gs,[(d(!0),r(f,null,b(a.visiblePages,l=>(d(),r("button",{key:l,class:v(["page-btn",{active:l===i.currentPage}]),onClick:g=>i.currentPage=l},o(l),11,ms))),128))]),e("button",{class:"page-btn",disabled:i.currentPage===a.totalPages,onClick:s[3]||(s[3]=l=>i.currentPage=i.currentPage+1)},s[33]||(s[33]=[e("i",{class:"fas fa-chevron-right"},null,-1)]),8,fs)])):m("",!0)]),i.showUserModal?(d(),r("div",{key:0,class:"modal-overlay",onClick:s[8]||(s[8]=(...l)=>a.closeUserModal&&a.closeUserModal(...l))},[e("div",{class:"modal-content",onClick:s[7]||(s[7]=C(()=>{},["stop"]))},[e("div",bs,[s[35]||(s[35]=e("h2",{class:"modal-title"},"👤 User Details",-1)),e("button",{class:"modal-close",onClick:s[4]||(s[4]=(...l)=>a.closeUserModal&&a.closeUserModal(...l))},s[34]||(s[34]=[e("i",{class:"fas fa-times"},null,-1)]))]),i.selectedUser?(d(),r("div",hs,[e("div",_s,[e("div",Us,[e("span",ps,o(a.getUserInitials(i.selectedUser.name)),1)]),e("div",ws,[e("h3",ks,o(i.selectedUser.name),1),e("p",ys,[e("span",{class:v(["status-badge",a.getUserStatus(i.selectedUser.status)])},o(a.getUserStatusText(i.selectedUser.status)),3)])])]),e("div",Cs,[e("div",Ts,[s[36]||(s[36]=e("div",{class:"detail-label"},[e("i",{class:"fas fa-id-card"}),u(" User ID ")],-1)),e("div",Ms,o(i.selectedUser.id),1)]),e("div",xs,[s[37]||(s[37]=e("div",{class:"detail-label"},[e("i",{class:"fas fa-envelope"}),u(" Email Address ")],-1)),e("div",As,o(i.selectedUser.email),1)]),e("div",Is,[s[38]||(s[38]=e("div",{class:"detail-label"},[e("i",{class:"fas fa-mobile-alt"}),u(" Mobile Number ")],-1)),e("div",Ps,o(i.selectedUser.phone||"Not provided"),1)]),e("div",Bs,[s[39]||(s[39]=e("div",{class:"detail-label"},[e("i",{class:"fas fa-calendar-alt"}),u(" Joined Date ")],-1)),e("div",Ds,o(a.formatDate(i.selectedUser.created_at)),1)]),e("div",Ss,[s[40]||(s[40]=e("div",{class:"detail-label"},[e("i",{class:"fas fa-wallet"}),u(" Current Balance ")],-1)),e("div",Ns,"₹"+o(i.selectedUser.total_balance||"0.00"),1)]),e("div",Ls,[s[41]||(s[41]=e("div",{class:"detail-label"},[e("i",{class:"fas fa-chart-line"}),u(" Balance Status ")],-1)),e("div",Fs,[e("span",{class:v(["balance-status-badge",a.getBalanceStatus(i.selectedUser.total_balance)])},o(a.getBalanceStatusText(i.selectedUser.total_balance)),3)])])]),e("div",Es,[e("button",{class:"action-btn trade-btn-large",onClick:s[5]||(s[5]=l=>a.tradeWithUser(i.selectedUser))},s[42]||(s[42]=[e("i",{class:"fas fa-robot"},null,-1),u(" Start AI Trading ")])),e("button",{class:"action-btn close-btn",onClick:s[6]||(s[6]=(...l)=>a.closeUserModal&&a.closeUserModal(...l))},s[43]||(s[43]=[e("i",{class:"fas fa-times"},null,-1),u(" Close ")]))])])):m("",!0)])])):m("",!0),e("div",Vs,[e("div",{class:"nav-item",onClick:s[9]||(s[9]=l=>a.navigateTo("admin_dashboard"))},s[44]||(s[44]=[e("div",{class:"nav-icon"},"🏠",-1),e("span",{class:"nav-label"},"Home",-1)])),e("div",{class:"nav-item",onClick:s[10]||(s[10]=l=>a.navigateTo("register_request"))},s[45]||(s[45]=[e("div",{class:"nav-icon"},"📝",-1),e("span",{class:"nav-label"},"Register",-1)])),e("div",{class:"nav-item",onClick:s[11]||(s[11]=l=>a.navigateTo("money_request"))},s[46]||(s[46]=[e("div",{class:"nav-icon"},"💰",-1),e("span",{class:"nav-label"},"Wallet",-1)])),e("div",{class:"nav-item",onClick:s[12]||(s[12]=l=>a.navigateTo("user_management"))},s[47]||(s[47]=[e("div",{class:"nav-icon"},"👥",-1),e("span",{class:"nav-label"},"Users",-1)])),e("div",{class:"nav-item",onClick:s[13]||(s[13]=l=>a.navigateTo("withdrawal_request"))},s[48]||(s[48]=[e("div",{class:"nav-icon"},"💳",-1),e("span",{class:"nav-label"},"Withdraw",-1)])),e("div",{class:"nav-item",onClick:s[14]||(s[14]=l=>a.navigateTo("analytics"))},s[49]||(s[49]=[e("div",{class:"nav-icon"},"📊",-1),e("span",{class:"nav-label"},"Analytics",-1)])),s[50]||(s[50]=e("div",{class:"nav-item active"},[e("div",{class:"nav-icon"},"🤖"),e("span",{class:"nav-label"},"AI Trading")],-1))])])}const qs=U(T,[["render",js],["__scopeId","data-v-7fbfe951"]]);export{qs as default};
