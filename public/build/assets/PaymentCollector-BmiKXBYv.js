import{_ as k,g as C,c as i,o as d,b as s,l as D,h as c,i as p,t as m,w as _,j as f,v as g,p as A,F as I,r as w,X as b,n as h}from"./app-BFj7m03g.js";import{A as F}from"./AdminMobileNav-DI3t1v3n.js";const P={name:"PaymentCollector",components:{AdminMobileNav:F},data(){return{loading:!1,showAddForm:!1,editingCollector:null,paymentCollectors:[],formData:{bank_name:"",account_holder_name:"",account_number:"",ifsc_code:"",branch_name:"",barcode_image:"",qr_code:"",is_primary:!1,notes:""}}},mounted(){this.loadPaymentCollectors()},methods:{async loadPaymentCollectors(){var o;try{this.loading=!0;const e=localStorage.getItem("access_token"),r=await b.get("/api/admin-payment-collectors",{headers:{Authorization:`Bearer ${e}`,Accept:"application/json"}});r.data.success&&(this.paymentCollectors=r.data.data)}catch(e){console.error("Error loading payment collectors:",e),(o=this.$toast)==null||o.error("Failed to load payment collectors")}finally{this.loading=!1}},async submitForm(){var o,e,r,n,a,l;if(!this.formData.qr_code||!this.formData.qr_code.trim()){(o=this.$toast)==null||o.error("QR Code/UPI ID is required");return}if(!this.formData.barcode_image){(e=this.$toast)==null||e.error("Barcode/QR Image is required");return}try{this.loading=!0;const y=localStorage.getItem("access_token"),t=this.editingCollector?`/api/admin-payment-collectors/${this.editingCollector.id}`:"/api/admin-payment-collectors",u=this.editingCollector?"PUT":"POST",v=await b({method:u,url:t,data:this.formData,headers:{Authorization:`Bearer ${y}`,Accept:"application/json","Content-Type":"application/json"}});v.data.success&&((r=this.$toast)==null||r.success(v.data.message),this.closeForm(),await this.loadPaymentCollectors())}catch(y){console.error("Error saving payment collector:",y),(l=this.$toast)==null||l.error(((a=(n=y.response)==null?void 0:n.data)==null?void 0:a.message)||"Failed to save payment collector")}finally{this.loading=!1}},async markAsPrimary(o){var e,r;try{this.loading=!0;const n=localStorage.getItem("access_token");(await b.patch(`/api/admin-payment-collectors/${o}/primary`,{},{headers:{Authorization:`Bearer ${n}`,Accept:"application/json"}})).data.success&&((e=this.$toast)==null||e.success("Payment method marked as primary"),await this.loadPaymentCollectors())}catch(n){console.error("Error marking as primary:",n),(r=this.$toast)==null||r.error("Failed to mark as primary")}finally{this.loading=!1}},async toggleStatus(o){var e,r;try{this.loading=!0;const n=localStorage.getItem("access_token");(await b.patch(`/api/admin-payment-collectors/${o}/toggle-status`,{},{headers:{Authorization:`Bearer ${n}`,Accept:"application/json"}})).data.success&&((e=this.$toast)==null||e.success("Status updated successfully"),await this.loadPaymentCollectors())}catch(n){console.error("Error toggling status:",n),(r=this.$toast)==null||r.error("Failed to update status")}finally{this.loading=!1}},async deleteCollector(o){var e,r;if(confirm("Are you sure you want to delete this payment method?"))try{this.loading=!0;const n=localStorage.getItem("access_token");(await b.delete(`/api/admin-payment-collectors/${o}`,{headers:{Authorization:`Bearer ${n}`,Accept:"application/json"}})).data.success&&((e=this.$toast)==null||e.success("Payment method deleted successfully"),await this.loadPaymentCollectors())}catch(n){console.error("Error deleting payment collector:",n),(r=this.$toast)==null||r.error("Failed to delete payment method")}finally{this.loading=!1}},editCollector(o){this.editingCollector=o,this.formData={...o},this.showAddForm=!1},closeForm(){this.showAddForm=!1,this.editingCollector=null,this.resetForm()},resetForm(){this.formData={bank_name:"",account_holder_name:"",account_number:"",ifsc_code:"",branch_name:"",barcode_image:"",qr_code:"",is_primary:!1,notes:""}},handleFileUpload(o){const e=o.target.files[0];if(e){const r=new FileReader;r.onload=n=>{this.formData.barcode_image=n.target.result},r.readAsDataURL(e)}},removeImage(){this.formData.barcode_image="",this.$refs.fileInput.value=""},getImageSrc(o){return o?o.startsWith("data:")?o:`${window.location.origin}/storage/${o}`:""},maskAccountNumber(o){if(!o)return"";const e=o.length;return e<=4?o:"*".repeat(e-4)+o.slice(-4)},handleImageError(o){console.error("Image failed to load:",o.target.src),o.target.style.display="none";const e=o.target.parentNode;if(!e.querySelector(".image-error")){const r=document.createElement("div");r.className="image-error",r.innerHTML='<i class="fas fa-exclamation-triangle"></i> Image not available',e.appendChild(r)}},handleImageLoad(o){console.log("Image loaded successfully:",o.target.src)},navigateTo(o){this.$router.push(o)}}},x={class:"payment-collector-screen"},B={class:"page-header"},S={class:"header-content"},U={class:"header-left"},M={class:"header-right"},N={class:"modal-header"},q={class:"form-grid"},E={class:"form-group"},V={class:"form-group"},R={class:"form-group"},T={class:"form-group"},Q={class:"form-group"},j={class:"form-group"},L={class:"form-group full-width"},z={class:"file-upload-area"},H={key:0,class:"upload-placeholder"},O={key:1,class:"image-preview"},W=["src"],X={class:"form-group full-width"},G={class:"form-group full-width"},J={class:"checkbox-label"},K={class:"form-actions"},Y=["disabled"],Z={key:0,class:"fas fa-spinner fa-spin"},$={class:"collectors-section"},ee={class:"section-header"},se={class:"collectors-count"},te={key:0,class:"empty-state"},ae={key:1,class:"collectors-grid"},oe={class:"card-header"},le={class:"bank-info"},re={class:"bank-name"},ne={class:"account-holder"},ie={class:"card-badges"},de={key:0,class:"badge primary"},me={class:"card-content"},ce={class:"account-details"},ue={class:"detail-row"},pe={class:"value"},fe={class:"detail-row"},ge={class:"value"},ye={key:0,class:"detail-row"},be={class:"value"},he={key:1,class:"detail-row"},ve={class:"value"},_e={key:0,class:"barcode-section"},ke=["src"],Ce={key:1,class:"notes-section"},De={class:"notes-text"},Ae={class:"card-actions"},Ie=["onClick","disabled"],we=["onClick","disabled"],Fe=["onClick"],Pe=["onClick","disabled"],xe={key:1,class:"loading-overlay"};function Be(o,e,r,n,a,l){const y=C("AdminMobileNav");return d(),i("div",x,[s("div",B,[s("div",S,[s("div",U,[s("button",{class:"back-btn",onClick:e[0]||(e[0]=t=>l.navigateTo("/admin/dashboard"))},e[20]||(e[20]=[s("i",{class:"fas fa-arrow-left"},null,-1)])),e[21]||(e[21]=s("div",{class:"header-info"},[s("h1",{class:"page-title"},"ðŸ’³ Payment Collector"),s("p",{class:"page-subtitle"},"Manage payment collection details and bank accounts")],-1))]),s("div",M,[s("button",{class:"add-btn",onClick:e[1]||(e[1]=t=>a.showAddForm=!0)},e[22]||(e[22]=[s("i",{class:"fas fa-plus"},null,-1),p(" Add Payment Details ")]))])])]),D(y),a.showAddForm||a.editingCollector?(d(),i("div",{key:0,class:"modal-overlay",onClick:e[16]||(e[16]=(...t)=>l.closeForm&&l.closeForm(...t))},[s("div",{class:"modal-content",onClick:e[15]||(e[15]=_(()=>{},["stop"]))},[s("div",N,[s("h3",null,m(a.editingCollector?"Edit":"Add")+" Payment Details",1),s("button",{class:"close-btn",onClick:e[2]||(e[2]=(...t)=>l.closeForm&&l.closeForm(...t))},e[23]||(e[23]=[s("i",{class:"fas fa-times"},null,-1)]))]),s("form",{onSubmit:e[14]||(e[14]=_((...t)=>l.submitForm&&l.submitForm(...t),["prevent"])),class:"payment-form",novalidate:""},[s("div",q,[s("div",E,[e[24]||(e[24]=s("label",{class:"form-label"},"Bank Name",-1)),f(s("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>a.formData.bank_name=t),type:"text",class:"form-input",placeholder:"e.g., State Bank of India"},null,512),[[g,a.formData.bank_name]])]),s("div",V,[e[25]||(e[25]=s("label",{class:"form-label"},"Account Holder Name",-1)),f(s("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>a.formData.account_holder_name=t),type:"text",class:"form-input",placeholder:"e.g., Macxgain Technologies"},null,512),[[g,a.formData.account_holder_name]])]),s("div",R,[e[26]||(e[26]=s("label",{class:"form-label"},"Account Number",-1)),f(s("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>a.formData.account_number=t),type:"text",class:"form-input",placeholder:"e.g., 1234567890123456"},null,512),[[g,a.formData.account_number]])]),s("div",T,[e[27]||(e[27]=s("label",{class:"form-label"},"IFSC Code",-1)),f(s("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>a.formData.ifsc_code=t),type:"text",class:"form-input",placeholder:"e.g., SBIN0001234"},null,512),[[g,a.formData.ifsc_code]])]),s("div",Q,[e[28]||(e[28]=s("label",{class:"form-label"},"Branch Name",-1)),f(s("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>a.formData.branch_name=t),type:"text",class:"form-input",placeholder:"e.g., Mumbai Main Branch"},null,512),[[g,a.formData.branch_name]])]),s("div",j,[e[29]||(e[29]=s("label",{class:"form-label"},"QR Code/UPI ID *",-1)),f(s("input",{"onUpdate:modelValue":e[8]||(e[8]=t=>a.formData.qr_code=t),type:"text",class:"form-input",placeholder:"e.g., macxgain@paytm or UPI QR code data",required:""},null,512),[[g,a.formData.qr_code]])])]),s("div",L,[e[32]||(e[32]=s("label",{class:"form-label"},"Barcode/QR Image *",-1)),s("div",z,[s("input",{type:"file",ref:"fileInput",onChange:e[9]||(e[9]=(...t)=>l.handleFileUpload&&l.handleFileUpload(...t)),accept:"image/*",class:"file-input",required:""},null,544),a.formData.barcode_image?c("",!0):(d(),i("div",H,e[30]||(e[30]=[s("i",{class:"fas fa-cloud-upload-alt"},null,-1),s("p",null,"Click to upload barcode/QR image",-1)]))),a.formData.barcode_image?(d(),i("div",O,[s("img",{src:l.getImageSrc(a.formData.barcode_image),alt:"Barcode Preview"},null,8,W),s("button",{type:"button",onClick:e[10]||(e[10]=(...t)=>l.removeImage&&l.removeImage(...t)),class:"remove-img-btn"},e[31]||(e[31]=[s("i",{class:"fas fa-times"},null,-1)]))])):c("",!0)])]),s("div",X,[e[33]||(e[33]=s("label",{class:"form-label"},"Notes",-1)),f(s("textarea",{"onUpdate:modelValue":e[11]||(e[11]=t=>a.formData.notes=t),class:"form-textarea",placeholder:"Additional notes or instructions...",rows:"3"},null,512),[[g,a.formData.notes]])]),s("div",G,[s("label",J,[f(s("input",{"onUpdate:modelValue":e[12]||(e[12]=t=>a.formData.is_primary=t),type:"checkbox",class:"form-checkbox"},null,512),[[A,a.formData.is_primary]]),e[34]||(e[34]=s("span",{class:"checkbox-text"},"Mark as Primary Payment Method",-1))])]),s("div",K,[s("button",{type:"button",onClick:e[13]||(e[13]=(...t)=>l.closeForm&&l.closeForm(...t)),class:"btn-cancel"}," Cancel "),s("button",{type:"submit",class:"btn-submit",disabled:a.loading},[a.loading?(d(),i("i",Z)):c("",!0),p(" "+m(a.editingCollector?"Update":"Add")+" Payment Details ",1)],8,Y)])],32)])])):c("",!0),s("div",$,[s("div",ee,[e[35]||(e[35]=s("h2",null,"Payment Collection Methods",-1)),s("div",se,m(a.paymentCollectors.length)+" methods configured",1)]),a.paymentCollectors.length===0?(d(),i("div",te,[e[37]||(e[37]=s("div",{class:"empty-icon"},"ðŸ’³",-1)),e[38]||(e[38]=s("h3",null,"No Payment Methods",-1)),e[39]||(e[39]=s("p",null,"Add your first payment collection method to get started",-1)),s("button",{class:"btn-primary",onClick:e[17]||(e[17]=t=>a.showAddForm=!0)},e[36]||(e[36]=[s("i",{class:"fas fa-plus"},null,-1),p(" Add Payment Method ")]))])):(d(),i("div",ae,[(d(!0),i(I,null,w(a.paymentCollectors,t=>(d(),i("div",{key:t.id,class:h(["collector-card",{primary:t.is_primary,inactive:!t.is_active}])},[s("div",oe,[s("div",le,[s("h3",re,m(t.bank_name),1),s("div",ne,m(t.account_holder_name),1)]),s("div",ie,[t.is_primary?(d(),i("span",de,e[40]||(e[40]=[s("i",{class:"fas fa-star"},null,-1),p(" Primary ")]))):c("",!0),s("span",{class:h(["badge",t.is_active?"active":"inactive"])},m(t.is_active?"Active":"Inactive"),3)])]),s("div",me,[s("div",ce,[s("div",ue,[e[41]||(e[41]=s("span",{class:"label"},"Account Number:",-1)),s("span",pe,m(l.maskAccountNumber(t.account_number)),1)]),s("div",fe,[e[42]||(e[42]=s("span",{class:"label"},"IFSC Code:",-1)),s("span",ge,m(t.ifsc_code),1)]),t.branch_name?(d(),i("div",ye,[e[43]||(e[43]=s("span",{class:"label"},"Branch:",-1)),s("span",be,m(t.branch_name),1)])):c("",!0),t.qr_code?(d(),i("div",he,[e[44]||(e[44]=s("span",{class:"label"},"UPI/QR:",-1)),s("span",ve,m(t.qr_code),1)])):c("",!0)]),t.barcode_image?(d(),i("div",_e,[e[45]||(e[45]=s("div",{class:"barcode-label"},"Payment QR/Barcode:",-1)),s("img",{src:l.getImageSrc(t.barcode_image),alt:"Payment Barcode",class:"barcode-image",onError:e[18]||(e[18]=(...u)=>l.handleImageError&&l.handleImageError(...u)),onLoad:e[19]||(e[19]=(...u)=>l.handleImageLoad&&l.handleImageLoad(...u))},null,40,ke)])):c("",!0),t.notes?(d(),i("div",Ce,[e[46]||(e[46]=s("div",{class:"notes-label"},"Notes:",-1)),s("div",De,m(t.notes),1)])):c("",!0)]),s("div",Ae,[!t.is_primary&&t.is_active?(d(),i("button",{key:0,onClick:u=>l.markAsPrimary(t.id),class:"action-btn primary-btn",disabled:a.loading},e[47]||(e[47]=[s("i",{class:"fas fa-star"},null,-1),p(" Make Primary ")]),8,Ie)):c("",!0),s("button",{onClick:u=>l.toggleStatus(t.id),class:h(["action-btn status-btn",t.is_active?"deactivate":"activate"]),disabled:a.loading},[s("i",{class:h(t.is_active?"fas fa-pause":"fas fa-play")},null,2),p(" "+m(t.is_active?"Deactivate":"Activate"),1)],10,we),s("button",{onClick:u=>l.editCollector(t),class:"action-btn edit-btn"},e[48]||(e[48]=[s("i",{class:"fas fa-edit"},null,-1),p(" Edit ")]),8,Fe),s("button",{onClick:u=>l.deleteCollector(t.id),class:"action-btn delete-btn",disabled:a.loading},e[49]||(e[49]=[s("i",{class:"fas fa-trash"},null,-1),p(" Delete ")]),8,Pe)])],2))),128))]))]),a.loading?(d(),i("div",xe,e[50]||(e[50]=[s("div",{class:"loading-spinner"},[s("i",{class:"fas fa-spinner fa-spin"}),s("p",null,"Processing...")],-1)]))):c("",!0)])}const Me=k(P,[["render",Be],["__scopeId","data-v-23f3bcf7"]]);export{Me as default};
