https://learn.microsoft.com/en-gb/graph/tutorials/php?WT.mc_id=Portal-Microsoft_AAD_RegisteredApps&tabs=aad&tutorial-step=1

https://learn.microsoft.com/en-us/graph/tutorials/php-app-only?tabs=aad
create a account a azure on  https://portal.azure.com
1. Navigate to Azure Active Directory > App registrations.
       https://portal.azure.com/#view/Microsoft_AAD_RegisteredApps/ApplicationsListBlade

2. Set Up API Permissions
        https://portal.azure.com/#view/Microsoft_AAD_RegisteredApps/ApplicationMenuBlade/~/CallAnAPI/appId/14a36c7b-7f25-497f-8ee3-9f768181cb2b/objectId/8f1a6223-32c9-44a5-a162-b9767cca92bb/isMSAApp~/false/defaultBlade/Overview/appSignInAudience/AzureADMultipleOrgs/servicePrincipalCreated~/true

    a. In API permissions, add Microsoft Graph API permissions.
    b. For basic access, add permissions like User.Read.
    c. Use Delegated permissions for accessing resources on behalf of the signed-in user.

    d. Go to Certificates & secrets, add a new client secret, and note it down securely (youâ€™ll use it in the Laravel backend).
        click here:- https://portal.azure.com/#view/Microsoft_AAD_RegisteredApps/ApplicationMenuBlade/~/Credentials/appId/14a36c7b-7f25-497f-8ee3-9f768181cb2b/objectId/8f1a6223-32c9-44a5-a162-b9767cca92bb/isMSAApp~/false/defaultBlade/Overview/appSignInAudience/AzureADMultipleOrgs/servicePrincipalCreated~/true
    secret desc - qtechcsoutlookandteams

3. install package in Laravel
    composer require laravel/socialite microsoft/microsoft-graph
    composer require microsoft/microsoft-graph vlucas/phpdotenv

4. Configure Environment Variables
    Add the following variables in your .env file:
    
    O365_CLIENT_ID=your-application-client-id
    O365_CLIENT_SECRET=your-client-secret
    O365_TENANT_ID=your-directory-tenant-id
    O365_REDIRECT_URI=http://localhost:8000/auth/redirect


    essential :
        Application (client) ID:   14a36c7b-7f25-497f-8ee3-9f768181cb2b
        Object ID: 8f1a6223-32c9-44a5-a162-b9767cca92bb
        Directory (tenant) ID: 2f27fd41-6e94-44f1-be24-414ef33f2781
        Application ID URI : api://14a36c7b-7f25-497f-8ee3-9f768181cb2b


        https://entra.microsoft.com/#view/Microsoft_AAD_RegisteredApps/ApplicationMenuBlade/~/Overview/appId/14a36c7b-7f25-497f-8ee3-9f768181cb2b/isMSAApp~/false




5. Set Up Socialite for Office 365
        In config/services.php, configure Office 365 settings:
        'office365' => [
            'client_id' => env('O365_CLIENT_ID'),
            'client_secret' => env('O365_CLIENT_SECRET'),
            'redirect' => env('O365_REDIRECT_URI'),
        ],


6. https://github.com/microsoftgraph/msgraph-sample-phpapp
